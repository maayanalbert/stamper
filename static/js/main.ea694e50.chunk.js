(window.webpackJsonpStamper=window.webpackJsonpStamper||[]).push([[0],{1009:function(e,t){},1144:function(e,t){},117:function(e,t,i){},1346:function(e,t,i){},1348:function(e,t,i){"use strict";i.r(t);var n,a,s,o,r,l,d,c,h,p,u,m=i(0),g=i.n(m),f=i(10),v=i.n(f),b=i(14),y=i(15),x=i(17),w=i(16),k=i(18),S=(i(117),i(450)),M=i(72),O=i.n(M),I=i(5),E=i(12),C=i(25),D=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},z=60,j=60,L=10,T=C.a.div(n||(n=D(["\n  ","\n position: fixed;\n  display: inline-flex;\n  flex-direction: column;\n  background: white;\n  min-width: ","px;\n  min-height: ","px;\n  user-select: none;\n"],["\n  ","\n  position: fixed;\n  display: inline-flex;\n  flex-direction: column;\n  background: white;\n  min-width: ","px;\n  min-height: ","px;\n  user-select: none;\n"])),(function(e){return e.isActive?"\n      \n    ":"opacity: 1;"}),z,j),W=C.a.div(a||(a=D(["\n  height: 30px;\n  border-bottom: 1px solid rgb(215,215,215);\n  cursor: ",";\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding-left: ","px;\n"],["\n  height: 30px;\n  border-bottom: 1px solid #ccc;\n  cursor: ",";\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding-left: ","px;\n"])),(function(e){return e.isDraggable?"-webkit-grab":"default"}),L),F=C.a.div(s||(s=D(["\n  width: 20px;\n  height: 20px;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  cursor: nwse-resize;\n"],["\n  width: 20px;\n  height: 20px;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  cursor: nwse-resize;\n"]))),H=C.a.div(u||(u=D(["\n  width: 20px;\n  height: 20px;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  cursor: nesw-resize;\n"],["\n  width: 20px;\n  height: 20px;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  cursor: nwse-resize;\n"]))),R=C.a.div(o||(o=D([" \n  padding: ","px;\n"],["\n  padding: ","px;\n"])),L),_=(C.a.img(r||(r=D(["\n  position: relative;\n  width: 15px;\n  height: 15px;\n margin-left:12px;\n  opacity: 0.3;\n  cursor: auto;\n\n  &:hover {\n    opacity: 1;\n  }\n\n  &:before, &:after {\n    position: absolute;\n    right: 60px;\n    content: ' ';\n    height: 21px;\n    width: 2px;\n    background-color: #333;\n  }\n\n  &:before {\n    transform: rotate(45deg);\n  }\n\n  &:after {\n    transform: rotate(-45deg);\n  }\n"],["\n  position: relative;\n  width: 20px;\n  height: 20px;\n  opacity: 0.3;\n  cursor: pointer;\n\n  &:hover {\n    opacity: 1;\n  }\n\n  &:before, &:after {\n    position: absolute;\n    right: 30px;\n    content: ' ';\n    height: 21px;\n    width: 2px;\n    background-color: #333;\n  }\n\n  &:before {\n    transform: rotate(45deg);\n  }\n\n  &:after {\n    transform: rotate(-45deg);\n  }\n"]))),C.a.img(h||(h=D(["\n  position: relative;\n  width: 17px;\n  height: 17px;\n  opacity: 0.3;\n  cursor: auto;\n\n  &:hover {\n    opacity: 1;\n  }\n\n  &:before, &:after {\n    position: absolute;\n    right: 40px;\n    content: ' ';\n    height: 21px;\n    width: 2px;\n    background-color: #FF0000;\n  }\n\n  &:before {\n    transform: rotate(45deg);\n  }\n\n  &:after {\n    transform: rotate(-45deg);\n  }\n"],["\n  position: relative;\n  width: 20px;\n  height: 20px;\n  opacity: 0.3;\n  cursor: pointer;\n\n  &:hover {\n    opacity: 1;\n  }\n\n  &:before, &:after {\n    position: absolute;\n    right: 40px;\n    content: ' ';\n    height: 21px;\n    width: 2px;\n    background-color: #333;\n  }\n\n  &:before {\n    transform: rotate(45deg);\n  }\n\n  &:after {\n    transform: rotate(-45deg);\n  }\n"]))),C.a.div(l||(l=D(["\n  white-space: nowrap;\n  max-width: calc(100% - 25px);\n  overflow: hidden;\n  text-overflow: ellipsis;\n"],["\n  white-space: nowrap;\n  max-width: calc(100% - 25px);\n  overflow: hidden;\n  text-overflow: ellipsis;\n"]))),C.a.div(d||(d=D(["\n  width: 20px;\n  height: calc(100% - 50px);\n  position: absolute;\n  bottom: 20px;\n  right: 0;\n  cursor: ew-resize;\n"],["\n  width: 20px;\n  height: calc(100% - 50px);\n  position: absolute;\n  bottom: 20px;\n  right: 0;\n  cursor: ew-resize;\n"])))),P=C.a.div(p||(p=D(["\n  width: 20px;\n  height: calc(100% - 50px);\n  position: absolute;\n  bottom: 20px;\n  left: 0;\n  cursor: ew-resize;\n"],["\n  width: 20px;\n  height: calc(100% - 50px);\n  position: absolute;\n  bottom: 20px;\n  right: 0;\n  cursor: ew-resize;\n"]))),A=C.a.div(c||(c=D(["\n  width: calc(100% - 40px);\n  height: 20px;\n  position: absolute;\n  bottom: 0;\n  left: 20px;\n  cursor: ns-resize;\n"],["\n  width: calc(100% - 40px);\n  height: 20px;\n  position: absolute;\n  bottom: 0;\n  left: 20px;\n  cursor: ns-resize;\n"]))),B=function(e){return"string"===typeof e},N={width:z,height:j},X=function(e,t){void 0===t&&(t=N);var i=e.x,n=e.y,a=t.width,s=t.height,o=window.innerWidth,r=window.innerHeight,l=o-(a||0)-L,d=r-(s||0)-L;return{x:Math.min(Math.max(i,L),l),y:Math.min(Math.max(n,L),d)}},Y=function(e,t){void 0===t&&(t=N);var i=window.innerWidth,n=window.innerHeight,a=i/2-t.width/2,s=n/2-t.height/2;switch(e){case"top-left":default:return{x:10,y:10};case"top-center":return{x:a,y:10};case"bottom-center":return{x:a,y:1/0};case"top-right":return{x:1/0,y:10};case"bottom-left":return{x:10,y:1/0};case"bottom-right":return{x:1/0,y:1/0};case"center":return{x:a,y:s}}},q=function(){function e(){}return e.getNextIndex=function(t){return t===e.maxIndex?t:(e.maxIndex++,e.maxIndex)},e.updateMaxIndex=function(t){e.maxIndex=Math.max(e.maxIndex,t)},e.maxIndex=100,e}(),K=i(7),U=i.n(K),G=i(2),Z=i(36),V=i(439),J=function(){function e(t,i){Object(b.a)(this,e),this.x=t,this.y=i}return Object(y.a)(e,[{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"substract",value:function(t){return new e(this.x-t.x,this.y-t.y)}}]),e}();var Q=function(e){var t=e.startingPoint,i=e.startingAnchorOrientation,n=e.endingPoint,a=e.endingAnchorOrientation,s=e.strokeColor,o=e.arrowLength,r=e.strokeWidth,l=e.strokeDasharray,d=e.arrowLabel,c=e.arrowMarkerId,h=e.noCurves,p=e.offset,u=e.onMouseOver,m=(e.onMouseOut,2*o),f=t.x,v=t.y,b=function(e,t,i,n,a){var s=function(e){switch(e){case"left":return{arrowX:-1,arrowY:0};case"right":return{arrowX:1,arrowY:0};case"top":return{arrowX:0,arrowY:-1};case"bottom":return{arrowX:0,arrowY:1};default:return{arrowX:0,arrowY:0}}}(a);return{xEnd:e+s.arrowX*i*n/2,yEnd:t+s.arrowY*i*n/2}}(n.x,n.y,m,r,a),y=b.xEnd,x=b.yEnd,w=function(e,t,i,n,a){return"top"===a||"bottom"===a?{xAnchor1:e,yAnchor1:t+("bottom"===a?1:-1)*Math.abs(n-t)/2}:"left"===a||"right"===a?{xAnchor1:e+("right"===a?1:-1)*Math.abs(i-e)/2,yAnchor1:t}:{xAnchor1:e,yAnchor1:t}}(f,v,y,x,i),k=w.xAnchor1,S=w.yAnchor1,M=function(e,t,i,n,a){return"top"===a||"bottom"===a?{xAnchor2:i,yAnchor2:n+("bottom"===a?1:-1)*Math.abs(n-t)/2}:"left"===a||"right"===a?{xAnchor2:i+("right"===a?1:-1)*Math.abs(i-e)/2,yAnchor2:n}:{xAnchor2:i,yAnchor2:n}}(f,v,y,x,a),O=function(e){var t=e.xStart,i=e.yStart,n=e.xAnchor1,a=e.yAnchor1,s=e.xAnchor2,o=e.yAnchor2,r=e.xEnd,l=e.yEnd,d=e.noCurves,c=e.offset,h=d?"":"C";if(c&&c>0){var p=Math.atan2(a-i,n-t),u=c*Math.cos(p),m=c*Math.sin(p);t+=u,r-=u,i+=m,l-=m}return"M".concat(t,",").concat(i," ")+"".concat(h).concat(n,",").concat(a," ").concat(s,",").concat(o," ")+"".concat(r,",").concat(l)}({xStart:f,yStart:v,xAnchor1:k,yAnchor1:S,xAnchor2:M.xAnchor2,yAnchor2:M.yAnchor2,xEnd:y,yEnd:x,noCurves:h,offset:p}),I=function(e,t,i,n){return{xLabel:i>e?e:i,yLabel:n>t?t:n,labelWidth:Math.max(Math.abs(i-e),1),labelHeight:Math.max(Math.abs(n-t),1)}}(f,v,y,x),E=I.xLabel,C=I.yLabel,D=I.labelWidth,z=I.labelHeight;return g.a.createElement("g",{onDoubleClick:function(){return u()}},g.a.createElement("path",{d:O,style:{fill:"none",stroke:s,strokeWidth:r,strokeDasharray:l},markerEnd:"url(".concat(window.location.href.split("#")[0],"#").concat(c,")")}),d&&g.a.createElement("foreignObject",{x:E,y:C,width:D,height:z,style:{overflow:"visible",pointerEvents:"none"}},g.a.createElement("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translateX(-50%) translateY(-50%)",pointerEvents:"all"}},g.a.createElement("div",null,d))))},$={position:"absolute",width:"100%",height:"100%",top:0,left:0,background:"black"};function ee(e){return new J(e.left,e.top)}var te=g.a.createContext({}),ie=te.Provider,ne=te.Consumer,ae=function(e){function t(e){var i;Object(b.a)(this,t),(i=Object(x.a)(this,Object(w.a)(t).call(this,e))).refreshScreen=function(){i.setState(Object(Z.a)({},i.state))},i.storeParent=function(e){i.state.parent||i.setState((function(t){return Object(Z.a)({},t,{parent:e})}))},i.getRectFromRef=function(e){return e?e.getBoundingClientRect():null},i.getParentCoordinates=function(){var e=i.getRectFromRef(i.state.parent);return e?ee(e):new J(0,0)},i.getPointCoordinatesFromAnchorPosition=function(e,t,n){var a=i.getRectFromRef(i.state.refs[t]);if(!a)return null;var s=function(e,t){switch(e){case"top":return ee(t).add(new J(t.width/2,0));case"bottom":return ee(t).add(new J(t.width/2,t.height));case"left":return ee(t).add(new J(0,t.height/2));case"right":return ee(t).add(new J(t.width,t.height/2));case"middle":return ee(t).add(new J(t.width/2,t.height/2));default:return new J(0,0)}}(e,a).substract(n);return s.x=s.x/i.props.scale,s.y=s.y/i.props.scale,s},i.registerTransitions=function(e,t){i.setState((function(i){return{sourceToTargetsMap:Object(Z.a)({},i.sourceToTargetsMap,Object(I.a)({},e,t))}}))},i.unregisterTransitions=function(e){i.setState((function(t){var i=Object(Z.a)({},t.sourceToTargetsMap);return delete i[e],{sourceToTargetsMap:i}}))},i.registerChild=function(e,t){i.state.refs[e]||(i.state.observer.observe(t),i.setState((function(i){return{refs:Object(Z.a)({},i.refs,Object(I.a)({},e,t))}})))},i.unregisterChild=function(e){i.setState((function(t){t.observer.unobserve(t.refs[e]);var i=Object(Z.a)({},t.refs);return delete i[e],{refs:i}}))},i.getSourceToTargets=function(){var e=i.state.sourceToTargetsMap,t=Object.keys(e).map((function(t){return e[t]}));return[].concat.apply([],t)},i.getDist=function(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))},i.p5NumberMap=function(e,t,i,n,a){return(e-t)*(a-n)/(i-t)+n},i.setRelativeOffsets=function(e,t,n,a){var s=e.filter((function(e){return e.source.id===a&&e.source.anchor===t||e.target.id===a&&e.target.anchor===t})),o=[],r={};s.map((function(e){if(e.source.id===a)var s=i.getPointCoordinatesFromAnchorPosition("middle",e.target.id,n),l=i.getPointCoordinatesFromAnchorPosition("middle",e.source.id,n);if(e.target.id===a)s=i.getPointCoordinatesFromAnchorPosition("middle",e.source.id,n),l=i.getPointCoordinatesFromAnchorPosition("middle",e.target.id,n);var d,c=-1*(l.y-s.y),h=-1*(l.x-s.x),p=180*Math.atan(c/h)/Math.PI;c<0&&h>0?p=i.p5NumberMap(p,0,-90,0,90):c<0&&h<0?p=i.p5NumberMap(p,90,0,90,180):c>0&&h<0?p=i.p5NumberMap(p,0,-90,180,270):c>0&&h>0&&(p=i.p5NumberMap(p,90,0,270,360)),"right"===t&&p>=270&&(p-=360),"bottom"===t?(d=1,p=(p+270)%360):"left"===t?(d=1,p=(p+0)%360):"top"===t?(p=(p+90)%360,d=-1):"right"===t&&(p=(p+180)%360,d=-1),o.push(p),r[p]=e,o.sort((function(e,t){return e-t})),o.map((function(e,t){var n=r[e],s=.5*(o.length-1);n.source.id===a?n.relativeSourceOffset=(t-s)*i.props.relativeOffsetSize*d:n.relativeTargetOffset=(t-s)*i.props.relativeOffsetSize*d}))}))},i.getComputedAnchors=function(e,t,n){e.anchor;var a,s,o=i.getPointCoordinatesFromAnchorPosition("middle",e.id,n),r=(t.anchor,i.getPointCoordinatesFromAnchorPosition("middle",t.id,n)),l=o.x-r.x,d=o.y-r.y;Math.abs(d)>Math.abs(l)?d>0?(s="bottom",a="top"):(s="top",a="bottom"):l<0?(s="left",a="right"):(s="right",a="left");var c=Object.assign({},e),h=Object.assign({},t);return"middle"===e.anchor&&(c.anchor=a),"middle"===t.anchor&&(h.anchor=s),{source:c,target:h}},i.computeArrows=function(){var e=i.getParentCoordinates(),t=i.getSourceToTargets();t=(t=t.filter((function(t){var n=i.getPointCoordinatesFromAnchorPosition("middle",t.source.id,e),a=i.getPointCoordinatesFromAnchorPosition("middle",t.target.id,e);return n&&a}))).map((function(t){var n=i.getComputedAnchors(t.source,t.target,e);return(t=Object.assign({},t)).source=n.source,t.target=n.target,t}));var n={};return t.map((function(e){n[e.source.id]="",n[e.target.id]=""})),Object.keys(n).map((function(n){i.setRelativeOffsets(t,"left",e,n),i.setRelativeOffsets(t,"right",e,n),i.setRelativeOffsets(t,"top",e,n),i.setRelativeOffsets(t,"bottom",e,n)})),t.map((function(t){var n=t.source,a=t.target,s=t.label,o=t.style,r=t.relativeSourceOffset,l=t.relativeTargetOffset,d=o&&o.strokeColor||i.props.strokeColor,c=o&&o.arrowLength||i.props.arrowLength,h=o&&o.strokeWidth||i.props.strokeWidth,p=o&&o.strokeDasharray||i.props.strokeDasharray,u=o&&o.arrowThickness||i.props.arrowThickness,m=o&&o.noCurves||i.props.noCurves,f=i.props.offset||0,v=a.anchor,b=i.getPointCoordinatesFromAnchorPosition(a.anchor,a.id,e),y=n.anchor,x=i.getPointCoordinatesFromAnchorPosition(n.anchor,n.id,e);"top"===n.anchor||"bottom"===n.anchor?x.x+=r:x.y+=r,"top"===a.anchor||"bottom"===a.anchor?b.x+=l:b.y+=l;var w=i.props.onMouseOver;i.props.onMouseOver||(w=function(){return null});var k=i.props.onMouseOut;return i.props.onMouseOut||(k=function(){return null}),g.a.createElement(Q,{onMouseOver:function(){return w({source:n,target:a})},onMouseOut:function(){return k({source:n,target:a})},key:JSON.stringify({source:n,target:a}),startingPoint:x,startingAnchorOrientation:y,endingPoint:b,endingAnchorOrientation:v,strokeColor:d,arrowLength:c,strokeWidth:h,strokeDasharray:p,arrowLabel:s,arrowThickness:u,arrowMarkerId:i.getMarkerId(n,a),noCurves:!!m,offset:f})}))},i.getMarkerId=function(e,t){return"".concat(i.arrowMarkerUniquePrefix).concat(e.id).concat(t.id)},i.generateAllArrowMarkers=function(){return i.getSourceToTargets().map((function(e){var t=e.source,n=e.target,a=(e.label,e.style),s=a&&a.strokeColor||i.props.strokeColor,o=a&&a.arrowLength||i.props.arrowLength,r=a&&a.arrowThickness||i.props.arrowThickness,l="M0,0 L0,".concat(r," L").concat(o-1,",").concat(r/2," z");return g.a.createElement("marker",{id:i.getMarkerId(t,n),key:i.getMarkerId(t,n),markerWidth:o,markerHeight:r,refX:"0",refY:r/2,orient:"auto",markerUnits:"strokeWidth"},g.a.createElement("path",{d:l,fill:s}))}))},i.svgContainerStyle=function(){return Object(Z.a)({},$,{},i.props.svgContainerStyle)};var n=new V.a((function(){i.refreshScreen()}));i.state={refs:{},sourceToTargetsMap:{},observer:n,parent:null};var a=Math.random().toString().slice(2);return i.arrowMarkerUniquePrefix="arrow".concat(a),i}return Object(k.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){window&&window.addEventListener("resize",this.refreshScreen)}},{key:"componentWillUnmount",value:function(){var e=this,t=this.state.observer;Object.keys(this.state.refs).map((function(i){t.unobserve(e.state.refs[i])})),window&&window.removeEventListener("resize",this.refreshScreen)}},{key:"render",value:function(){var e=this.computeArrows();return g.a.createElement(ie,{value:{registerTransitions:this.registerTransitions,unregisterTransitions:this.unregisterTransitions,registerChild:this.registerChild,unregisterChild:this.unregisterChild}},g.a.createElement("div",{style:Object(Z.a)({},this.props.style),className:this.props.className},g.a.createElement("div",null,g.a.createElement("svg",{viewBox:"".concat(-this.props.left/this.props.scale," ").concat(-this.props.top/this.props.scale," ").concat(window.innerWidth/this.props.scale," ").concat(window.innerHeight/this.props.scale),style:{position:"absolute",top:-this.props.top/this.props.scale,left:-this.props.left/this.props.scale,width:window.innerWidth/this.props.scale,height:window.innerHeight/this.props.scale}},g.a.createElement("defs",null,this.generateAllArrowMarkers()),e)),g.a.createElement("div",{style:{height:"100%"},ref:this.storeParent},this.props.children)))}}]),t}(g.a.Component);ae.defaultProps={arrowLength:10,arrowThickness:6,strokeColor:"#f00",strokeWidth:2,svgContainerStyle:{}};var se=ae,oe=i(440),re=i.n(oe),le=function(e){function t(){var e,i;Object(b.a)(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(i=Object(x.a)(this,(e=Object(w.a)(t)).call.apply(e,[this].concat(a)))).registerTransitions=function(e){var t=i.generateSourceToTarget(e);if(!i.props.context.registerTransitions)throw new Error('Could not find "registerTransition" in the context of <ArcherElement>. Wrap the component in a <ArcherContainer>.');i.props.context.registerTransitions(i.props.id,t)},i.generateSourceToTarget=function(e){var t=i.props.id;return e.map((function(e){var i=e.targetId,n=e.sourceAnchor,a=e.targetAnchor,s=e.label,o=e.style;return{source:{id:t,anchor:n},target:{id:i,anchor:a},label:s,style:o}}))},i.unregisterTransitions=function(){if(!i.props.context.unregisterTransitions)throw new Error('Could not find "unregisterTransitions" in the context of <ArcherElement>. Wrap the component in a <ArcherContainer>.');i.props.context.unregisterTransitions(i.props.id)},i.onRefUpdate=function(e){if(e){if(!i.props.context.registerChild)throw new Error('Could not find "registerChild" in the context of <ArcherElement>. Wrap the component in a <ArcherContainer>.');i.props.context.registerChild(i.props.id,e)}},i.unregisterChild=function(){if(!i.props.context.unregisterChild)throw new Error('Could not find "unregisterChild" in the context of <ArcherElement>. Wrap the component in a <ArcherContainer>.');i.props.context.unregisterChild(i.props.id)},i}return Object(k.a)(t,e),Object(y.a)(t,[{key:"componentDidUpdate",value:function(e){re()(e.relations,this.props.relations)||this.registerTransitions(this.props.relations)}},{key:"componentDidMount",value:function(){0!==this.props.relations.length&&this.registerTransitions(this.props.relations)}},{key:"componentWillUnmount",value:function(){this.unregisterChild(),this.unregisterTransitions()}},{key:"render",value:function(){return g.a.createElement("div",{style:Object(Z.a)({},this.props.style,{position:"relative"}),className:this.props.className,ref:this.onRefUpdate},this.props.children)}}]),t}(g.a.Component);le.defaultProps={relations:[]};var de=function(e){return g.a.createElement(ne,null,(function(t){return g.a.createElement(le,Object.assign({},e,{context:t}))}))},ce=i(244),he=i(246);if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)window.require("electron").ipcRenderer;else;var pe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;if(t.props.zIndex){var i=t.props.zIndex;q.updateMaxIndex(i)}else i=q.getNextIndex();return t.state={x:L,y:L,isDragging:!1,isResizingX:!1,isResizingY:!1,isResizingXLeft:!1,zIndex:i,downKey:-1,isMoving:!1,originalHeight:null,ghostX:0,ghostY:0},t.opt=18,t.cmd=91,t.ctrl=17,t.plus=187,t.minus=189,t.zero=48,t.space=32,t.onWindowResize=function(){var e=t.state,i=e.x,n=e.y,a=e.width,s=e.height,o=X({x:i,y:n},a&&s?{width:a,height:s}:void 0),r=o.x,l=o.y;t.setState({x:r,y:l})},t.saveWrapperRef=function(e){if(t.childrenElement=e,t.childrenElement){var i,n,a=t.props.initialSize;if(a){var s=t.childrenElement.getBoundingClientRect();i=a.width?a.width:s.width,n=a.height?a.height:s.height}else{i=(s=t.childrenElement.getBoundingClientRect()).width,n=s.height}t.setState({width:i,height:n,originalHeight:n}),t.setInitialPosition({width:i,height:n})}},t.setInitialPosition=function(e){var i,n=t.props.initialPosition;n&&(i=B(n)?Y(n,e):n,t.setState({x:i.x,y:i.y}))},t.saveHeaderRef=function(e){t.headerElement=e},t.onKeyDown=function(e){t.state.downKey===t.cmd||t.state.downKey===t.ctrl?e.keyCode===t.zero?e.preventDefault():e.keyCode===t.plus?e.preventDefault():e.keyCode===t.minus&&e.preventDefault():t.setState({downKey:e.keyCode})},t.onKeyUp=function(e){e.keyCode===t.state.downKey&&t.setState({downKey:-1})},t.onMouseDown=function(e){t.props.isDraggable&&t.setState({isDragging:!0})},t.manualResize=function(e,i){var n=t.state.width,a=t.state.height;t.setState({width:n+e,height:a+i})},t.manualSetSize=function(e,i){t.setState({width:e,height:i})},t.onWheel=function(e){e.ctrlKey&&e.preventDefault()},t.getPosition=function(e,i){if(t.props.getScale)t.props.getScale();else;var n=t.state.ghostX+e,a=t.state.ghostY+i;if(this.setState({ghostX:n,ghostY:a}),t.props.getSnapMargin)var s=t.props.getSnapMargin();else s=0;return 0===s?{x:n,y:a}:{x:Math.round(n/s)*s,y:Math.round(a/s)*s}},t.getDimensions=function(e,i,n){var a=t.state.ghostX+e,s=t.state.ghostY+i,o=t.state.x+t.state.width,r=t.state.y+t.state.height,l=t.state.x+a,d=t.state.y+s;n&&(o=t.state.x,l=t.state.ghostX-e);var c=Math.max(a,z);n&&(c=t.state.ghostX-e);var h=Math.max(s,j),p=t.props.onResize;if(t.props.getSnapMargin)var u=t.props.getSnapMargin();else u=0;if(0===u){if(!p(e,i,t.state.x,!1))return this.setState({ghostX:c,ghostY:h}),{widthDiff:e,heightDiff:i}}else{var m=Math.round(l/u)*u,g=Math.round(d/u)*u,f=0,v=0;if(0!=e&&(f=m-o),0!=i&&(v=g-r),n&&(f=-f),!p(f,v,t.state.x,!1))return this.setState({ghostX:c,ghostY:h}),{widthDiff:f,heightDiff:v}}return{widthDiff:0,heightDiff:0}},t.onMouseMove=function(e){var i=t.isResizing;if(t.props.getScale)var n=t.props.getScale();else n=1;var a=t.state,s=a.isDragging,o=(a.x,a.y,a.width,a.height,e.movementX),r=e.movementY;window.innerWidth,window.innerHeight;if(s){window.postMessage({type:"edited"},"*");t.onStartMove((function(){if(t.state.downKey!==t.space){var e=t.getPosition(o/n,r/n),i=e.x,a=e.y;t.setState({x:i,y:a})}}))}else i&&(window.postMessage({type:"edited"},"*"),t.resizeCristal(e))},t.resizeCristal=function(e){t.isResizing;if(t.props.getScale)var i=t.props.getScale();else i=1;var n=t.state,a=(n.isDragging,n.x,n.y,n.width,n.height,e.movementX/i),s=e.movementY/i,o=(window.innerWidth,window.innerHeight,t.state),r=o.isResizingX,l=o.isResizingY,d=0,c=0,h=!1;r&&(d=a),o.isResizingXLeft&&(d=-a,h=!0),l&&(c=s),t.notifyResize(d,c,h)},t.onStoppedMove=function(){this.state.isMoving&&t.notifyStopMove(),t.setState({isMoving:!1})},t.onStartMove=function(e){t.notifyMove(),!1===t.state.isMoving?(t.setState({ghostX:t.state.x,ghostY:t.state.y},(function(){t.setState({isMoving:!0},(function(){return e()}))})),t.notifyStartMove(),t.state.downKey===t.opt&&t.notifyOptMove()):e()},t.notifyMove=function(){var e=t.props.onMove;e&&e(t.state)},t.notifyZChange=function(){var e=t.props.onZChange;e&&e(t.state)},t.notifyResize=function(e,i,n){var a=t.props.onResize,s=this.getDimensions(e,i,n);e=s.widthDiff,i=s.heightDiff;var o=Math.max(t.state.height+i,j),r=Math.max(t.state.width+e,z),l=t.state.x;n&&(l-=e),a(e,i,t.state.x,!0),t.setState({height:o,width:r,x:l})},t.notifyStartMove=function(){var e=t.props.onStartMove;e&&e(t.state)},t.notifyStopMove=function(){var e=t.props.onStopMove;e&&e(t.state)},t.notifyOptMove=function(){var e=t.props.onOptMove;e&&e(t.state)},t.notifyStartResize=function(){var e=t.props.onStartResize;e&&e(t.state)},t.notifyStopResize=function(){var e=t.props.onStopResize;e&&e(t.state)},t.onMouseUp=function(){t.onStoppedMove(),(t.state.isResizingY||t.state.isResizingX||t.state.isResizingXLeft)&&t.notifyStopResize(),t.setState({isDragging:!1,isResizingX:!1,isResizingXLeft:!1,isResizingY:!1,mouseIsDown:!1})},t.startFullResize=function(){t.setState({ghostX:t.state.width,ghostY:t.state.height}),t.notifyStartResize(),t.setState({isResizingX:!0,isResizingY:!0})},t.startFullLeftResize=function(){t.setState({ghostX:t.state.width,ghostY:t.state.height}),t.notifyStartResize(),t.setState({isResizingXLeft:!0,isResizingY:!0})},t.startXResize=function(){return t.setState({ghostX:t.state.width,ghostY:t.state.height}),t.notifyStartResize(),t.setState({isResizingX:!0})},t.startXLeftResize=function(){return t.setState({ghostX:t.state.x,ghostY:t.state.height}),t.notifyStartResize(),t.setState({isResizingXLeft:!0})},t.startYResize=function(){return t.setState({ghostX:t.state.width,ghostY:t.state.height}),t.notifyStartResize(),t.setState({isResizingY:!0})},t.renderResizeHandles=function(){if(t.props.isResizable){if(t.props.getScale)var e=t.props.getScale();else e=1;var i=t.state.height,n=t.state.width,a="transparent";return[m.createElement(_,{key:"right-resize",onMouseDown:t.startXResize,style:{background:a,right:-2.5,width:5/e,bottom:5/e,height:i-30-5/e}}),m.createElement(P,{key:"left-resize",onMouseDown:t.startXLeftResize,style:{background:a,left:-2.5,width:5/e,bottom:5/e,height:i-30-5/e}}),m.createElement(F,{key:"bottom-right-resize",onMouseDown:t.startFullResize,style:{background:a,right:-2.5,bottom:-2.5,width:5/e,height:5/e}}),m.createElement(H,{key:"bottom-left-resize",onMouseDown:t.startFullLeftResize,style:{background:a,left:-2.5,bottom:-2.5,width:5/e,height:5/e}}),m.createElement(A,{key:"bottom-resize",onMouseDown:t.startYResize,style:{background:a,bottom:-2.5,height:5/e,left:5/e,width:n-10/e}})]}},t.changeZIndex=function(){var e=t.state.zIndex;t.setState({zIndex:q.getNextIndex(e)},t.notifyZChange)},t}function i(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5?arguments[5]:void 0;if(i)return null;var o=n+e.props.parentID,r=function(){U()("."+o).css({opacity:"1"})},l=function(){U()("."+o).css({opacity:G.a.iconOpacity})},d=G.a.iconOpacity;a||(r=function(){},l=function(){},d*=.5);var c=m.createElement("img",{onClick:a,style:{opacity:d,height:G.a.iconSize,width:G.a.iconSize},className:"text-greyIcon m-1 "+o,onMouseOver:r,onMouseOut:l,src:t});return s?m.createElement("div",{onMouseOver:r,onMouseOut:l},m.createElement(ce.a,{trigger:"hover",placement:"top",overlay:m.createElement(he.a,{id:"alert",className:"picker-style-tooltip"},s)},c)):c}return pe(t,e),t.prototype.componentDidMount=function(){document.addEventListener("mousedown",this.onGlobalMouseDown),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp),document.addEventListener("wheel",this.onWheel,{passive:!1});var e=document.getElementById("iframe"+this.props.parentID);e&&e.addEventListener("wheel",(function(e){return console.log(e)})),this.notifyZChange()},t.prototype.componentWillUnmount=function(){document.removeEventListener("mousedown",this.onGlobalMouseDown),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("wheel",this.onWheel)},Object.defineProperty(t.prototype,"isResizing",{get:function(){var e=this.state,t=e.isResizingX,i=e.isResizingY,n=e.isResizingXLeft;return t||i||n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){var e=this.props,t=(e.title,e.isDraggable),n=e.onClose,a=e.closeHidden,s=e.onCopy,o=e.copyHidden,r=i(this,G.a.DeleteStampIcon,a,"mouseOnClose",n,"delete stamp"),l=i(this,G.a.CopyIcon,o,"mouseOnCopy",s,"copy stamp"),d=i(this,G.a.ClearConsoleIcon,!e.showClear,"mousOnClear",e.onClear,"clear console");if(e.onMinimize)var c=i(this,G.a.MinimzeIcon,null===e.onMinimize,"mouseOnMinimize",e.onMinimize);var h=null;if(this.props.icon)h=i(this,this.props.icon);var p=i(this,G.a.CodeSizeIcon,!e.showCodeSize,"mouseOnBig",e.onCodeSize,"toggle text size"),u=m.createElement("div",{class:"row mt-1",style:{position:"absolute",cursor:"auto",right:18,top:0}},p,l,r,d,c);return m.createElement(W,{className:"bg-white rounded-top",isDraggable:t,ref:this.saveHeaderRef,onMouseDown:this.onMouseDown},h,u)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){var e=this.props.children;return m.createElement(R,{},e)},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.isResizing,t=this.state,i=t.x,n=t.y,a=t.width,s=t.height,o=t.isDragging,r=t.zIndex,l=this.props.className,d=o||e,c={left:i,top:n,margin:0,width:a,height:s,zIndex:r,position:"absolute",border:this.props.border,outline:this.props.outline},h=this.header,p=this.content;if(this.props.invisible)return m.createElement("span",null);var u=[];this.props.getLinesOn&&this.props.getLinesOn()&&(u=this.props.lineData);var g=m.createElement(de,{id:"line_"+this.props.parentID,relations:u},h,p),f=function(){return null};return this.props.onDoubleClick&&(f=this.props.onDoubleClick),m.createElement(T,{id:"vertex_"+this.props.parentID,style:c,ref:this.saveWrapperRef,isActive:d,className:l+" rounded "+this.props.wrapperName,onMouseDown:this.changeZIndex,overflow:"hidden",onDoubleClick:f},g,this.renderResizeHandles())},t.defaultProps={children:null,isResizable:!0,isDraggable:!0},t}(m.Component),me=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ge=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}me(t,e),t.prototype.render=function(){return m.createElement("div",null,"Custom Content")}}(m.Component),function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),fe=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}ge(t,e),t.prototype.render=function(){return m.createElement("div",null,"Custom header")}}(m.Component),i(168),i(257),i(90)),ve=i.n(fe),be=(i(873),i(874),i(175),i(176),i(177),i(178),i(179),i(91)),ye=i(180);if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)window.require("electron").ipcRenderer;else;var xe=function(e){function t(e){var i;Object(b.a)(this,t);var n=(i=Object(x.a)(this,Object(w.a)(t).call(this,e))).props.starterEditorWidth;i.props.isMediaFile&&(n=0);var a=i.props.starterArgs;(i.props.isIndex||i.props.isTxtFile||i.props.isMediaFile||i.props.isBlob)&&(a=" ");var s=i.props.starterName;i.props.isBlob&&(s="");var o=i.props.starterIframeWidth,r=i.props.starterIframeHeight;(i.props.isTxtFile||i.props.isBlob)&&(o=0,r=0);return i.state={code:i.props.starterCode,name:s,args:a,iframeDisabled:i.props.iframeDisabled,iframeWidth:o,iframeHeight:r,editorHeight:i.props.starterEditorHeight,editorWidth:n,isSpecialFn:!1,editorScrolling:!1,errorLines:i.props.errorLines,iframeCode:"",editsMade:!1,runningBorder:!1,resizingIframe:!1,x:i.props.initialPosition.x,y:i.props.initialPosition.y,hidden:i.props.initialHidden,looping:!0,loopingTransition:"",zIndex:i.props.starterZIndex,exportableCode:"",codeSize:i.props.starterCodeSize,dataUri:"",lineData:[],editorTopShadow:!1,editorBottomShadow:!1,ghostX:o,ghostY:r,iframeDimensTransition:"",mediaAssetHeight:null,mediaAssetWidth:null,lineHighLightingStatus:i.props.starterLineHighLightingStatus},i.cristalRef=g.a.createRef(),i.editorRef=g.a.createRef(),i.updateLooping=i.updateLooping.bind(Object(E.a)(i)),i}return Object(k.a)(t,e),Object(y.a)(t,[{key:"toggleHide",value:function(e){window.postMessage({type:"edited"},"*"),this.state.hidden?this.setState({hidden:!1,iframeHeight:this.state.iframeHeight,zIndex:void 0},e):this.setState({hidden:!0},e)}},{key:"updateLooping",value:function(e){"loop"!=e.data.type||e.data.id!=this.props.id||this.props.isIndex||this.props.isMediaFile||this.props.isBlob||("start"===e.data.message?this.setState({looping:!0,loopingTransition:""}):"stop"===e.data.message&&this.setState({looping:!1,loopingTransition:"opacity 1s ease-in"}))}},{key:"componentDidMount",value:function(){var e=this;this.checkName(),this.setDataUri((function(){return e.props.requestCompile(e.props.id)})),window.addEventListener("message",this.updateLooping)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.updateLooping)}},{key:"setDataUri",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null};if(!1!==this.props.isTxtFile){var t=ye.lookup(this.state.name);if(t&&0!==t.split("/").length){var i=t.split("/");i[0]="text",t=i.join("/");var n=new File([this.state.code],this.state.name,{type:t}),a=new FileReader;a.onload=function(t){this.setState({dataUri:t.target.result},e)},a.onload=a.onload.bind(this),a.readAsDataURL(n)}else e()}}},{key:"checkName",value:function(){var e=this.state.name in G.a.specialFns;this.setState({isSpecialFn:e})}},{key:"addErrorLine",value:function(e){var t=this,i=this.state.errorLines;i[e]="",this.setState({errorLines:i},(function(){return t.props.setLayerPicker()}))}},{key:"setLineData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.setState({lineData:e})}},{key:"clearErrorsAndUpdate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=this.state.errorLines;i={};this.setState({errorLines:i},(function(){var i="",n="";e.props.setLayerPicker(),e.props.isBlob?n=e.props.getExportableCode():!1===e.props.isTxtFile&&!1===e.props.isMediaFile&&(i=e.props.getHTML(e.props.id)),e.setState({iframeCode:i,exportableCode:n,looping:!0,loopingTransition:""});for(var a=0;a<t.length;a++)e.addErrorLine(t[a])}))}},{key:"loadp5Lib",value:function(){this.editorRef.current&&this.editorRef.current.editor.completers.push({getCompletions:function(e,t,i,n,a){var s=[];G.b.forEach((function(e){s.push({value:e,meta:"p5.js"})})),a(null,s)}})}},{key:"getIframeDimensionFromGhost",value:function(e,t){var i=this.props.getSnapMargin(),n=this.state.ghostX+e,a=this.state.ghostY+t;if(this.setState({ghostX:n,ghostY:a}),0===(i=this.props.getSnapMargin()))return{movementX:e,movementY:t};var s=Math.round(n/i)*i,o=Math.round(a/i)*i;return{movementX:s-this.state.iframeWidth,movementY:o-this.state.iframeHeight}}},{key:"updateIframeDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.getIframeDimensionFromGhost(e,t);if(0!==i.movementX||0!==i.movementY){e=i.movementX,t=i.movementY,window.postMessage({type:"edited"},"*");var n=this.state.iframeWidth+e,a=this.state.iframeHeight+t;n<30&&(e=0,n=30),a<30&&(t=0,a=30),this.setState({iframeWidth:n,iframeHeight:a}),!1===this.props.isMediaFile&&(t=0),this.cristalRef.current.manualResize(e,t)}}},{key:"setEditorScrolling",value:function(e){e&&0==this.state.editorScrolling?(this.setState({editorScrolling:!0}),this.props.disablePan(!0)):!1===e&&this.state.editorScrolling&&(this.setState({editorScrolling:!1}),this.props.disablePan(!1))}},{key:"renderEditor",value:function(){var e=this,t=[];for(var i in this.state.errorLines)0!=i&&t.push({startRow:i-1,endRow:i,type:"background",className:"bg-warningOrange marker"});var n="p5";if((this.props.isIndex||this.props.isTxtFile||this.props.isMediaFile)&&(n="solarized_light"),this.props.isTxtFile||this.props.isIndex){var a=ye.lookup(this.state.name);if(a&&0!==a.split("/").length){var s=a.split("/");o=s[s.length-1]}else var o=""}else o="javascript";var r="";return this.state.editorBottomShadow&&this.state.editorTopShadow?r="inset 0 7px 6px -8px rgba(0, 0, 0, .15), inset 0 -7px 6px -8px rgba(0, 0, 0, .15)":this.state.editorTopShadow?r="inset 0 7px 6px -8px rgba(0, 0, 0, .15)":this.state.editorBottomShadow&&(r="inset 0 -7px 6px -8px rgba(0, 0, 0, .15)"),g.a.createElement("div",{onMouseOut:function(){e.setEditorScrolling(!1)}},g.a.createElement("br",{hidden:this.props.isBlob}),g.a.createElement(ve.a,{markers:t,style:{width:this.state.editorWidth,height:this.state.editorHeight,background:"transparent",boxShadow:r},className:"code",mode:o,theme:n,onChange:function(t,i){e.setState({code:t}),e.onEditsMade()},name:"name"+this.props.id.toString(),onLoad:function(t){e.setEditorShadow(t.renderer.scrollBar),t.on("change",(function(t,i){e.setEditorShadow(i.renderer.scrollBar)}))},fontSize:this.state.codeSize,showPrintMargin:!1,wrapEnabled:!0,showGutter:!1,highlightActiveLine:!1,value:this.state.code,ref:this.editorRef,onScroll:function(t){e.setEditorScrolling(!0),e.setEditorShadow(t.renderer.scrollBar)},setOptions:{enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,enableSnippets:!1,showLineNumbers:!1,tabSize:2,hasCssTransforms:!0,fontFamily:"Inconsolata"}}))}},{key:"setEditorShadow",value:function(e){var t=!1,i=!1;e.scrollTop-5>0&&(t=!0),e.scrollTop+this.state.editorHeight+5<e.scrollHeight&&(i=!0),this.setState({editorTopShadow:t,editorBottomShadow:i})}},{key:"stripExtension",value:function(e){var t=e.split(".");return t.length<2?e:(t.pop(),t.join("."))}},{key:"getExtension",value:function(e){var t=e.split(".");return t.length<2?"":t.pop()}},{key:"addExtension",value:function(e,t){var i=t.split(".");return i.length<2?e:e+"."+i.pop()}},{key:"compileCallback",value:function(){var e=this;if(this.state.editsMade){var t=function(){e.props.requestCompile(e.props.id),window.postMessage({type:"edited"},"*"),e.setState({editsMade:!1,runningBorder:!0},(function(){return setTimeout((function(){e.setState({runningBorder:!1})}),300)}))};this.props.isTxtFile?this.setDataUri(t):t()}}},{key:"onEditsMade",value:function(){this.setState({editsMade:!0}),window.postMessage({type:"edited"},"*")}},{key:"renderFunctionName",value:function(){var e=this,t="";if(this.state.name!=this.props.starterName)t=this.state.Name;var i="blue";this.state.name in G.a.builtIns?i="pink":this.state.name in G.a.listeners?i="pink":(this.props.isIndex||this.props.isTxtFile||this.props.isMediaFile)&&(i="htmlCssName");var n="function name...";this.props.isTxtFile?n="file name...":this.props.isMediaFile&&(n="");t=this.state.name;this.props.isMediaFile&&(t=this.stripExtension(t));var a="bg-transparent";return 0 in this.state.errorLines&&(a="bg-warningOrange"),g.a.createElement("div",null,g.a.createElement("p",{hidden:!this.props.isMediaFile,className:"text-lightGreyText name",style:{position:"absolute",top:49,left:19}},this.state.name),g.a.createElement("input",{placeholder:n,disabled:this.props.isIndex,onChange:function(t){var i=t.target.value;e.props.isMediaFile&&(i=e.addExtension(i,e.state.name)),e.setState({name:i}),e.onEditsMade()},style:{background:"transparent"},value:t,class:"text-"+i+" name "+a}),g.a.createElement("br",null),g.a.createElement("input",{placeholder:"arguments...",disabled:this.props.isIndex||this.props.isTxtFile||this.props.isMediaFile,onChange:function(t){e.setState({args:t.target.value}),e.onEditsMade()},style:{background:"transparent"},value:this.state.args,class:"text-greyText args "+a}))}},{key:"renderMediaAsset",value:function(){if(!this.props.isMediaFile)return null;var e=ye.lookup(this.state.name);if(e){if(e.startsWith("image")){if(!this.state.imageWidth){var t=new Image;t.onload=function(){this.setState({imageWidth:t.width,imageHeight:t.height})},t.onload=t.onload.bind(this),t.src=this.state.code}return g.a.createElement("img",{src:this.state.code})}return e.startsWith("audio")?g.a.createElement("audio",{controls:!0},g.a.createElement("source",{src:this.state.code,type:e})):e.startsWith("video")?g.a.createElement("video",{controls:!0},g.a.createElement("source",{src:this.state.code,type:e})):g.a.createElement("div",{className:"bg-borderGrey pt-5 d-flex justify-content-center",style:{width:this.state.iframeWidth,height:this.state.iframeHeight}},g.a.createElement("img",{style:{width:100,height:100,opacity:.5},src:G.a.MediaAssetIcon}))}}},{key:"manualIframeResize",value:function(e,t){var i=this;setTimeout((function(){i.setState({iframeDimensTransition:""})}),1200),setTimeout((function(){i.setState({resizingIframe:!1,iframeDimensTransition:"opacity 1s ease-out"})}),200),this.setState({resizingIframe:!0}),this.updateIframeDimensions(e-this.state.iframeWidth,t-this.state.iframeHeight)}},{key:"renderIframe",value:function(){var e=this,t=0;if(!1===this.state.looping&&(t=.5),this.state.resizingIframe)var i=.5;else i=0;return g.a.createElement("div",null,g.a.createElement("div",{style:{position:"absolute",fontSize:G.a.codeSize,opacity:i,top:G.a.fnTitleHeight-5,right:25,transition:this.state.iframeDimensTransition},class:"text-greyText "},"W:"+Math.floor(this.state.iframeWidth)+" H:"+Math.floor(this.state.iframeHeight)),g.a.createElement("div",{style:{transition:this.state.loopingTransition,position:"absolute",fontSize:G.a.codeSize,opacity:t,top:G.a.fnTitleHeight-5,left:25+this.state.editorWidth},class:"text-greyText "},"paused"),g.a.createElement(be.Resizable,{className:"ml-1 bg-white shadow",onResize:function(t){e.updateIframeDimensions(t.movementX/e.props.getScale(),t.movementY/e.props.getScale())},onResizeStart:function(){e.props.onStartMove(),e.setState({resizingIframe:!0}),e.setState({ghostX:e.state.iframeWidth,ghostY:e.state.iframeHeight})},onResizeStop:function(t){e.setState({ghostX:e.state.iframeWidth,ghostY:e.state.iframeHeight}),e.props.onStopMove(),e.setState({resizingIframe:!1});var i=e.props.getCristalDimens(e.getData());e.cristalRef.current.manualSetSize(i.width,i.height)},onMouseOver:this.compileCallback.bind(this),style:{overflow:"hidden",zIndex:5,border:"none"},handle:g.a.createElement("span",{className:"react-resizable-handle react-resizable-handle-se",onDoubleClick:function(){if(e.state.imageWidth)e.manualIframeResize(e.state.imageWidth,e.state.imageHeight);else{var t=e.props.getP5CanvasDimensions();e.manualIframeResize(t.width,t.height)}}})},g.a.createElement("div",null,g.a.createElement("div",{style:{position:"absolute",width:this.state.iframeWidth,height:this.state.iframeHeight,background:"transparent"},hidden:!this.state.iframeDisabled}," "),g.a.createElement("div",{style:{height:this.state.iframeHeight,width:this.state.iframeWidth,zIndex:-1}},this.renderMediaAsset(),g.a.createElement("iframe",{hidden:this.props.isMediaFile,ref:function(t){t&&e.props.addNewIframeConsole(t.contentWindow.console)},id:"iframe"+this.props.id,scrolling:"no",style:{border:"none",height:this.state.iframeHeight,width:this.state.iframeWidth},srcdoc:this.state.iframeCode,sandbox:"allow-forms allow-modals allow-pointer-lock allow-popups  allow-same-origin allow-scripts",allow:"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media"})))))}},{key:"setIframeDisabled",value:function(e){this.setState({iframeDisabled:e})}},{key:"getCopyStampName",value:function(e,t){if(t){var i=e.split(".");return 0===i.length?"":(i[0]=i[0]+"Copy",i.join("."))}return e+"Copy"}},{key:"copyAndOpt",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(window.postMessage({type:"edited"},"*"),!this.props.isIndex){var i=this.getData();i.zIndex=void 0;var n=this.getCopyStampName(this.state.name,this.props.isTxtFile||this.props.isMediaFile);this.props.isBlob||(t?this.setState({name:n},(function(){return e.checkName()})):i.name=n),t?i.iframeDisabled=!0:(i.x+=G.a.copyOffset,i.y+=G.a.copyOffset);var a=function(t){return e.props.requestCompile(t)};t&&(a=function(t){e.props.requestCompile(t),e.cristalRef.current.changeZIndex()}),delete i.id;n=this.props.addStamp(i,a)}}},{key:"getData",value:function(){var e=this.state.name;return this.props.isBlob&&(e=this.props.getFirstLine(this.state.code)),{id:this.props.id,name:e,code:this.state.code,args:this.state.args,x:this.state.x,y:this.state.y,editorWidth:this.state.editorWidth,editorHeight:this.state.editorHeight,iframeWidth:this.state.iframeWidth,iframeHeight:this.state.iframeHeight,isIndex:this.props.isIndex,isTxtFile:this.props.isTxtFile,isMediaFile:this.props.isMediaFile,hidden:this.state.hidden,exported:!0,zIndex:this.state.zIndex,isBlob:this.props.isBlob,codeSize:this.state.codeSize,icon:this.getIcon(),lineHighLightingStatus:this.state.lineHighLightingStatus}}},{key:"resizeEditor",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this.state.editorHeight+t,s=this.state.editorWidth+e;if(a<0||s<0)return!0;n&&(this.setState({editorHeight:a,editorWidth:s,x:i}),this.editorRef.current.editor.resize())}},{key:"getIcon",value:function(){var e=G.a.FunctionStampIcon;return this.props.isIndex?e=G.a.HtmlStampIcon:this.props.isBlob?e=G.a.BlobStampIcon:this.props.isTxtFile?e=G.a.FileStampIcon:this.props.isMediaFile?e=G.a.ImageStampIcon:this.state.isSpecialFn&&(e=G.a.specialFns[this.state.name]?G.a.BuiltInStampIcon:G.a.ListenerStampIcon),e}},{key:"setLineHighlighted",value:function(e){this.setState({lineHighLightingStatus:e})}},{key:"render",value:function(){var e=this,t="border border-borderGrey";Object.keys(this.state.errorLines).length>0&&(t="border border-warningOrange"),this.state.runningBorder&&(t="border border-blue");var i="bg-jsArea";if((this.props.isIndex||this.props.isTxtFile||this.props.isMediaFile)&&(i="bg-htmlCssArea"),this.state.hidden)return g.a.createElement("div",null);this.state.iframeWidth;this.props.isTxtFile;this.state.editorHeight,G.a.fnTitleHeight;this.props.isMediaFile?(this.state.iframeHeight,G.a.fnTitleHeight):this.props.isBlob&&this.state.editorHeight;var n=1,a="shadow-sm";return"off"===this.state.lineHighLightingStatus&&(n=.5),"on"===this.state.lineHighLightingStatus&&(a="shadow-lg"),g.a.createElement("div",{style:{opacity:n}},g.a.createElement(ue,{opacity:n,zIndex:this.state.zIndex,onZChange:function(t){e.setState({zIndex:t.zIndex})},getScale:this.props.getScale,getSnapMargin:this.props.getSnapMargin,initialSize:this.props.getCristalDimens(this.getData()),ref:this.cristalRef,isResizable:!this.props.isMediaFile,onStartResize:function(){e.props.onStartMove(),e.setEditorShadow(e.editorRef.current.editor.renderer.scrollBar)},onStopResize:function(){e.props.onStopMove(),e.setEditorShadow(e.editorRef.current.editor.renderer.scrollBar)},onDoubleClick:function(){return e.props.getLinesOn()&&e.props.setDependencyLineHighlightings(e.props.id)},onStartMove:this.props.onStartMove,onStopMove:this.props.onStopMove,onClose:function(){return e.props.onDelete(e.props.id)},onCopy:function(){return e.copyAndOpt()},onOptMove:function(){return e.copyAndOpt(!0)},closeHidden:this.props.isIndex,copyHidden:this.props.isIndex,getLinesOn:this.props.getLinesOn,initialPosition:{x:this.state.x,y:this.state.y},lineData:this.state.lineData,className:"stamp "+a+" "+i+" "+t+" vertex"+this.props.id,onResize:this.resizeEditor.bind(this),onMove:function(t){return e.setState({x:t.x,y:t.y})},icon:this.getIcon(),parentID:this.props.id,showCodeSize:this.props.isBlob,onCodeSize:function(){window.postMessage({type:"edited"},"*"),e.state.codeSize===G.a.codeSize?e.setState({codeSize:G.a.bigCodeSize}):e.setState({codeSize:G.a.codeSize})}},g.a.createElement("div",{onMouseLeave:this.compileCallback.bind(this)},g.a.createElement("div",{class:"bg-white",hidden:this.props.isBlob,style:{position:"absolute",top:G.a.headerHeight,left:0,width:"100%",height:G.a.fnTitleHeight,color:"transparent"}}," "),g.a.createElement("div",{class:"p-2"},g.a.createElement("div",{hidden:this.props.isBlob},this.renderFunctionName()),g.a.createElement("div",{class:"row m-0 mt-2",style:{flexWrap:"nowrap"}},this.renderEditor(),this.renderIframe())))))}}]),t}(m.Component),we=i(442),ke=i(252),Se=i(118);if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)var Me=window.require("electron").ipcRenderer;else Me=!1;var Oe=function(e){function t(e){var i;return Object(b.a)(this,t),(i=Object(x.a)(this,Object(w.a)(t).call(this,e))).state={logs:[],consoleHeight:i.props.starterConsoleHeight,consoleWidth:i.props.starterConsoleWidth,lastFreq:0,hidden:i.props.initialHidden,x:i.props.initialPosition.x,y:i.props.initialPosition.y,zIndex:-1},i.cristalRef=g.a.createRef(),i.limit=100,i.receiveMessage=i.receiveMessage.bind(Object(E.a)(i)),i}return Object(k.a)(t,e),Object(y.a)(t,[{key:"receiveMessage",value:function(e){if("error"==e.data.type){this.logToConsole(e.data.message);var t=e.data.lineno,i=(e.data.message,e.data.id);this.props.addErrorLine(t,i)}}},{key:"componentDidMount",value:function(){window.addEventListener("message",this.receiveMessage)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.receiveMessage)}},{key:"clearConsole",value:function(){this.setState({logs:[],lastFreq:0})}},{key:"getIcon",value:function(){return G.a.ConsoleStampIcon}},{key:"toggleHide",value:function(e){var t=this;Me&&Me.send("edited"),this.state.hidden?this.setState({hidden:!1,savedIframeHeight:this.state.iframeHeight,iframeHeight:0},(function(){return t.setState({iframeHeight:t.state.savedIframeHeight},e)})):this.setState({hidden:!0},e)}},{key:"setEditorScrolling",value:function(e){this.props.disablePan(e)}},{key:"addNewIframeConsole",value:function(e){var t=this;Object(ke.Hook)(e,(function(e){e.map((function(e){"log"===e.method&&"Did you just try to use p5.js's loop() function? If so, you may want to move it into your sketch's setup() function.\n\nFor more details, see: https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup"!=e.data[0]&&"Did you just try to use p5.js's noLoop() function? If so, you may want to move it into your sketch's setup() function.\n\nFor more details, see: https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup"!=e.data[0]&&t.checkLastLog(e)}))}))}},{key:"checkLastLog",value:function(e){var t=this.state.logs;if(t.length<1){this.setState({logs:[e],lastFreq:0}),(a=document.getElementById("consoleContainer"))&&(a.scrollTop=a.scrollHeight)}else{var i=t[t.length-1];if(Se.isEqual(i.data,e.data)){if(this.state.lastFreq>=this.limit)return;this.setState({lastFreq:this.state.lastFreq+1})}else{if(this.state.lastFreq>1){var n=this.state.lastFreq.toString();this.state.lastFreq>=this.limit&&(n+="+"),t.push({method:"command",data:["("+n+")"]})}var a;t.push(e),this.setState({logs:t,lastFreq:1}),(a=document.getElementById("consoleContainer"))&&(a.scrollTop=a.scrollHeight)}}}},{key:"logToConsole",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";this.checkLastLog({method:t,data:[e]})}},{key:"getData",value:function(){return{x:this.state.x,y:this.state.y,consoleWidth:this.state.consoleWidth,consoleHeight:this.state.consoleHeight,hidden:this.state.hidden,zIndex:this.state.zIndex}}},{key:"resizeConsole",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this.state.consoleWidth+t,s=this.state.consoleHeight+e;if(a<0||s<0)return!0;console.log("WIDTH",this.state.consoleWidth),n&&this.setState({consoleHeight:a,consoleWidth:s,x:i})}},{key:"render",value:function(){var e=this,t=Se.cloneDeep(this.state.logs);if(this.state.lastFreq>1){var i=this.state.lastFreq.toString();this.state.lastFreq>=this.limit&&(i+="+"),t.push({method:"command",data:["("+i+")"]});var n=document.getElementById("consoleContainer");n&&(n.scrollTop=n.scrollHeight)}return this.state.hidden?g.a.createElement("div",null):g.a.createElement(ue,{getLinesOn:this.props.getLinesOn,getSnapMargin:this.props.getSnapMargin,zIndex:this.props.starterZIndex,getScale:this.props.getScale,parentID:this.props.id,ref:this.cristalRef,closeHidden:!0,copyHidden:!0,onResize:this.resizeConsole.bind(this),initialPosition:{x:this.state.x,y:this.state.y},onMove:function(t){return e.setState({x:t.x,y:t.y})},onStartResize:this.props.onStartMove.bind(this),onStopResize:this.props.onStopMove.bind(this),className:"stamp bg-lightGrey border border-borderGrey shadow-sm",icon:this.getIcon(),showClear:!0,onZChange:function(t){return e.setState({zIndex:t.zIndex})},onClear:this.clearConsole.bind(this),initialSize:{width:this.state.consoleWidth+22,height:this.state.consoleHeight+50}},g.a.createElement("div",{id:"consoleContainer",onMouseOver:function(){return e.setEditorScrolling(!0)},onMouseOut:function(){return e.setEditorScrolling(!1)},style:{width:this.state.consoleWidth,height:this.state.consoleHeight,overflow:"hidden","overflow-y":"scroll","white-space":"nowrap"}},g.a.createElement(ke.Console,{styles:{LOG_COLOR:"black",LOG_ERROR_BACKGROUND:"rgba(255, 184, 0, .5)",LOG_ERROR_BORDER:"transparent",LOG_ERROR_COLOR:"rgba(102,102,102)",BASE_FONT_FAMILY:"Inconsolata",BASE_FONT_SIZE:10,LOG_COMMAND_COLOR:"rgba(150,150,150)",BASE_BACKGROUND_COLOR:"transparent",LOG_BORDER:"rgb(225,225,225)",LOG_COMMAND_ICON:""},logs:t,variant:"light"})))}}]),t}(m.Component),Ie=i(248),Ee=(i(134),i(249)),Ce=i.n(Ee),De=i(69),ze=i.n(De),je=i(173),Le=i(19);i(118),i(181);if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)var Te=window.require("electron").ipcRenderer;else Te=!1;var We=function(e){function t(e){var i;return Object(b.a)(this,t),(i=Object(x.a)(this,Object(w.a)(t).call(this,e))).editorRef=g.a.createRef(),i.minPickerHeight=70,i.minJsImporterHeight=30,i.topBarHeight=60,i.minWidth=150,i.minNonSideBarWidth=30,i.editorRef=g.a.createRef(),i.importButtonHeight=50,i.spanWidth=5,i.spanWidthWide=60,i.receiveMessage=i.receiveMessage.bind(Object(E.a)(i)),i.state={worldDropDowns:[],jsImporterHeight:110,sideBarWidth:200,pickerHeight:window.innerHeight-(i.topBarHeight+i.importButtonHeight+110),pickerScrollEnabled:!0,codeHasError:!1,code:"\n// import unstructured Javascript code or individual functions\n\n// like the below, feel free to delete: \nfunction noiseWave() {\n\xa0\xa0let noiseScale=0.02;\n\xa0\xa0background(0);\n\xa0\xa0for (let x=0; x < width; x++) {\n\xa0\xa0\xa0\xa0let noiseVal = noise((mouseX+x)*noiseScale, mouseY*noiseScale);\n\xa0\xa0\xa0\xa0stroke(noiseVal*255);\n\xa0\xa0\xa0\xa0line(x, mouseY+noiseVal*80, x, height);\n\xa0\xa0}\n}"},i}return Object(k.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){this.props.updateControlBarDimensions(this.state.sideBarWidth,this.topBarHeight),window.addEventListener("resize",this.onWindowResize.bind(this)),window.addEventListener("message",this.receiveMessage)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("message",this.receiveMessage)}},{key:"receiveMessage",value:function(e){"worlds"==e.data.type&&this.setWorldDropDowns()}},{key:"onWindowResize",value:function(e){this.setState({pickerHeight:window.innerHeight-(this.topBarHeight+this.importButtonHeight+this.state.jsImporterHeight)}),this.state.sideBarWidth>window.innerWidth-this.minNonSideBarWidth&&this.setState({sideBarWidth:window.innerWidth-this.minNonSideBarWidth})}},{key:"renderSideBar",value:function(){var e=this;return g.a.createElement("div",{class:"bg-white border border-borderGrey shadow-sm",onMouseOver:function(){e.props.disablePan(!0),e.props.disableZoom(!0)},onMouseOut:function(){e.props.disablePan(!1),e.props.disableZoom(!1)},style:{position:"absolute",top:this.topBarHeight,left:0,height:window.innerHeight-this.topBarHeight,zIndex:1e18}},g.a.createElement(be.Resizable,{width:this.state.sideBarWidth,onResize:function(t){var i=e.state.sideBarWidth+t.movementX;i>e.minWidth&&i<=window.innerWidth-e.minNonSideBarWidth&&e.setState({sideBarWidth:i},(function(){return e.editorRef.current.editor.resize()}))},onResizeStop:function(t){return e.props.updateControlBarDimensions(e.state.sideBarWidth,e.topBarHeight)},height:window.innerHeight-this.topBarHeight,axis:"x",handle:this.renderSideBarResizeHandle()},g.a.createElement("div",null,this.renderLayerPicker(),this.renderJsImporter(),this.renderImportButton())))}},{key:"parseCode",value:function(){try{this.props.addRawJavascript(this.state.code),this.setState({code:""})}catch(e){this.setState({codeHasError:!0})}}},{key:"renderJsImporter",value:function(){var e=this;return g.a.createElement("div",{class:"bg-jsArea",style:{width:this.state.sideBarWidth,height:window.innerHeight-(this.state.pickerHeight+this.topBarHeight)}},g.a.createElement(ve.a,{style:{width:this.state.sideBarWidth,height:window.innerHeight-(this.state.pickerHeight+this.topBarHeight+this.importButtonHeight),background:"transparent",fontFamily:"Inconsolata"},mode:"javascript",theme:"p5",onChange:function(t){return e.setState({code:t,codeHasError:!1})},name:"jsImporter",fontSize:G.a.codeSize,showPrintMargin:!1,wrapEnabled:!0,showGutter:!1,highlightActiveLine:!1,onMouseOver:function(){return e.props.disablePan(!0)},onMouseOut:function(){return e.props.disablePan(!1)},value:this.state.code,ref:this.editorRef,setOptions:{tabSize:2,hasCssTransforms:!0}}))}},{key:"renderImportButton",value:function(){var e="import javascript",t="grey";return this.state.codeHasError&&(e="syntax error",t="warningOrangeDark"),g.a.createElement("div",{class:"p-2",style:{position:"absolute",bottom:-2,left:-5,width:"100%"}},g.a.createElement("button",{class:"btn btn-block shadow-sm m-1 bg-"+t+" border-borderGrey",style:{fontSize:G.a.buttonTextSize},onClick:this.parseCode.bind(this),disabled:this.state.codeHasError},e))}},{key:"getDraggableClass",value:function(e,t){var i;return i=e.isDragging?"border border-lightGreyText":"border-bottom border-borderGrey",t?e.isDragging?i+=" bg-warningOrange":i="border-bottom border-white bg-warningOrange":i+=" bg-white",i}},{key:"renderPicker",value:function(e){var t=this;if(e.status)var i=e.toggleOnIcon,n=function(){return s(t.state.sideBarWidth,t.topBarHeight)};else i=e.toggleOffIcon,n=null;var a=1,s=e.centerCallback;if(!1===e.status&&e.icon!=G.a.EmptyIcon&&(a=.5,s=function(){return null}),e.centerCallback||(s=function(){return null},n=null),e.icon===G.a.EmptyIcon){i=e.toggleOnIcon;if(!1===e.status)i=e.toggleOffIcon}return g.a.createElement("div",{style:{opacity:a,width:this.state.sideBarWidth},class:"d-flex justify-content-between p-1 pl-2 pr-3"},g.a.createElement("div",{clas:"row",style:{overflow:"hidden",cursor:"auto"},onClick:function(){return s(t.state.sideBarWidth,t.topBarHeight)}},this.createIcon("type"+e.id.toString(),e.icon,n,e.name)),g.a.createElement("div",{style:{cursor:"auto"}},this.createIcon("hide"+e.id.toString(),i,e.hideCallback)))}},{key:"renderPickers",value:function(e,t){var i=this,n=[],a="hidden";return this.state.pickerScrollEnabled&&(a="scroll"),this.props.pickerData.map((function(e,t){e.isSetting?n.push(i.renderSettingsPicker(e)):n.push(g.a.createElement(je.b,{draggableId:e.id.toString(),index:t},(function(t,n){return g.a.createElement("div",Object.assign({class:i.getDraggableClass(n,e.hasError),ref:t.innerRef},t.draggableProps,t.dragHandleProps),i.renderPicker(e))})))})),g.a.createElement("div",Object.assign({className:" bg-white",style:{"overflow-y":a,width:this.state.sideBarWidth,flexGrow:1},ref:e.innerRef},e.droppableProps),n,e.placeholder,g.a.createElement("br",null),g.a.createElement("br",null))}},{key:"renderSettingsPicker",value:function(e){return g.a.createElement("div",{class:"border-bottom border-borderGrey bg-grey"},this.renderPicker(e))}},{key:"renderSettingsPickers",value:function(){var e=this,t=this.props.settingsPicker.map((function(t){return e.renderSettingsPicker(t)}));return g.a.createElement("div",{class:"bg-white  border-bottom border-borderGrey shadow-sm",style:{zIndex:2}},t)}},{key:"renderLayerPicker",value:function(){var e=this;return g.a.createElement(be.Resizable,{width:this.state.sideBarWidth,onResize:function(t){var i=e.state.pickerHeight+t.movementY;i>e.minPickerHeight&&i<window.innerHeight-(e.topBarHeight+e.minJsImporterHeight+ +e.importButtonHeight)&&e.setState({pickerHeight:e.state.pickerHeight+t.movementY,jsImporterHeight:e.state.jsImporterHeight-t.movementY},(function(){return e.editorRef.current.editor.resize()}))},onResizeStart:function(){return e.setState({pickerScrollEnabled:!1})},onResizeStop:function(){return e.setState({pickerScrollEnabled:!0})},height:this.state.pickerHeight,axis:"y",handle:this.renderPickerResizeHandle()},g.a.createElement("div",{style:{overflow:"hidden",flexFlow:"column",display:"flex",height:this.state.pickerHeight}},this.renderSettingsPickers(),g.a.createElement(je.a,{onDragEnd:this.props.onDragEnd},g.a.createElement(je.c,{droppableId:"droppable"},this.renderPickers.bind(this)))))}},{key:"createIcon",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0,a=function(){U()("."+e+"Icon").css({opacity:"1"}),U()("."+e+"Text").removeClass("text-greyText").addClass("text-greyIcon")},s=function(){U()("."+e+"Icon").css({opacity:G.a.iconOpacity}),U()("."+e+"Text").addClass("text-greyText").removeClass("text-greyIcon")};return i||(a=function(){},s=function(){}),n?g.a.createElement("div",{onMouseOver:a,onMouseOut:s},g.a.createElement("img",{style:{height:G.a.iconSize,opacity:G.a.iconOpacity,width:G.a.iconSize},className:" m-1 text-greyIcon "+e+"Icon",onClick:i,src:t}),g.a.createElement("b",{class:"text-greyText picker ml-1 "+e+"Text"},n)):g.a.createElement("img",{style:{height:G.a.iconSize,opacity:G.a.iconOpacity,width:G.a.iconSize},className:" m-1 text-greyIcon "+e+"Icon",onClick:i,onMouseOver:a,onMouseOut:s,src:t})}},{key:"renderSideBarResizeHandle",value:function(){return g.a.createElement("div",{style:{width:10,cursor:"ew-resize",height:"100%",right:0,top:0,position:"absolute",background:"transparent",color:"transparent"}},"hi")}},{key:"renderPickerResizeHandle",value:function(){return g.a.createElement("span",{className:"border-bottom border-borderGrey border-top bg-grey",style:{width:"100%",cursor:"ns-resize",height:15,right:0,bottom:0,position:"absolute",background:"transparent"}})}},{key:"renderTopBar",value:function(){var e=this;return g.a.createElement("div",{class:"bg-white border border-borderGrey shadow-sm row justify-content-between",style:{position:"absolute",top:0,left:15,height:this.topBarHeight+2,width:"100%",zIndex:1e18},onMouseOver:function(){e.props.disablePan(!0),e.props.disableZoom(!0)},onMouseOut:function(){e.props.disablePan(!1),e.props.disableZoom(!1)}},g.a.createElement("span",{hidden:!Te}),g.a.createElement("div",{class:"row pl-5",hidden:Te},g.a.createElement(Fe,{disablePan:this.props.disablePan,disableZoom:this.props.disableZoom,iconType:G.a.UploadIcon,uniqueClass:"upload",iconCallback:function(){e.props.modalManagerRef.current.requestUpload()},tooltipText:"upload sketch",alignLeft:!0}),g.a.createElement("span",{style:{width:this.spanWidthWide}}),g.a.createElement(Fe,{disablePan:this.props.disablePan,disableZoom:this.props.disableZoom,iconType:G.a.DownloadIcon,uniqueClass:"download",iconCallback:function(){e.props.modalManagerRef.current.requestDownload()},tooltipText:"download sketch"})),g.a.createElement("div",{class:"row"},g.a.createElement(Fe,{disablePan:this.props.disablePan,disableZoom:this.props.disableZoom,iconType:G.a.FunctionStampIcon,uniqueClass:"basic",iconCallback:function(){return e.props.addStamp(Le.c,(function(t){e.props.requestCompile(t),window.postMessage({type:"edited"},"*")}))},dropDownData:Le.a.map((function(t){return{name:t.name,icon:G.a.BuiltInStampIcon,callback:function(){return e.props.addStamp(t,(function(t){e.props.requestCompile(t),window.postMessage({type:"edited"},"*")}))}}})).concat([{}]).concat(Le.b.map((function(t){return{name:t.name,icon:G.a.ListenerStampIcon,callback:function(){return e.props.addStamp(t,(function(t){e.props.requestCompile(t),window.postMessage({type:"edited"},"*")}))}}}))),tooltipText:"function"}),g.a.createElement("span",{style:{width:this.spanWidth}}),g.a.createElement(Fe,{disablePan:this.props.disablePan,disableZoom:this.props.disableZoom,iconType:G.a.BlobStampIcon,uniqueClass:"varStamp",iconCallback:function(){return e.props.addStamp(Le.g[0].data,(function(t){e.props.requestCompile(t),window.postMessage({type:"edited"},"*")}))},dropDownData:Le.g.map((function(t){return{name:t.name,icon:G.a.BlobStampIcon,callback:function(){return e.props.addStamp(t.data,(function(t){e.props.requestCompile(t),window.postMessage({type:"edited"},"*")}))}}})),tooltipText:"global"}),g.a.createElement("span",{style:{width:this.spanWidth}}),g.a.createElement(Fe,{disablePan:this.props.disablePan,disableZoom:this.props.disableZoom,iconType:G.a.FileStampIcon,uniqueClass:"fileStamp",iconCallback:function(){return e.props.modalManagerRef.current.requestFileUpload("text")},tooltipText:"file",dropDownData:[{name:"upload files",icon:G.a.FileStampIcon,callback:function(){return e.props.modalManagerRef.current.requestFileUpload("text")}},{name:"new file",icon:G.a.FileStampIcon,callback:function(){return e.props.addStamp(Le.d,(function(t){e.props.requestCompile(t),window.postMessage({type:"edited"},"*")}))}}]}),g.a.createElement("span",{style:{width:this.spanWidth}}),g.a.createElement(Fe,{iconType:G.a.ImageStampIcon,uniqueClass:"imageStamp",iconCallback:function(){return e.props.modalManagerRef.current.requestFileUpload()},tooltipText:"media",disablePan:this.props.disablePan,disableZoom:this.props.disableZoom}),g.a.createElement("span",{style:{width:this.spanWidthWide}}),g.a.createElement(Fe,{disablePan:this.props.disablePan,disableZoom:this.props.disableZoom,iconType:G.a.ClearConsoleIcon,uniqueClass:"undoDelete",iconCallback:function(){return e.props.undoDelete()},dropDownData:this.props.deletedStamps.map((function(t,i){return{name:t.name,icon:t.icon,callback:function(){return e.props.undoDelete(i)}}})).reverse(),tooltipText:"undo delete",disabled:0===this.props.deletedStamps.length})),g.a.createElement("span",{hidden:!0}),g.a.createElement("div",{className:"pr-5 row"},g.a.createElement(Fe,{iconType:G.a.WorldsIcon,uniqueClass:"worlds",iconCallback:null,dropDownData:this.state.worldDropDowns,tooltipText:"examples...",alignRight:!0,disablePan:this.props.disablePan,disableZoom:this.props.disableZoom})))}},{key:"setWorldDropDowns",value:function(){var e=this,t=[{name:"publish current sketch",callback:function(){return e.props.modalManagerRef.current.requestPublish()},icon:G.a.UploadIcon}];t.push({name:"get current example info",callback:function(){return e.props.modalManagerRef.current.requestPublishInfo()},icon:G.a.InfoIcon}),Te?this.setState({worldDropDowns:t}):(t.push({}),this.props.modalManagerRef.current.getWorldNamesAndKeys((function(i){i.map((function(i){t.push({name:i.name,callback:function(){window.open(e.props.modalManagerRef.current.worldKeyToUrl(i.key),"_blank")}}),e.setState({worldDropDowns:t})}))})))}},{key:"render",value:function(){return g.a.createElement("div",null,this.renderSideBar(),this.renderTopBar())}}]),t}(m.Component),Fe=function(e){function t(e){var i;return Object(b.a)(this,t),(i=Object(x.a)(this,Object(w.a)(t).call(this,e))).state={down:!1,mouseOverDropDown:!1},i.topBarHeight=60,i}return Object(k.a)(t,e),Object(y.a)(t,[{key:"onMouseDown",value:function(){!1===this.state.mouseOverDropDown&&(this.props.disablePan(!1),this.props.disableZoom(!1),this.setState({down:!1}))}},{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMouseDown.bind(this))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMouseDown)}},{key:"createTopButtonIcon",value:function(e,t,i,n){var a=this,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=(arguments.length>5&&arguments[5],i),r=function(){a.setState({mouseOverDropDown:!0},(function(){return U()("."+o).css({opacity:"1"})}))},l=function(){a.setState({mouseOverDropDown:!1},(function(){(!1===a.state.down||e!=G.a.ExpandMoreIcon&&a.props.iconCallback)&&U()("."+o).css({opacity:G.a.iconOpacity})}))};return t||!1!==s||(t=function(){return a.setState({down:!a.state.down})},o+="expand"),s&&(r=function(){return null},l=function(){return null}),this.props.disabled&&(r=function(){return null},t=function(){return null}),g.a.createElement("img",{style:{opacity:G.a.iconOpacity,height:n,width:n},className:" text-greyIcon "+o,onClick:t,onMouseOver:r,onMouseOut:l,src:e})}},{key:"getUniqueID",value:function(){return Math.random().toString(36).substr(2,9)}},{key:"renderDropDowns",value:function(){var e=this;if(!1===this.state.down)return null;var t=this.props.dropDownData.map((function(t){var i="";return t.name?(i=e.getUniqueID(),g.a.createElement("div",{class:e.props.uniqueClass+i+" picker text-greyText p-1 pl-3 pr-3",onMouseOver:function(){t.name&&(e.setState({mouseOverDropDown:!0}),U()("."+e.props.uniqueClass+i).css({background:"rgb(240, 240, 240)"}))},onMouseOut:function(){t.name&&(e.setState({mouseOverDropDown:!1}),U()("."+e.props.uniqueClass+i).css({background:"transparent"}))},onClick:function(){t.name&&(t.callback(),e.setState({down:!1}))}},g.a.createElement("a",{className:"mr-2",hidden:!t.name||!t.icon},e.createTopButtonIcon(t.icon,void 0,"dropDown",12,!0,e.props.disabled)),t.name)):g.a.createElement("div",null,g.a.createElement("div",{style:{height:5,color:"transparent",width:"100%"}},"hi"),g.a.createElement("div",{className:"border-top border-borderGrey",style:{height:5,color:"transparent",width:"100%"}},"hi"))})),i="default";this.props.alignRight&&(i=0);var n=window.innerHeight-this.topBarHeight;return g.a.createElement("div",{class:"bg-white border border-borderGrey rounded mt-2 justify-content-left",style:{position:"absolute",right:i,"overflow-y":"scroll",maxHeight:n}},t)}},{key:"renderTooltip",value:function(){var e="-140px";if(this.props.dropDownData)e="-133px";return g.a.createElement("div",{style:{position:"absolute",top:5}},g.a.createElement("div",{style:{position:"absolute",width:300,left:e}},g.a.createElement("div",{class:"picker text-greyText tooltip"+this.props.uniqueClass,style:{opacity:"1",textAlign:"center"}},this.props.tooltipText)))}},{key:"render",value:function(){var e=this;this.state.down?U()("."+this.props.uniqueClass+"expand").css({opacity:"1"}):U()("."+this.props.uniqueClass+"expand").css({opacity:".5"});var t=null;this.props.dropDownData&&(t=this.createTopButtonIcon(G.a.ExpandMoreIcon,(function(){return e.setState({down:!e.state.down})}),this.props.uniqueClass+"expand",16,!1,this.props.disabled));var i=1;return this.props.disabled&&(i*=.5),g.a.createElement("div",{class:"m-3 mt-4",style:{opacity:i}},this.renderTooltip(),g.a.createElement("div",null,this.createTopButtonIcon(this.props.iconType,this.props.iconCallback,this.props.uniqueClass,20,!1,this.props.disabled),t),this.renderDropDowns())}}]),t}(m.Component),He=(i(111),i(118),i(180));i(181);if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)var Re=window.require("electron").ipcRenderer;else Re=!1;var _e=function(e){function t(e){var i,n;return Object(b.a)(this,t),(n=Object(x.a)(this,Object(w.a)(t).call(this,e))).state=(i={compiledBefore:!1,stampRefs:{},stampElems:{},scale:1,counter:0,htmlID:-1,consoleStamp:null,setupExists:!0,htmlAsksForCss:!0,htmlAsksForJs:!0,lines:[],lineData:[],traversalGraph:{},consoleId:-1,numToggles:0,originX:0,originY:0},Object(I.a)(i,"scale",1),Object(I.a)(i,"pickerData",[]),Object(I.a)(i,"sideBarWidth",0),Object(I.a)(i,"topBarHeight",0),Object(I.a)(i,"zoomDisabled",!1),Object(I.a)(i,"mouseWheelTimeout",null),Object(I.a)(i,"mouseIsDown",!1),Object(I.a)(i,"downKey",-1),Object(I.a)(i,"panDisabled",!1),Object(I.a)(i,"stampOrder",[]),Object(I.a)(i,"isMoving",!1),Object(I.a)(i,"worldKey",null),Object(I.a)(i,"worldPublishTime",null),Object(I.a)(i,"worldEdited",!1),Object(I.a)(i,"snapToGrid",!1),Object(I.a)(i,"linseOn",!1),Object(I.a)(i,"settingsPicker",[]),Object(I.a)(i,"lineData",[]),Object(I.a)(i,"deletedStamps",[]),Object(I.a)(i,"actualLinesOn",!1),Object(I.a)(i,"lastLineData",[]),Object(I.a)(i,"highlightedLines",{}),i),n.counterMutex=new Ie.Mutex,n.modalManagerRef=g.a.createRef(),n.onWheel=n.onWheel.bind(Object(E.a)(n)),n.onKeyDown=n.onKeyDown.bind(Object(E.a)(n)),n.onKeyUp=n.onKeyUp.bind(Object(E.a)(n)),n.onMouseDown=n.onMouseDown.bind(Object(E.a)(n)),n.onMouseUp=n.onMouseUp.bind(Object(E.a)(n)),n.onMouseMove=n.onMouseMove.bind(Object(E.a)(n)),n.gridSize=50,n.newStampMarginVariance=100,n.newStampMargin=20,n.space=32,n.cmd=91,n.ctrl=17,n.plus=187,n.minus=189,n.zero=48,n.g=71,n.l=76,n.shft=16,n}return Object(k.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("wheel",this.onWheel),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp),document.addEventListener("mousedown",this.onMouseDown),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove);var t=window.innerWidth/2+this.state.topBarHeight,i=window.innerHeight/2+this.state.sideBarWidth;Re&&Re.on("zoomIn",(function(){e.zoom(2*e.state.scale,t,i)})),Re&&Re.on("zoomOut",(function(){e.zoom(.5*e.state.scale,t,i)})),Re&&Re.on("zoomActual",(function(){e.zoom(1,t,i)}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("wheel",this.onWheel),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove)}},{key:"onKeyDown",value:function(e){var t=this;e.keyCode===this.space&&(document.body.style.cursor="grab");var i=window.innerWidth/2+this.state.topBarHeight,n=window.innerHeight/2+this.state.sideBarWidth;if(this.state.downKey===this.cmd||this.state.downKey===this.ctrl)e.keyCode===this.zero?(e.preventDefault(),this.zoom(1,i,n)):e.keyCode===this.plus?(e.preventDefault(),this.zoom(2*this.state.scale,i,n)):e.keyCode===this.minus&&(e.preventDefault(),this.zoom(.5*this.state.scale,i,n));else if(this.state.downKey===this.shft)if(e.keyCode===this.g){var a=this.state.snapToGrid;this.setState({snapToGrid:!a},(function(){return t.setLayerPicker()}))}else e.keyCode===this.l&&this.toggleLinesOn();else this.setState({downKey:e.keyCode})}},{key:"onKeyUp",value:function(e){document.body.style.cursor="auto",e.keyCode===this.state.downKey&&this.setState({downKey:-1})}},{key:"onMouseDown",value:function(){this.setState({mouseIsDown:!0})}},{key:"onMouseUp",value:function(){this.setState({mouseIsDown:!1})}},{key:"onMouseMove",value:function(e){this.state.mouseIsDown&&this.state.downKey==this.space&&this.pan(e.movementX,e.movementY)}},{key:"onWheel",value:function(e){var t=this,i=setTimeout((function(e){return t.onStopMove()}),250);this.state.mouseWheelTimeout?clearTimeout(this.state.mouseWheelTimeout):this.onStartMove(),this.setState({mouseWheelTimeout:i}),e.ctrlKey?this.zoom(this.state.scale-.01*e.deltaY,e.clientX,e.clientY):this.pan(-e.deltaX,-e.deltaY)}},{key:"pan",value:function(e,t){if(!this.state.panDisabled){var i=this.state,n=i.originX+e,a=i.originY+t;this.setState({originX:n,originY:a})}}},{key:"zoom",value:function(e,t,i){var n=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return null};if(!this.state.zoomDisabled){var s=this.state.scale,o=this.state.originX,r=this.state.originY;if(!(e<.1)){var l=t-o,d=i-r,c=l/s,h=d/s,p=c*e,u=h*e,m=t,g=i,f=m-p,v=g-u;this.setState({scale:e},(function(){return n.setState({originX:f,originY:v},(function(){return a()}))}))}}}},{key:"updateControlBarDimensions",value:function(e,t){this.setState({sideBarWidth:e,topBarHeight:t})}},{key:"recompileIfEnoughStamps",value:function(e){this.state.stampOrder.length===e&&this.requestCompile()}},{key:"loadStamperObject",value:function(e){var t=this;this.setState({stampRefs:{},stampElems:{},counter:0,htmlID:-1,scale:1,consoleStamp:null,consoleId:-1,originX:0,originY:0,compiledBefore:!1,stampOrder:[],worldKey:null,worldEdited:!1,worldPublishTime:null,highlightedLines:{},snapToGrid:!1,linesOn:!1,deletedStamps:[]},(function(){e.highlightedLines||(e.highlightedLines={}),t.setState({scale:e.scale,originX:e.originX,originY:e.originY,worldKey:e.worldKey,worldEdited:1==e.worldEdited,worldPublishTime:e.worldPublishTime,highlightedLines:e.highlightedLines,snapToGrid:1==e.snapToGrid,linesOn:1==e.linesOn},(function(){var i=function(){return t.recompileIfEnoughStamps(e.stamps.length)};t.addConsoleStamp(e.console);var n=e.stamps;e.stamps.length>0&&!e.stamps[0].x&&(n=t.getAutoLayout(e.stamps,e.js)),n.map((function(e){return t.addStamp(e,i)}))}))}))}},{key:"addRawJavascript",value:function(e){var t=this,i=ze.a.jsToStamps(e),n=this.getNumStamps(),a=function(){window.postMessage({type:"edited"},"*"),t.recompileIfEnoughStamps(i.stamps.length+n.stamps)};this.getAutoLayout(i.stamps,this.getExportableCode()+"\n"+e).map((function(e){return t.addStamp(e,a)}))}},{key:"getAutoLayout",value:function(e,t){t||(t="");for(var i=this.setInitialPosition("x"),n=this.setInitialPosition("y"),a=i,s=-1,o=[],r=0;r<e.length;r++){var l=e[r];l=this.getFilledInStampData(l);var d=this.getP5CanvasDimensions(t);l.iframeWidth=d.width,l.iframeHeight=d.height,l.isBlob||l.isTxtFile||(l.editorHeight=Math.max(l.editorHeight,l.iframeHeight-G.a.brHeight));var c=this.getCristalDimens(l);l.x=i,l.y=n,(i+c.width+G.a.autoLayoutMargin-this.state.originX)*this.state.scale>=window.innerWidth&&(i=a,n=n+s+G.a.autoLayoutMargin,s=-1,l.x=i,l.y=n),i+=c.width+G.a.autoLayoutMargin,s=Math.max(s,c.height),o.push(l)}return o}},{key:"getIframeErrorCallBack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=JSON.stringify(e);return"\n  // window.addEventListener('error', function(e) { \n  //   console.log(\"addEventListener\")\n  //     logToConsole(e.message, e.lineno)\n  //   }, false);\n\nwindow.onerror = function (message, url, lineno, colno) {\n\n  logToConsole(message, lineno)\n}\n\n\n// document.onwheel = function (e) {\n\n//   console.log(document)\n\n\n// }\n\nfunction logToConsole(message, lineno){\n\n\n      var adjLineNum = -1\n      var stampId\n      var ranges = ".concat(i,"\n\n      ranges.map(range => {\n        var start = range.start\n        var end = range.end\n        var id = range.id\n        var isFN = range.isFN\n        var isInRange = start + ").concat(t," < lineno + 1 && lineno -1 < end + ").concat(t,"\n\n        \n        if(isInRange){\n          adjLineNum = lineno - start - ").concat(t," + 1\n          stampId = id\n          if(range.isFn){\n            adjLineNum -= 1\n          }\n        }\n      })\n      if(stampId){\n      window.parent.postMessage({type:\"error\", message:message, lineno:adjLineNum, id:stampId}, '*')\n      }\n\n    }")}},{key:"getP5CanvasDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getExportableCode(),t={width:100,height:100},i=e.indexOf("createCanvas(");if(i<0)return t;var n=i+"createCanvas(".length,a=e.indexOf(")",n);if(a<0)return t;var s=e.substr(n,a-n).split(",");if(2!=s.length)return t;var o=Number(s[0]),r=Number(s[1]);return o&&r?{width:o,height:r}:t}},{key:"loadAssets",value:function(e){var t=this;return this.state.stampOrder.map((function(i){var n=t.state.stampRefs[i],a=n.current.state.name,s=n.current.state.code;n.current.props.isTxtFile&&(s=n.current.state.dataUri),(n.current.props.isTxtFile||n.current.props.isMediaFile)&&(e=e.split("'".concat(a,"'")).join('"'.concat(s,'"')).split("`"+a+"`").join('"'.concat(s,'"')).split('"'.concat(a,'"')).join('"'.concat(s,'"')))})),e}},{key:"getHTML",value:function(e){if(this.state.htmlID in this.state.stampRefs===!1)return"";if(e===this.state.htmlID)var t="",i=[];else{var n=this.getRunnableCode(e);t=n.runnableCode,i=n.ranges}var a=this.state.stampRefs[this.state.htmlID].current.state.code,s=Ce.a.load(a,{withStartIndices:!0}),o=s("<script type='text/javascript'>"+t+"<\/script>"),r=s('[src="sketch.js"]').length>0;!1===r&&!0===this.state.htmlAsksForJs?(this.state.consoleStamp.ref.current.logToConsole("Stamper Error: Your index.html is missing a div for sketch.js. Make sure you're linking to sketch.js and not another sketch file."),this.state.stampRefs[this.state.htmlID].current.addErrorLine(-1),this.setState({htmlAsksForJs:r})):!0===r&&!1===this.state.htmlAsksForJs&&this.setState({htmlAsksForJs:r}),s("head").prepend("<script class='errorListener' >"+this.getIframeErrorCallBack(i)+"<\/script>");for(var l=s.html(),d=0,c=0;c<l.length&&("\n"===l[c]&&(d+=1),"sketch.js"!==l.substr(c,"sketch.js".length));c++);s(".errorListener").replaceWith("<script class='errorListener'>"+this.getIframeErrorCallBack(i,d)+"<\/script>"),s('[src="sketch.js"]').replaceWith(o);a=s.html();return a=this.loadAssets(a)}},{key:"addErrorLine",value:function(e,t){t in this.state.stampRefs&&this.state.stampRefs[t].current.addErrorLine(e)}},{key:"setInitialPosition",value:function(e){return"x"===e?(-this.state.originX+this.state.sideBarWidth)/this.state.scale+50+Math.random()*this.newStampMarginVariance:"y"===e?(-this.state.originY+this.state.topBarHeight)/this.state.scale+50+Math.random()*this.newStampMarginVariance:void 0}},{key:"addConsoleStamp",value:function(e){var t={x:this.setInitialPosition("x"),y:this.setInitialPosition("y"),consoleWidth:G.a.defaultEditorWidth,consoleHeight:G.a.defaultVarEditorHeight,hidden:!1,zIndex:void 0};Object.keys(t).map((function(i){i in e&&(t[i]=e[i])})),e=t,this.createConsoleStamp(e)}},{key:"createConsoleStamp",value:function(e){var t,i,n,a,s,o,r,l,d,c,h=this;return O.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:return t=e.x,i=e.y,n=e.consoleWidth,a=e.consoleHeight,p.next=3,O.a.awrap(this.counterMutex.acquire());case 3:s=p.sent,o=this.state.counter,this.setState({counter:o+1},(function(){return s()})),r=g.a.createRef(),l=o.toString(),d=g.a.createElement(Oe,{ref:r,initialPosition:{x:t,y:i},getLinesOn:function(){return h.state.linesOn},id:l,onStartMove:this.onStartMove.bind(this),onStopMove:this.onStopMove.bind(this),disablePan:this.disablePan.bind(this),starterConsoleWidth:n,starterConsoleHeight:a,addErrorLine:this.addErrorLine.bind(this),initialHidden:e.hidden,getScale:this.getScale.bind(this),starterZIndex:e.zIndex,getSnapMargin:this.getSnapMargin.bind(this)}),c={elem:d,ref:r},this.setState({consoleStamp:c,consoleId:l});case 11:case"end":return p.stop()}}),null,this)}},{key:"getUniqueID",value:function(){return Math.random().toString(36).substr(2,9)}},{key:"getFilledInStampData",value:function(e){var t={name:"sketch",code:"rect(50, 50, 50, 50)",args:"x=mouseX, y=mouseY",x:this.setInitialPosition("x"),y:this.setInitialPosition("y"),iframeDisabled:!1,editorWidth:G.a.defaultEditorWidth,editorHeight:G.a.defaultEditorHeight-G.a.brHeight,iframeWidth:G.a.defaultIframeWidth,iframeHeight:G.a.defaultEditorHeight,isIndex:!1,isTxtFile:!1,isMediaFile:!1,isBlob:!1,hidden:!1,zIndex:void 0,codeSize:G.a.codeSize,lineHighLightingStatus:"none",id:this.getUniqueID()};if(!e.iframeWidth&&!e.iframeHeight&&!e.isIndex&&!e.isTxtFile&&!e.isMediaFile){if(e.isBlob)var i=e.code.toString();else i="function ".concat(e.name.toString(),"(").concat(e.args.toString(),"){\n  ").concat(e.code.toString(),"\n}");var n=this.getP5CanvasDimensions(this.getExportableCode()+"\n"+i);e.iframeWidth=n.width,e.iframeHeight=n.height}return Object.keys(t).map((function(i){i in e&&(t[i]=e[i])})),t}},{key:"addStamp",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};e=this.getFilledInStampData(e);var n=g.a.createRef(),a=g.a.createElement(xe,{ref:n,setDependencyLineHighlightings:this.setDependencyLineHighlightings.bind(this),onMouseOutLine:this.onMouseOutLine.bind(this),isIndex:e.isIndex,isTxtFile:e.isTxtFile,isMediaFile:e.isMediaFile,isBlob:e.isBlob,getExportableCode:this.getExportableCode.bind(this),starterZIndex:e.zIndex,starterCode:e.code,starterArgs:e.args,starterName:e.name,errorLines:{},getCristalDimens:this.getCristalDimens.bind(this),setLineData:this.setLineData.bind(this),starterEditorWidth:e.editorWidth,starterEditorHeight:e.editorHeight,initialPosition:{x:e.x,y:e.y},starterCodeSize:e.codeSize,getFirstLine:this.getFirstLine.bind(this),id:e.id,starterLineHighLightingStatus:e.lineHighLightingStatus,getP5CanvasDimensions:this.getP5CanvasDimensions.bind(this),setLayerPicker:this.setLayerPicker.bind(this),deleteFrame:this.deleteFrame,initialHidden:e.hidden,onStartMove:this.onStartMove.bind(this),onStopMove:this.onStopMove.bind(this),addStamp:this.addStamp.bind(this),onDelete:this.onDelete.bind(this),starterIframeWidth:e.iframeWidth,starterIframeHeight:e.iframeHeight,checkAllNames:this.checkAllNames.bind(this),disablePan:this.disablePan.bind(this),iframeDisabled:e.iframeDisabled,requestCompile:this.requestCompile.bind(this),getHTML:this.getHTML.bind(this),addNewIframeConsole:this.addNewIframeConsole.bind(this),getScale:this.getScale.bind(this),getLinesOn:function(){return t.state.linesOn},getSnapMargin:this.getSnapMargin.bind(this)});e.isIndex&&this.setState({htmlID:e.id}),this.addStampToState(n,a,e.id,i)}},{key:"addStampToState",value:function(e,t,i,n){var a,s,o,r;return O.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,O.a.awrap(this.counterMutex.acquire());case 2:a=l.sent,s=Object.assign({},this.state.stampRefs),o=Object.assign({},this.state.stampElems),r=Object.assign([],this.state.stampOrder),s[i]=e,o[i]=t,r.push(i),this.setState({stampRefs:s,stampElems:o,stampOrder:r},(function(){a(),n(i)}));case 10:case"end":return l.stop()}}),null,this)}},{key:"addNewIframeConsole",value:function(e){null!==this.state.consoleStamp&&this.state.consoleStamp.ref.current.addNewIframeConsole(e)}},{key:"checkForSetup",value:function(){for(var e=!1,t=Object.values(this.state.stampRefs),i=0;i<t.length;i++){"setup"===t[i].current.state.name&&(e=!0)}return this.state.setupExists&&!1===e&&this.state.consoleStamp.ref.current.logToConsole("Stamper Error: You don't have a setup. This will constrain your canvas to a default width and height."),this.setState({setupExists:e}),e}},{key:"getFileDict",value:function(){var e=this,t={};t["sketch.js"]={content:this.getExportableCode(),type:"text"};var i=this.getStamperObject();return i.js=t["sketch.js"].content,t["stamper.js"]={content:Le.e+JSON.stringify(i),type:"text"},this.state.stampOrder.map((function(i){var n=e.state.stampRefs[i],a=n.current.state.code,s=n.current.state.name;n.current.props.isTxtFile||n.current.props.isIndex?t[s]={content:a,type:"text"}:n.current.props.isMediaFile&&(t[s]={content:a,type:"media"})})),t}},{key:"setLineData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null},i=this.getLineData();this.setState({lineData:i},(function(){e.supplyLineData(),t()}))}},{key:"supplyLineData",value:function(){var e=this;this.state.stampOrder.map((function(t){e.state.stampRefs[t].current.setLineData(e.state.lineData.filter((function(e){return e.start===t})))}))}},{key:"compileSingleStamp",value:function(e,t){var i=this.state.stampRefs[e].current;if(i){var n=[];i.props.id in t&&!1===i.props.isIndex&&n.push(0),i.clearErrorsAndUpdate(n)}}},{key:"lineDataToGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={};return e.map((function(e){e.start in i||(i[e.start]=[]),e.end in i||(i[e.end]=[]),t?i[e.end].push(e.start):i[e.start].push(e.end)})),i}},{key:"requestCompile",value:function(e){var t=this;this.setLineData((function(){var e=t.checkAllNames();t.state.stampOrder.map((function(i){t.compileSingleStamp(i,e)}))}))}},{key:"disablePan",value:function(e){this.setState({panDisabled:e})}},{key:"disableZoom",value:function(e){this.setState({zoomDisabled:e})}},{key:"checkAllNames",value:function(){var e=this,t={};this.state.stampOrder.map((function(i){var n=e.state.stampRefs[i];if(!n.current.props.isBlob&&n.current){var a=n.current.state.name;a in t||(t[a]=0),t[a]+=1}}));var i={};return this.state.stampOrder.map((function(n){var a=e.state.stampRefs[n];if(!a.current.props.isBlob){if(a.current.props.isTxtFile||a.current.props.isMediaFile)He.lookup(a.current.state.name)||(i[a.current.props.id]="",e.state.consoleStamp.ref.current.logToConsole("Stamper Error: The file extension '.".concat(a.current.state.name.split(".")[a.current.state.name.split(".").length-1],"' is invalid.")));if(a.current){a.current;var s=a.current.state.name;t[s]>1&&(i[a.current.props.id]="",e.state.consoleStamp.ref.current.logToConsole("Stamper Error: Multiple Stamps shouldn't have the same name. Consider channging one of your ".concat(s,"s to something else.")))}}})),i}},{key:"getExportableCode",value:function(){var e=this,t=[],i=[],n=1;return this.state.stampOrder.map((function(a){var s=e.state.stampRefs[a];if(!(s.current.props.isTxtFile||s.current.props.isIndex||s.current.props.isMediaFile))if(s.current.props.isBlob){var o="\n"+s.current.state.code+"\n";n=e.addCodeBlock(o,s.current.props.id,t,i,n,!1)}else{var r=s.current.state,l=r.code.split("\n").join("\n  ");o="function ".concat(r.name,"(").concat(r.args,"){\n  ").concat(l,"\n}");n=e.addCodeBlock(o,s.current.props.id,t,i,n,!0)}})),t.join("\n")}},{key:"getNumLines",value:function(e){for(var t=0,i=0;i<e.length;i++)"\n"===e[i]&&(t+=1);return t}},{key:"addCodeBlock",value:function(e,t,i,n,a,s){e+="\n";var o=a,r=a+this.getNumLines(e)-1;return i.push(e),n.push({start:o,end:r,id:t,isFn:s}),r+1}},{key:"getJSLineData",value:function(){var e=this,t={},i=[];this.state.stampOrder.map((function(n){var a=e.state.stampRefs[n].current,s=a.state;if(!(a.props.isMediaFile||a.props.isTxtFile||a.props.isIndex)){if(a.props.isBlob)var o=s.code;else o="function ".concat(s.name,"(").concat(s.args,"){\n").concat(s.code,"\n}");var r=ze.a.getVariables(o);r&&(r.declared.map((function(e){return t[e]=n})),r.undeclared.map((function(e){var t=o.replace(/\s/g,""),a=t.indexOf(e)+e.length;t.length>a&&"("===t[a]&&(e+="()"),i.push({variable:e,id:n})})))}}));var n={};return i.map((function(e){var i=e.variable,a=e.id,s=t[i.split("()").join("")];s&&a&&(a+"_"+s in n||(n[a+"_"+s]=[]),n[a+"_"+s].push(i))})),Object.keys(n).map((function(t){return e.getLineRelation(t.split("_")[1],t.split("_")[0],"js",n[t].join(", "))}))}},{key:"isFnStamp",value:function(e){var t=this.state.stampRefs[e].current.props;return!t.isBlob&&!t.isMediaFile&&!t.isTxtFile&&!t.isIndex}},{key:"getListenerLineData",value:function(){var e=this,t=[],i=[];return this.state.stampOrder.map((function(i){var n=e.state.stampRefs[i].current;e.isListener(n.state.name)&&t.push(n.props.id)})),this.state.stampOrder.map((function(n){var a=e.state.stampRefs[n].current;!e.isListener(a.state.name)&&e.isFnStamp(n)&&"setup"!==a.state.name&&"preload"!==a.state.name&&t.map((function(t){i.push(e.getLineRelation(t,n,"listener"))}))})),i}},{key:"getSetupLineData",value:function(){for(var e,t=this,i=[],n=0;n<this.state.stampOrder.length;n++){var a=this.state.stampOrder[n];"setup"===this.state.stampRefs[a].current.state.name&&(e=a)}return e&&this.state.stampOrder.map((function(n){t.isFnStamp(n)&&e!=n&&"preload"!=t.state.stampRefs[n].current.state.name&&i.push(t.getLineRelation(e,n,"setup"))})),i}},{key:"getPreloadLineData",value:function(){for(var e,t=this,i=[],n=0;n<this.state.stampOrder.length;n++){var a=this.state.stampOrder[n];"preload"===this.state.stampRefs[a].current.state.name&&(e=a)}return e&&this.state.stampOrder.map((function(n){t.isFnStamp(n)&&e!=n&&i.push(t.getLineRelation(e,n,"preload"))})),i}},{key:"getIndexLineData",value:function(){for(var e,t=this,i=[],n=0;n<this.state.stampOrder.length;n++){var a=this.state.stampOrder[n];this.state.stampRefs[a].current.props.isIndex&&(e=a)}if(e){if(!this.fileIsReferenced(this.state.stampRefs[e].current.state.code,"sketch.js"))return[];this.state.stampOrder.map((function(n){t.isFnStamp(n)&&i.push(t.getLineRelation(e,n,"index"))}))}return i}},{key:"fileIsReferenced",value:function(e,t){return e.includes("'".concat(t,"'"))||e.includes('"'.concat(t,'"'))||e.includes("`"+t+"`")}},{key:"getLineLabel",value:function(e,t,i){var n="transparent",a=this.getLineColor(t,.9);return i&&(n=this.getLineColor(t,1),a="white"),g.a.createElement("div",{className:"name rounded p-2",style:{transform:"scale(0.8)",color:a,backgroundColor:n,cursor:"default",userSelect:"none"}},e)}},{key:"getLineColor",value:function(e,t){return"file"===e?"rgba(140,154, 53, "+t+")":"js"===e?"rgba(70,160,206, "+t+")":"listener"===e?"rgba(218,16,96, "+t+")":"rgba(170,170,170, "+t+")"}},{key:"getLineStyle",value:function(e,t){var i=.15;return t&&(i=1),{strokeColor:this.getLineColor(e,i),strokeWidth:5,arrowLength:4,arrowThickness:4}}},{key:"getLineRelation",value:function(e,t,i,n){var a=e+"_"+t in this.state.highlightedLines;return n||(n=i),{end:t,start:e,type:i,label:this.getLineLabel(n,i,a),style:this.getLineStyle(i,a)}}},{key:"getFileLineData",value:function(){var e=this,t={},i=[];return this.state.stampOrder.map((function(i){var n=e.state.stampRefs[i].current;(n.props.isMediaFile||n.props.isTxtFile||n.props.isIndex)&&(t[n.state.name]=i)})),this.state.stampOrder.map((function(n){var a=e.state.stampRefs[n].current;Object.keys(t).map((function(s){e.fileIsReferenced(a.state.code,s)&&i.push(e.getLineRelation(t[s],n,"file",s))}))})),i}},{key:"setDependencyLineHighlightings",value:function(e){var t=this,i=this.lineDataToGraph(this.state.lineData);this.state.stampOrder.map((function(e){t.state.stampRefs[e].current.setLineHighlighted("off")})),this.state.stampRefs[e].current.setLineHighlighted("on");var n={};i[e]&&i[e].map((function(i){n[e+"_"+i]="",t.state.stampRefs[i].current.setLineHighlighted("on")})),this.setState({highlightedLines:n},(function(){return t.setLineData()}))}},{key:"onMouseOverLine",value:function(e){var t=this,i=e.source.id.split("_").pop(),n=e.target.id.split("_").pop();this.state.stampOrder.map((function(e){t.state.stampRefs[e].current.setLineHighlighted("off")})),this.state.stampRefs[i].current.setLineHighlighted("on"),this.state.stampRefs[n].current.setLineHighlighted("on");var a={};a[i+"_"+n]="",this.setState({highlightedLines:a},(function(){t.setLineData()}))}},{key:"onMouseOutLine",value:function(){var e=this;this.state.stampOrder.map((function(t){e.state.stampRefs[t].current.setLineHighlighted("none")})),this.setState({highlightedLines:{}},(function(){return e.setLineData()}))}},{key:"getLineData",value:function(){var e=[];e=(e=(e=(e=(e=(e=e.concat(this.getJSLineData())).concat(this.getListenerLineData())).concat(this.getSetupLineData())).concat(this.getIndexLineData())).concat(this.getPreloadLineData())).concat(this.getFileLineData());var t={};return(e=e.filter((function(e){var i=e.start+"_"+e.end;return i in t===!1&&(t[i]=0),t[i]+=1,1===t[i]&&e.start!=e.end}))).map((function(e){e.targetAnchor="middle",e.sourceAnchor="middle",e.targetId="line_"+e.end})),e}},{key:"getInfluencingStamps",value:function(e,t,i){var n=this;i[e]="",t[e].map((function(e){return n.getInfluencingStamps(e,t,i)}))}},{key:"getRunnableCode",value:function(e){var t,i=this,n=[],a=[],s=1,o=this.lineDataToGraph(this.state.lineData,!0),r={};if(this.getInfluencingStamps(e,o,r),this.state.stampOrder.map((function(t){var o=i.state.stampRefs[t];if("draw"!=o.current.state.name&&!1===o.current.props.isTxtFile&&!1===o.current.props.isMediaFile&&!1===o.current.props.isIndex&&(!i.isListener(o.current.state.name)||!i.isListener(i.state.stampRefs[e].current.state.name))&&(!i.isListener(o.current.state.name)||"setup"!==i.state.stampRefs[e].current.state.name&&"preload"!==i.state.stampRefs[e].current.state.name)&&(t in r||o.current.state.name===i.state.stampRefs[e].current.state.name)){var l=o.current.state;if(o.current.props.isBlob){var d=l.code;s=i.addCodeBlock(d,o.current.props.id,n,a,s,!1)}else{d="function ".concat(l.name,"(").concat(l.args,"){\n").concat(l.code,"\n}");s=i.addCodeBlock(d,o.current.props.id,n,a,s,!0)}}})),e in this.state.stampRefs==0||null===this.state.stampRefs[e].current)return{ranges:a,runnableCode:n.join("")};var l=this.state.stampRefs[e].current,d=l.state;if("draw"===d.name||this.isListener(d.name)){var c="function ".concat(d.name,"(").concat(d.args,"){\n").concat(d.code,"\n}");s=this.addCodeBlock(c,l.props.id,n,a,s,!0)}else"setup"===d.name||"preload"===d.name||(t="function draw(){\n".concat(d.name,"()\n}"),s=this.addCodeBlock(t,l.props.id,n,a,s,!1));return n=this.setLoopingControl(e,n.join(""),d.name),{ranges:a,runnableCode:n}}},{key:"setLoopingControl",value:function(e,t){var i='\n\nvar _isLooping = true\n\nwindow.parent.postMessage({type:"loop", message:"stop", id:"'.concat(e,'"}, \'*\')\nvar _userSetLoop = true\nvar _stopLooping = setTimeout(() => {\n noLoop() \n}, 1000)\n\ndocument.addEventListener(\'mouseenter\', () => {\nclearTimeout(_stopLooping)\nwindow.parent.postMessage({type:"loop", message:"start", id:"').concat(e,'"}, \'*\')\nif(_isLooping){\n\nloop()\n}\n\n});\n\ndocument.addEventListener(\'mouseleave\', () => {\n  window.parent.postMessage({type:"loop", message:"stop", id:"').concat(e,"\"}, '*')\n_stopLooping =setTimeout(() => {\n noLoop() \n}, 1000)\n});\n\n");return t=(t=t.split("noLoop()").join("noLoop(); _isLooping = false")).split("loop()").join("loop(); _isLooping = true"),t+=i}},{key:"isListener",value:function(e){return e in G.a.specialFns&&!1===G.a.specialFns[e]}},{key:"onDelete",value:function(e){var t,i,n,a,s,o,r=this;return O.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(window.postMessage({type:"edited"},"*"),!(e in this.state.stampRefs)){l.next=16;break}return l.next=4,O.a.awrap(this.counterMutex.acquire());case 4:t=l.sent,i=Object.assign({},this.state.stampRefs),n=Object.assign({},this.state.stampElems),a=Object.assign([],this.state.deletedStamps),s=i[e].current.getData(),a.push(s),delete i[e],n[e]=g.a.createElement("span",{hidden:!0}),(o=Object.assign([],this.state.stampOrder)).splice(o.indexOf(e),1),this.setState({stampRefs:i,stampElems:n,stampOrder:o,deletedStamps:a},(function(){return r.requestCompile(e)})),t();case 16:case"end":return l.stop()}}),null,this)}},{key:"undoDelete",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.deletedStamps.length-1;if(!(this.state.deletedStamps.length<=t||t<0)){var i=Object.assign([],this.state.deletedStamps),n=i[t];i.splice(t,1),this.setState({deletedStamps:i}),this.addStamp(n,(function(t){e.requestCompile(t),window.postMessage({type:"edited"},"*")}))}}},{key:"refreshConsoleStamp",value:function(e){var t=this,i=e.ref.current.getData();this.setState({consoleStamp:null},(function(){return t.addConsoleStamp(i)}))}},{key:"getStamperObject",value:function(e){var t=this,i={stamps:[],scale:this.state.scale,console:this.state.consoleStamp.ref.current.getData(),originX:this.state.originX,originY:this.state.originY,worldKey:this.state.worldKey,worldEdited:this.state.worldEdited,worldPublishTime:this.state.worldPublishTime,snapToGrid:this.state.snapToGrid,linesOn:this.state.linesOn,js:this.getExportableCode(),highlightedLines:this.state.highlightedLines};return this.state.stampOrder.map((function(n){if(n!=e){var a=t.state.stampRefs[n];i.stamps.push(a.current.getData())}})),i}},{key:"onStartMove",value:function(){this.setState({isMoving:!0});var e=this.state.stampRefs;for(var t in e){e[t].current.setIframeDisabled(!0)}}},{key:"onStopMove",value:function(){this.setState({mouseWheelTimeout:null,isMoving:!1});var e=this.state.stampRefs;for(var t in e){e[t].current.setIframeDisabled(!1)}}},{key:"centerOnStamp",value:function(e,t,i){var n;if(e in this.state.stampRefs?n=this.state.stampRefs[e].current:this.state.consoleStamp.ref.current&&e===this.state.consoleStamp.ref.current.props.id&&(n=this.state.consoleStamp.ref.current),n){var a=n.cristalRef.current;if(a){var s=this.state.originX+a.state.x*this.state.scale,o=this.state.originY+a.state.y*this.state.scale,r=a.state.width,l=a.state.height,d=(window.innerWidth-t)/2+t-r/2*this.state.scale,c=(window.innerHeight-i)/2+i-l/2*this.state.scale;this.manualPan(d-s,c-o),a.changeZIndex()}}}},{key:"manualPan",value:function(e,t){U()(".allStamps").css({transition:"all .5s ease"}),setTimeout((function(){U()(".allStamps").css({transition:""})}),500),window.postMessage({type:"edited"},"*"),this.setState({originX:this.state.originX+e,originY:this.state.originY+t})}},{key:"toggleHide",value:function(e){var t=this;e.toggleHide((function(){t.setLayerPicker()}))}},{key:"getFirstLine",value:function(e){for(var t=e.length,i=0;i<e.length;i++)"\n"===e[i]&&t===e.length&&(t=i);if(0===t)return" ";var n="";return t>15&&(t=15,n="..."),e.substr(0,t)+n}},{key:"getScale",value:function(){return this.state.scale}},{key:"getSnapMargin",value:function(){return this.state.snapToGrid?this.calcSnapMargin():0}},{key:"onDragEnd",value:function(e){var t=this;if(e.destination&&(window.postMessage({type:"edited"},"*"),0!==e.source.index&&0!==e.destination.index)){var i=Object.assign([],this.state.stampOrder),n=i.splice(e.source.index-1,1),a=Object(S.a)(n,1)[0];i.splice(e.destination.index-1,0,a),this.setState({stampOrder:[]},(function(){t.setLayerPicker(),t.setState({stampOrder:i},(function(){return t.setLayerPicker()}))}))}}},{key:"calcSnapMargin",value:function(){Math.max(20*Math.round(1/this.state.scale),5);return 20}},{key:"renderGridLines",value:function(){if(!1===this.state.snapToGrid)return null;for(var e=[],t=Math.max(Math.round(1/this.state.scale),.5),i=this.calcSnapMargin(),n=(Math.round(1/this.state.scale),this.state.originX,-this.state.originX/this.state.scale),a=-this.state.originY/this.state.scale,s=Math.round(n/i)*i,o=Math.round(a/i)*i,r=window.innerWidth/this.state.scale,l=window.innerHeight/this.state.scale,d=s;d<r+n;)e.push(g.a.createElement("span",{className:"border-borderLightGrey",style:{position:"absolute",top:o,height:l,width:10,left:d,background:"transparent",borderLeft:t+"px solid"}})),d+=i;for(var c=o;c<l+a;)e.push(g.a.createElement("span",{className:"border-borderLightGrey",style:{position:"absolute",top:c,height:10,width:r,left:s,background:"transparent",borderTop:t+"px solid"}})),c+=i;return e}},{key:"toggleLinesOn",value:function(){var e=this;this.setState({linesOn:!this.state.linesOn},(function(){e.setLayerPicker()})),this.onMouseOutLine()}},{key:"setSettingsPicker",value:function(){var e=this,t=[];t.push({name:"lines  (\u2b06L)",status:this.state.linesOn,icon:G.a.LinesIcon,hideCallback:function(){e.toggleLinesOn()},id:this.getUniqueID(),isSetting:!0,toggleOnIcon:G.a.SettingOnIcon,toggleOffIcon:G.a.SettingOffIcon}),t.push({name:"snap to grid (\u2b06G)",status:this.state.snapToGrid,icon:G.a.GridIcon,hideCallback:function(){e.setState({snapToGrid:!e.state.snapToGrid},(function(){return e.setLayerPicker()}))},id:this.getUniqueID(),isSetting:!0,toggleOnIcon:G.a.SettingOnIcon,toggleOffIcon:G.a.SettingOffIcon}),this.setState({settingsPicker:t})}},{key:"setLayerPicker",value:function(){var e=this;this.setSettingsPicker();var t=[];if(this.state.consoleStamp&&this.state.consoleStamp.ref.current){var i=this.state.consoleStamp.ref.current;t.push({name:"console",status:!i.state.hidden,icon:i.getIcon(),centerCallback:function(t,n){return e.centerOnStamp(i.props.id,t,n)},hideCallback:function(){return e.toggleHide(i)},id:i.props.id,isSetting:!0,toggleOnIcon:G.a.VisibilityIcon,toggleOffIcon:G.a.VisibilityOffIcon})}this.state.stampOrder.map((function(i){if(i in e.state.stampRefs){var n=e.state.stampRefs[i].current;if(!n)return;if(n.props.isBlob)var a=e.getFirstLine(n.state.code);else a=n.state.name}t.push({name:a,icon:n.getIcon(),status:!n.state.hidden,centerCallback:function(t,i){return e.centerOnStamp(n.props.id,t,i)},hideCallback:function(){return e.toggleHide(n)},id:n.props.id,isConsole:!1,hasError:Object.keys(n.state.errorLines).length>0,toggleOnIcon:G.a.VisibilityIcon,toggleOffIcon:G.a.VisibilityOffIcon})})),this.setState({pickerData:t})}},{key:"getNumStamps",value:function(){return{stamps:this.state.stampOrder.length}}},{key:"getWorldData",value:function(){return{worldKey:this.state.worldKey,worldPublishTime:this.state.worldPublishTime,worldEdited:this.state.worldEdited}}},{key:"getCristalDimens",value:function(e){var t=e.iframeWidth;(e.isTxtFile||e.isBlob)&&(t=0);var i=e.editorHeight+G.a.fnTitleHeight+60;return e.isMediaFile?i=e.iframeHeight+G.a.fnTitleHeight+35:e.isBlob&&(i=e.editorHeight+80),{width:t+e.editorWidth+42,height:i}}},{key:"render",value:function(){var e,t=this;if(this.state.consoleStamp)var i=this.state.consoleStamp.elem;else i=null;return g.a.createElement("div",null,g.a.createElement("div",{class:"row bg-grey",style:{height:"100vh"},onMouseUp:function(){return t.state.linesOn&&!t.state.isMoving&&t.onMouseOutLine()}},g.a.createElement("div",{className:"allStamps",style:{position:"absolute",left:this.state.originX,top:this.state.originY,transform:"scale("+this.state.scale+")"}},g.a.createElement("div",null,this.renderGridLines()),g.a.createElement(se,{onMouseOver:this.onMouseOverLine.bind(this),onMouseOut:this.onMouseOutLine.bind(this),scale:this.state.scale,top:this.state.originY,left:this.state.originX,relativeOffsetSize:25},Object.values(this.state.stampElems),i,g.a.createElement(ue,{invisible:!0})))),g.a.createElement(We,{getNumStamps:this.getNumStamps.bind(this),requestCompile:this.requestCompile.bind(this),pickerData:this.state.pickerData,addStamp:this.addStamp.bind(this),disablePan:this.disablePan.bind(this),disableZoom:this.disableZoom.bind(this),loadStamperObject:this.loadStamperObject.bind(this),updateControlBarDimensions:this.updateControlBarDimensions.bind(this),ref:this.controlBarRef,modalManagerRef:this.modalManagerRef,onDragEnd:this.onDragEnd.bind(this),recompileIfEnoughStamps:this.recompileIfEnoughStamps.bind(this),getWorldData:this.getWorldData.bind(this),settingsPicker:this.state.settingsPicker,deletedStamps:this.state.deletedStamps,undoDelete:this.undoDelete.bind(this),addRawJavascript:this.addRawJavascript.bind(this)}),g.a.createElement(we.a,(e={loadStamperObject:this.loadStamperObject.bind(this),ref:this.modalManagerRef},Object(I.a)(e,"loadStamperObject",this.loadStamperObject.bind(this)),Object(I.a)(e,"getStamperObject",this.getStamperObject.bind(this)),Object(I.a)(e,"getFileDict",this.getFileDict.bind(this)),Object(I.a)(e,"addStamp",this.addStamp.bind(this)),Object(I.a)(e,"requestCompile",this.requestCompile.bind(this)),Object(I.a)(e,"getWorldData",this.getWorldData.bind(this)),Object(I.a)(e,"setWorldData",(function(e,i){return t.setState(e,i)})),e)))}}]),t}(m.Component),Pe=function(e){function t(){return Object(b.a)(this,t),Object(x.a)(this,Object(w.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){return g.a.createElement("div",null,g.a.createElement(_e,null))}}]),t}(m.Component);i(1346);v.a.render(g.a.createElement(Pe,null),document.getElementById("root"))},156:function(e,t,i){e.exports=i.p+"static/media/box.310d8273.svg"},157:function(e,t,i){e.exports=i.p+"static/media/file.5bd43cb8.svg"},158:function(e,t,i){e.exports=i.p+"static/media/tool.d68b9b61.svg"},159:function(e,t,i){e.exports=i.p+"static/media/bell.86facacc.svg"},160:function(e,t,i){e.exports=i.p+"static/media/image.117a6d3e.svg"},161:function(e,t,i){e.exports=i.p+"static/media/chevron-down.c66b213d.svg"},162:function(e,t,i){e.exports=i.p+"static/media/download.ce2002cf.svg"},163:function(e,t,i){e.exports=i.p+"static/media/upload.14dd1331.svg"},164:function(e,t,i){e.exports=i.p+"static/media/archive.97582ec6.svg"},165:function(e,t,i){e.exports=i.p+"static/media/message-square.42f61b6c.svg"},166:function(e,t,i){e.exports=i.p+"static/media/info.47197c1b.svg"},167:function(e,t,i){e.exports=i.p+"static/media/star.ac8ea213.svg"},19:function(e,t,i){"use strict";i.d(t,"e",(function(){return a})),i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"g",(function(){return c})),i.d(t,"d",(function(){return h})),i.d(t,"f",(function(){return p})),i.d(t,"h",(function(){return u}));var n=i(2),a="/*\n".concat("   ____    __    ____      ____    ______ ______           ____    ____    ____       \n  /\\  _\\  _\\ \\ _/\\__ \\    /\\  _`\\ /\\__  _/\\  _  \\  /'\\_/`\\/\\  _`\\ /\\  _`\\ /\\  _`\\     \n  \\ \\ \\/ /\\_` ' \\/_/\\ \\   \\ \\,\\L\\_\\/_/\\ \\\\ \\ \\L\\ \\/\\      \\ \\ \\L\\ \\ \\ \\L\\_\\ \\ \\L\\ \\   \n   \\ \\ \\ \\/_>   <_ \\ \\ \\   \\/_\\__ \\  \\ \\ \\\\ \\  __ \\ \\ \\__\\ \\ \\ ,__/\\ \\  _\\L\\ \\ ,  /   \n    \\ \\ \\_ /\\_, ,_\\ \\_\\ \\    /\\ \\L\\ \\ \\ \\ \\\\ \\ \\/\\ \\ \\ \\_/\\ \\ \\ \\/  \\ \\ \\L\\ \\ \\ \\\\ \\  \n     \\ \\___\\/_/\\_\\/ /\\___\\   \\ `\\____\\ \\ \\_\\\\ \\_\\ \\_\\ \\_\\\\ \\_\\ \\_\\   \\ \\____/\\ \\_\\ \\_\\\n      \\/___/  \\/_/  \\/___/    \\/_____/  \\/_/ \\/_/\\/_/\\/_/ \\/_/\\/_/    \\/___/  \\/_/\\/ /","\n\n\nHello and welcome to your Stamper metadata file! \nThis file keeps track of all of the info Stamper needs about your stamps. \n\nDon't worry, it won't affect your sketch if you run it on any other IDE.\n\nPlease DON'T MODIFY ANY OF THE INFORMATION BELOW or else your project may behave unexpectantly in Stamper.\nHowever, if your project is acting strangely, delete this file and reopen your project. \nYou'll lose your stamps' formatting but keep all of the code.\n\nHappy Stamping :)\n\n*/\n\n"),s=[{name:"draw",args:"",code:"colorMode(RGB, 255, 255, 255, 1);\nbackground(0, 0, 0, .01);\nstroke(255);\nstrokeWeight(1)\n\nif (mouseIsPressed) {\n\xa0\xa0line(mouseX, mouseY, pmouseX, pmouseY);\n}"},{name:"setup",args:"",code:"createCanvas(".concat(n.a.defaultIframeWidth,",").concat(n.a.defaultEditorHeight,")\nbackground(100);")},{name:"preload",args:"",code:"img = loadImage('YOUR IMAGE');"}],o="fill(\"black\")\ntextSize(50);\n\n// display last key pressed.\ntext(key + ' ' + keyCode, 20, 70);",r="fill('black')\n\n// display last clicked location\ntext(mouseX + ', ' + mouseY, mouseX + 10, mouseY - 10)\nrectMode(CENTER)\nrect(mouseX, mouseY, 1, 20)\nrect(mouseX, mouseY, 20, 1)",l=[{name:"keyPressed",args:"",code:"background('yellow')\n"+o},{name:"keyReleased",args:"",code:"background('springgreen')\n"+o},{name:"keyTyped",args:"",code:"background('cyan')\n"+o},{},{name:"mousePressed",args:"",code:"background('yellow')\n"+r},{name:"mouseReleased",args:"",code:"background('springgreen')\n"+r},{name:"mouseClicked",args:"",code:"background('cyan')\n"+r},{name:"doubleClicked",args:"",code:"background('cyan')\n"+r},{},{name:"mouseMoved",args:"",code:"background(0, 10)\nstrokeWeight(0)\nfill(255)\nsize = 2*random(0, width)/3\nellipse(width/2,height/2,size, size)"},{name:"mouseDragged",args:"",code:"background(0, 10)\nstrokeWeight(0)\nfill(255)\nsize = 2*random(0, width)/3\nellipse(width/2,height/2,size, size)"},{},{name:"mouseWheel",args:"",code:"background('yellow')\nstrokeWeight(1)\nstroke(\"black\")\nvar y = random(0, height)\nline(0, y, width, y)"}],d={name:"blueCircle",args:"posX=mouseX, posY=mouseY",code:"strokeWeight(1)\nstroke(\"black\")\nfill('lightblue')\nellipse(posX, posY, 30, 30)"},c=[{name:"global variable",data:{code:"var global1 = 1",isBlob:!0}},{name:"comment",data:{code:"/*\n  comment here\n*/",codeSize:n.a.bigCodeSize,isBlob:!0}},{name:"class",data:{code:"class Jitter {\n  constructor() {\n    this.x = random(width);\n    this.y = random(height);\n    this.diameter = random(10, 30);\n    this.speed = 1;\n  }\n\n  move() {\n    this.x += random(-this.speed, this.speed);\n    this.y += random(-this.speed, this.speed);\n  }\n\n  display() {\n    ellipse(this.x, this.y, this.diameter, this.diameter);\n  }\n}",isBlob:!0}}],h={name:"sample.js",code:"// put some code to import into your js in here",isTxtFile:!0};var p={stamps:[{name:"index.html",code:'<html>\n  <head>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/p5.min.js"><\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.dom.min.js"><\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.sound.min.js"><\/script>\n    <link rel="stylesheet" type="text/css" href="style.css">\n  </head>\n  <body>\n    <script src=\'sketch.js\'><\/script>\n  </body>\n</html>\n',args:" ",x:1551.2140684066003,y:526.1806151153287,editorWidth:225,editorHeight:176.29205282888586,iframeWidth:200,iframeHeight:200,isIndex:!0,isTxtFile:!1,isMediaFile:!1,hidden:!0,exported:!0,zIndex:-1,isBlob:!1,codeSize:14},{name:"style.css",code:"html, body {\n  margin: 0;\n  padding: 0;\n}",args:" ",x:1551.6900090741035,y:889.4753177293393,editorWidth:225,editorHeight:175,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!0,isMediaFile:!1,hidden:!0,exported:!0,zIndex:-1,isBlob:!1,codeSize:14},{name:"",code:'/* READ ME\n\n    Welcome to Stamper!\n    \n    What you have before you is a p5.js sketch formatted in artboard-like items called Stamps. \n    \n    You can think of these big Stamps titled "setup", "draw", and "sizeDot" as functions. They can call one another and use global variables.\n    \n    You can also import file and media Stamps in the bar above and use the console Stamp to debug your code.\n    \n    Anything in p5.js should work in Stamper. You can upload existing p5 sketches to Stamper or download this Sketch and open it up somewhere else. \n    \n    Happy stamping, we\'re excited to see what you make! \n    \n    - Maayan & Cam\n    \n*/',args:" ",x:702.0843016558624,y:526.3886604608753,editorWidth:224.2321933879481,editorHeight:627.8573293703668,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:632,isBlob:!0,codeSize:14},{name:"",code:"var xPos = 0\nvar maxSize = 20",args:" ",x:1025.2197591789836,y:526.1831709984822,editorWidth:120.72506930849877,editorHeight:174.63795191901036,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:627,isBlob:!0,codeSize:14},{name:"setup",code:"createCanvas(200, 200)\nbackground(175, 112, 248)\nnoStroke()",args:"",x:1216.6046212636682,y:526.1050713082992,editorWidth:187.33684948280245,editorHeight:75.20212084900183,iframeWidth:47.18718026609529,iframeHeight:84.26214854159208,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:630,isBlob:!1,codeSize:14},{name:"sizeDot",code:"// generate a random size\nvar size = random(0, maxSize)\n\n// set the opacity\nvar opacity = map(size, \n    0, maxSize, \n    0, 255)\n\n// draw a dot   \nfill(255, opacity);\nellipse(x,y,size, size);\n\n",args:"x=mouseX, y=mouseY",x:1025.1123055679532,y:789.7862113698332,editorWidth:225,editorHeight:175,iframeWidth:200.4613444482518,iframeHeight:199.7524142951453,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:579,isBlob:!1,codeSize:14},{name:"draw",code:"// update xPos and background\nbackground(175, 112, 248, 10)\nxPos = (xPos +2) % width\n\n// draw a row of dots\nfor(var i = 0; \n    i < height/maxSize; \n    i++){\n      sizeDot(xPos, i*maxSize )\n}\n",args:"",x:1025.3740565788173,y:1153.6991713934658,editorWidth:225,editorHeight:175,iframeWidth:200,iframeHeight:200,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:580,isBlob:!1,codeSize:14}],scale:.7838764402270318,console:{x:700.0778726617857,y:1240.2239882058916,consoleWidth:244.781440843727,consoleHeight:199.19044002384612,hidden:!0,zIndex:-1},originX:-257.2010372715673,originY:-311.9703251082989,compressedJs:"\u0517\u4a88\u0a48\u5414\u2102\u3514\u1414\u2020\u1010\u15d9\u2d8c\u36f6\u6b29\u01d1\u5e40\u5374\u30b6\u5c19\u2e44\u1c51\u4630\u75a1\u42e8\u2079\u37ba\u481a\u0c2e\u6652\u0313\u1599\u5ee4\u65c5\u0834\u5cc8\u0c24\u0703\u2973\u29cc\u40e6\u6b65\u3a31\u5a08\u0ccd\u7726\u6b0b\u51d1\u4ac8\u2069\u3710\u185c\u4e8c\u26f6\u0b93\u10b5\u58d2\u6b65\u1034\u5d19\u2dae\u3206\u1b0b\u31b1\u4ac9\u4665\u3997\u3198\u18a0\u5596\u7ba9\u018d\u42dc\u2074\u3434\u5b9a\u640d\u7662\u03a3\u2195\u66ca\u2062\u34b3\u71cb\u240e\u4697\u2621\u6c89\u66ca\u7475\u3811\u0b08\u044c\u4726\u0bb9\u08b0\u40c2\u6ec4\u0ab4\u5e99\u288d\u7742\u1103\u05cc\u40cc\u756e\u31ba\u1a5b\u6dce\u32e2\u02a3\u2195\u738a\u57c4\u3c10\u1bdb\u4ca4\u0616\u737b\u51a1\u4ae5\u4536\u3ab9\u5948\u0ced\u46f6\u130b\u3081\u6cc2\u7269\u30b1\u1b19\u2e65\u6f20\u049b\u05b1\u66de\u2069\u36b8\u1bdc\u4e84\u0666\u4b66\u1111\u4840\u6d65\u3234\u587a\x13\u369e\u2005\u6194\u40c4\u6172\u1030\u589b\u6ed8\u622c\u22f6\u1059\u46de\u6e73\u37b6\u1971\u459c\u4016\u1323\u1589\u6acf\u6401\u20b9\u0818\u6dec\u465c\u5b92\u05b9\u73c8\u0100\u33e2\u1479\u602b\u0686\u7bab\u3190\u40ee\u6f72\u35e2\u0571\u288c\u5722\u7748\u0271\u6ae0\u6c6f\u30b2\u0819\u2f0d\u1737\u2621\u65c0\u6bce\u018b\u32b9\u7ac0\u39a4\u06f7\u1103\u11bd\u6edd\u452c\u3a34\u1a5c\u640a\u3c52\u2f28\u02a1\u5ee0\u656e\u1034\u5d08\u0eae\u0207\u1b7b\u3595\u6ed0\u6572\u3290\u195b\u0e6c\u5ec0\u0cfa\u2185\u60e0\u7920\u39e2\u13da\u2dcc\u72c2\u03bb\u149f\u084c\u7863\u34f2{\u2e8d\u7207\u1b2b\u1481\u6fd0\u0229\u36b0\u5ad9\u2439\u33e2\u6902\u3585\u42f2\u616e\u1013\u0810\u6c2d\u5c61\u4151\u3c28\u1414\u0a76\u30b9\u081e\u0a0d\u7732\u01e9\xc3\u0a1a\u6d61\u3c29\u5a5e\u4ca4\u03d2\u0191\u4028\u1415\u6801\u6610\u3940\u3ec5\u0297\u5851\x81\u46e4\u6561\u3a32\u50d8\u2dce\u6617\u1941\u48c0\u6058\u2032\u1818\u0a42\u4404\u0626\u0b1b\u2d9d\u64de\u756e\u3214\u0c4d\u66a5\u4203\u0989\u48b0\u4064\u3438\u620e\u1b9b\u6a6e\u4726\u7b5b\u14a0\u5214\u7dcc\u2bf3\x8e\u050f\u03d6\u6b7b\u55cd\u4ab0\u2c20\u3ce3\u0296\u38ad\u32f2\u7903\u1d95\u5cca\u7261\u3a32\u4818\u240e\u2616\u7323\u3db7\u0a68\u0a20\u7201\u0cf1\u2164\u03dc\u38c9\u20c0\u59d0\xbf\u6239\u318f\u6e6c\u574e\u2810\u19bd\u60c2\u6369\u3a3c\u71ce\u18e1\u6203\u6903\u3585\u6051\u4446\u1662\u0c319\u245c\u6099\u48d4\u6b94\u54e4\u017c\u4818\u240c\u46f7\u2730\u0585\u4cd2\u6c6c\u1419\u0d4d\u2599\u0582\u49d8\u2880\u40ca\u6c6c\u34b8\u1cd9\u250f\u02c7\u4966\u198b\u080d\u451b\u6201\u7b00\u20d8\u451e\u300a\u70bc\u5e40\u7570\u3272;\u7ca0\u196e\u2011\u03a8\u02ad\u7b01\u3196\u080c\u3ca0\u183c\u29b1\u7480\u518a\u082b\u1914\u4809\u240e\u7696\u23a3\u23c0\u0178\u726f\u3bf2\xf9\u2c8d\u7747\u1f20\u0305\u5ee4\u28e4\x8b\u5a79@\u73be\u4007\u5da4\u4078\u2068\u32b4\u59da\u0e85\u7e70\u0896\u286c\u5657\u6500\u57e3z\u2038\u5506\u7b99\u3081\u5255\u472e\u1072$\u2fb8\u47a7\u6850\u8002\u8001"},u=[{name:"starter",data:{stamps:[{name:"index.html",code:'<html>\n  <head>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/p5.min.js"><\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.dom.min.js"><\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.sound.min.js"><\/script>\n    <link rel="stylesheet" type="text/css" href="style.css">\n  </head>\n  <body>\n    <script src=\'sketch.js\'><\/script>\n  </body>\n</html>\n',args:" ",x:1551.2140684066003,y:526.1806151153287,editorWidth:225,editorHeight:176.29205282888586,iframeWidth:200,iframeHeight:200,isIndex:!0,isTxtFile:!1,isMediaFile:!1,hidden:!0,exported:!0,zIndex:-1,isBlob:!1,codeSize:14},{name:"style.css",code:"html, body {\n  margin: 0;\n  padding: 0;\n}",args:" ",x:1551.6900090741035,y:889.4753177293393,editorWidth:225,editorHeight:175,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!0,isMediaFile:!1,hidden:!0,exported:!0,zIndex:-1,isBlob:!1,codeSize:14},{name:"",code:'/* READ ME\n\n    Welcome to Stamper!\n    \n    What you have before you is a p5.js sketch formatted in artboard-like items called Stamps. \n    \n    You can think of these big Stamps titled "setup", "draw", and "sizeDot" as functions. They can call one another and use global variables.\n    \n    You can also import file and media Stamps in the bar above and use the console Stamp to debug your code.\n    \n    Anything in p5.js should work in Stamper. You can upload existing p5 sketches to Stamper or download this Sketch and open it up somewhere else. \n    \n    Happy stamping, we\'re excited to see what you make! \n    \n    - Maayan & Cam\n    \n*/',args:" ",x:702.0843016558624,y:526.3886604608753,editorWidth:224.2321933879481,editorHeight:627.8573293703668,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:632,isBlob:!0,codeSize:14},{name:"",code:"var xPos = 0\nvar maxSize = 20",args:" ",x:1025.2197591789836,y:526.1831709984822,editorWidth:120.72506930849877,editorHeight:174.63795191901036,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:627,isBlob:!0,codeSize:14},{name:"setup",code:"createCanvas(200, 200)\nbackground(175, 112, 248)\nnoStroke()",args:"",x:1216.6046212636682,y:526.1050713082992,editorWidth:187.33684948280245,editorHeight:75.20212084900183,iframeWidth:47.18718026609529,iframeHeight:84.26214854159208,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:630,isBlob:!1,codeSize:14},{name:"sizeDot",code:"// generate a random size\nvar size = random(0, maxSize)\n\n// set the opacity\nvar opacity = map(size, \n    0, maxSize, \n    0, 255)\n\n// draw a dot   \nfill(255, opacity);\nellipse(x,y,size, size);\n\n",args:"x=mouseX, y=mouseY",x:1025.1123055679532,y:789.7862113698332,editorWidth:225,editorHeight:175,iframeWidth:200.4613444482518,iframeHeight:199.7524142951453,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:579,isBlob:!1,codeSize:14},{name:"draw",code:"// update xPos and background\nbackground(175, 112, 248, 10)\nxPos = (xPos +2) % width\n\n// draw a row of dots\nfor(var i = 0; \n    i < height/maxSize; \n    i++){\n      sizeDot(xPos, i*maxSize )\n}\n",args:"",x:1025.3740565788173,y:1153.6991713934658,editorWidth:225,editorHeight:175,iframeWidth:200,iframeHeight:200,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:580,isBlob:!1,codeSize:14}],scale:.7838764402270318,console:{x:700.0778726617857,y:1240.2239882058916,consoleWidth:244.781440843727,consoleHeight:199.19044002384612,hidden:!0,zIndex:-1},originX:-257.2010372715673,originY:-311.9703251082989,worldKey:"starter",compressedJs:"\u0517\u4a88\u0a48\u5414\u2102\u3514\u1414\u2020\u1010\u15d9\u2d8c\u36f6\u6b29\u01d1\u5e40\u5374\u30b6\u5c19\u2e44\u1c51\u4630\u75a1\u42e8\u2079\u37ba\u481a\u0c2e\u6652\u0313\u1599\u5ee4\u65c5\u0834\u5cc8\u0c24\u0703\u2973\u29cc\u40e6\u6b65\u3a31\u5a08\u0ccd\u7726\u6b0b\u51d1\u4ac8\u2069\u3710\u185c\u4e8c\u26f6\u0b93\u10b5\u58d2\u6b65\u1034\u5d19\u2dae\u3206\u1b0b\u31b1\u4ac9\u4665\u3997\u3198\u18a0\u5596\u7ba9\u018d\u42dc\u2074\u3434\u5b9a\u640d\u7662\u03a3\u2195\u66ca\u2062\u34b3\u71cb\u240e\u4697\u2621\u6c89\u66ca\u7475\u3811\u0b08\u044c\u4726\u0bb9\u08b0\u40c2\u6ec4\u0ab4\u5e99\u288d\u7742\u1103\u05cc\u40cc\u756e\u31ba\u1a5b\u6dce\u32e2\u02a3\u2195\u738a\u57c4\u3c10\u1bdb\u4ca4\u0616\u737b\u51a1\u4ae5\u4536\u3ab9\u5948\u0ced\u46f6\u130b\u3081\u6cc2\u7269\u30b1\u1b19\u2e65\u6f20\u049b\u05b1\u66de\u2069\u36b8\u1bdc\u4e84\u0666\u4b66\u1111\u4840\u6d65\u3234\u587a\x13\u369e\u2005\u6194\u40c4\u6172\u1030\u589b\u6ed8\u622c\u22f6\u1059\u46de\u6e73\u37b6\u1971\u459c\u4016\u1323\u1589\u6acf\u6401\u20b9\u0818\u6dec\u465c\u5b92\u05b9\u73c8\u0100\u33e2\u1479\u602b\u0686\u7bab\u3190\u40ee\u6f72\u35e2\u0571\u288c\u5722\u7748\u0271\u6ae0\u6c6f\u30b2\u0819\u2f0d\u1737\u2621\u65c0\u6bce\u018b\u32b9\u7ac0\u39a4\u06f7\u1103\u11bd\u6edd\u452c\u3a34\u1a5c\u640a\u3c52\u2f28\u02a1\u5ee0\u656e\u1034\u5d08\u0eae\u0207\u1b7b\u3595\u6ed0\u6572\u3290\u195b\u0e6c\u5ec0\u0cfa\u2185\u60e0\u7920\u39e2\u13da\u2dcc\u72c2\u03bb\u149f\u084c\u7863\u34f2{\u2e8d\u7207\u1b2b\u1481\u6fd0\u0229\u36b0\u5ad9\u2439\u33e2\u6902\u3585\u42f2\u616e\u1013\u0810\u6c2d\u5c61\u4151\u3c28\u1414\u0a76\u30b9\u081e\u0a0d\u7732\u01e9\xc3\u0a1a\u6d61\u3c29\u5a5e\u4ca4\u03d2\u0191\u4028\u1415\u6801\u6610\u3940\u3ec5\u0297\u5851\x81\u46e4\u6561\u3a32\u50d8\u2dce\u6617\u1941\u48c0\u6058\u2032\u1818\u0a42\u4404\u0626\u0b1b\u2d9d\u64de\u756e\u3214\u0c4d\u66a5\u4203\u0989\u48b0\u4064\u3438\u620e\u1b9b\u6a6e\u4726\u7b5b\u14a0\u5214\u7dcc\u2bf3\x8e\u050f\u03d6\u6b7b\u55cd\u4ab0\u2c20\u3ce3\u0296\u38ad\u32f2\u7903\u1d95\u5cca\u7261\u3a32\u4818\u240e\u2616\u7323\u3db7\u0a68\u0a20\u7201\u0cf1\u2164\u03dc\u38c9\u20c0\u59d0\xbf\u6239\u318f\u6e6c\u574e\u2810\u19bd\u60c2\u6369\u3a3c\u71ce\u18e1\u6203\u6903\u3585\u6051\u4446\u1662\u0c319\u245c\u6099\u48d4\u6b94\u54e4\u017c\u4818\u240c\u46f7\u2730\u0585\u4cd2\u6c6c\u1419\u0d4d\u2599\u0582\u49d8\u2880\u40ca\u6c6c\u34b8\u1cd9\u250f\u02c7\u4966\u198b\u080d\u451b\u6201\u7b00\u20d8\u451e\u300a\u70bc\u5e40\u7570\u3272;\u7ca0\u196e\u2011\u03a8\u02ad\u7b01\u3196\u080c\u3ca0\u183c\u29b1\u7480\u518a\u082b\u1914\u4809\u240e\u7696\u23a3\u23c0\u0178\u726f\u3bf2\xf9\u2c8d\u7747\u1f20\u0305\u5ee4\u28e4\x8b\u5a79@\u73be\u4007\u5da4\u4078\u2068\u32b4\u59da\u0e85\u7e70\u0896\u286c\u5657\u6500\u57e3z\u2038\u5506\u7b99\u3081\u5255\u472e\u1072$\u2fb8\u47a7\u6850\u8002\u8001"}},{name:"empty",data:{stamps:[{name:"style.css",code:"\nhtml, body {\n  margin: 0;\n  padding: 0;\n}",args:" ",x:268.53419986245996,y:177.7984650004281,editorWidth:225,editorHeight:175,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!0,isMediaFile:!1,hidden:!0,exported:!0,zIndex:642,isBlob:!1,codeSize:14},{name:"index.html",code:'<html>\n  <head>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/p5.min.js"><\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.dom.min.js"><\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.sound.min.js"><\/script>\n    <link rel="stylesheet" type="text/css" href="style.css">\n  </head>\n  <body>\n    <script src=\'sketch.js\'><\/script>\n  </body>\n</html>\n',args:" ",x:309.13872819066705,y:148.12237211435783,editorWidth:225,editorHeight:175,iframeWidth:200,iframeHeight:200,isIndex:!0,isTxtFile:!1,isMediaFile:!1,hidden:!0,exported:!0,zIndex:641,isBlob:!1,codeSize:14}],scale:1,console:{x:303.0271580940204,y:206.71662152101146,consoleWidth:225,consoleHeight:200,hidden:!0,zIndex:640},originX:0,originY:0,worldKey:"empty",compressedJs:""}},{name:"particles",data:{stamps:[{name:"style.css",code:"\nhtml, body {\n  margin: 0;\n  padding: 0;\n}",args:" ",x:2487.723154997192,y:454.1828386163433,editorWidth:155.2851590781397,editorHeight:108.88644457518404,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!0,isMediaFile:!1,hidden:!0,exported:!0,zIndex:-1,isBlob:!1,codeSize:14},{name:"index.html",code:'<html>\n  <head>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/p5.min.js"><\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.dom.min.js"><\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.sound.min.js"><\/script>\n    <link rel="stylesheet" type="text/css" href="style.css">\n  </head>\n  <body>\n    <script src=\'sketch.js\'><\/script>\n  </body>\n</html>\n',args:" ",x:2926.0613195853425,y:460.660255253893,editorWidth:331.9915568373324,editorHeight:267.30348833629085,iframeWidth:225,iframeHeight:200,isIndex:!0,isTxtFile:!1,isMediaFile:!1,hidden:!0,exported:!0,zIndex:-1,isBlob:!1,codeSize:14},{name:"setup",code:"// nothing much to see here\ncreateCanvas(300,300) // this won't alter the window size\nbackground(backgroundFade)\nnoStroke()",args:"",x:1922.4727804881593,y:-28.839556505847952,editorWidth:300,editorHeight:95.77622017221594,iframeWidth:229.2823664771775,iframeHeight:125.05858664939339,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!0,exported:!0,zIndex:-1,isBlob:!1,codeSize:14},{name:"basicDot",code:"fill(255);\nellipse(x, y, 10, 10)",args:"x=mouseX, y=mouseY",x:-59.00091994708015,y:619.609814794894,editorWidth:181.2419711791158,editorHeight:111.52588114745845,iframeWidth:134.907702273812,iframeHeight:130.38322448430927,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:101,isBlob:!1,codeSize:14},{name:"speedColorDot",code:"if(!speed){\n  speed = random(0, .01)\n}\n\n// set the opacity and color based on the speed the dots are moving\nvar opacity = max(100, speed *100 * 255)\nvar colorOff = speed *100\nfill(150 - colorOff*40, 100+ colorOff*80, 255, opacity);\nellipse(x,y,5, 5);\n",args:"x = mouseX, y=mouseY",x:329.9599253794122,y:976.0473944121347,editorWidth:296.7340422149467,editorHeight:176.59932474664424,iframeWidth:169.71609003165736,iframeHeight:195.90489555790055,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:102,isBlob:!1,codeSize:14},{name:"getPosition",code:"\n if(angle === 0){\n  lastFaderX = faderX\n  faderX = faderX*.97 + .03* mouseX / width;\n  speed = abs(faderX - lastFaderX)\n  randomSeed(actRandomSeed); \n }\n var randomX = random(0,width);\n  var randomY = random(0,height);\n  var circleX = width / 2 + cos(angle) * 100;\n  var circleY = height / 2 + sin(angle) * 100;\n  var x = lerp(randomX,circleX,faderX);\n  var y = lerp(randomY,circleY,faderX);\n  if(mouseIsPressed){\n     background(backgroundFade, 10)\n  var angle = map(mouseX, 0, width, 0,7)\n  var circleX = width / 2 + cos(angle) * 100;\n  var circleY = height / 2 + sin(angle) * 100;\n  basicDot(circleX, circleY) \n  }\n\n  \n  return {x:x, y:y}\n  ",args:"angle",x:1307.5816569518977,y:677.5063472275517,editorWidth:379.21463817319534,editorHeight:376.8484971084752,iframeWidth:289.3981629416132,iframeHeight:292.2735384641079,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:103,isBlob:!1,codeSize:14},{name:"drawFadedParticles",code:"background(backgroundFade, 20);\n\nfor (var i = 0; i < count; i++) {\n  var angle = i*360/count\n  \n  // mix and match dot functions here!\n  pos = getPosition(angle)\n  basicDot(pos.x, pos.y)\n}",args:"",x:655.2944910006604,y:-49.9258150353464,editorWidth:309.7943589626219,editorHeight:146.47663811577075,iframeWidth:297.3456070084918,iframeHeight:298.4895813984271,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:104,isBlob:!1,codeSize:14},{name:"speedDot",code:"\nif(!speed){\n  speed = random(0, .01)\n}\n\n// set the opacity based on the speed the dots are moving\nvar opacity = max(100, speed *100 * 255)\nfill(150, 100, 255,opacity);\nellipse(x,y,10, 10);\n\n",args:"x = mouseX, y=mouseY",x:-159.95756973196586,y:906.1192916260952,editorWidth:308.7544796011597,editorHeight:185.16405770099925,iframeWidth:116.75259491582909,iframeHeight:204.18278884948927,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:105,isBlob:!1,codeSize:14},{name:"sizeDot",code:"// generate a random size\nnoStroke()\nvar size = random(0, 10)\n\n// use it to draw the dot\nfill(86,186,255, size*.1 *255);\nellipse(x,y,size, size);",args:"x = mouseX, y=mouseY",x:327.8196574329079,y:620.3268102451857,editorWidth:199.66994116856335,editorHeight:179.9979040763115,iframeWidth:91.90910563176772,iframeHeight:206.14265666314918,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:106,isBlob:!1,codeSize:14},{name:"drawParticles",code:"\nbackground(40);\n\nfor (var i = 0; i < count; i++) {\n  var angle = i*360/count\n  pos = getPosition(angle)\n  \n  // mix and match dot functions here!\n  sizeDot(pos.x, pos.y)\n  speedColorDot(pos.x, pos.y)\n}",args:"",x:-6.737551201596916,y:-46.19936428968789,editorWidth:300,editorHeight:193.4799063003186,iframeWidth:308.1860599190181,iframeHeight:294.830608250465,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:133,isBlob:!1,codeSize:14},{name:"",code:"// the particle pattern",args:" ",x:-101.36309304052276,y:-164.3449970916704,editorWidth:561.388125203422,editorHeight:39.624291076671355,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:123,isBlob:!0,codeSize:28},{name:"",code:"// different types of dots, mouse over the canvases to see them",args:" ",x:-389.8061630364864,y:495.0560125150731,editorWidth:959.3106635538155,editorHeight:49.88002660116602,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:124,isBlob:!0,codeSize:28},{name:"",code:"// a helper function to get the particle pattern, mouse over the canvas while pressing your mouse down to visualize what it does",args:" ",x:967.2439576737161,y:522.8690319916844,editorWidth:955.2083693440158,editorHeight:62.18690923055951,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!1,exported:!0,zIndex:125,isBlob:!0,codeSize:28},{name:"",code:"// globals\n\nvar actRandomSeed = 0;\nvar count = 300;\nvar faderX = 0\nvar backgroundFade = 40\nvar lastFaderX\nvar speed\nvar angleUnit = (360 / count);",args:" ",x:1662.564205981018,y:-101.65610389740152,editorWidth:190.13049921671842,editorHeight:183.20458841959572,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!0,exported:!0,zIndex:-1,isBlob:!0,codeSize:14},{name:"",code:"// setup stuff",args:" ",x:1929.8952193556572,y:-153.45214631512889,editorWidth:341.91538497923824,editorHeight:35.52199686687362,iframeWidth:0,iframeHeight:0,isIndex:!1,isTxtFile:!1,isMediaFile:!1,hidden:!0,exported:!0,zIndex:-1,isBlob:!0,codeSize:28}],scale:.40940849184989847,console:{x:2406.431838044327,y:726.7041236433164,consoleWidth:398.5547609288658,consoleHeight:312.41625580738497,hidden:!0,zIndex:-1},originX:450.0090809071319,originY:189.64858810122308,worldKey:"particles",compressedJs:'\u333a\u5b98\u6e8d\u16f6\u7103\u4d95\u68ea\u7028\u14bd\u4288\u0405\u72f2\u0373\u3dd1\u50d2\u6e67\u1036\u5d58\u6d04\u0746\u7903\u4d95\u4a40\u6865\u3932\u4288\u040c\u3726\u2b0b\u5195\u06c2\u6e76\u30b9\u4a0c\u6606\u02c3\u1981\u40a7\u0868\u7468\u34b9\u481d\u6ded\u6277\u2103\u05b1\u68ca\u7220\u3a34\u1948\u0eed\u16e6\u237b\u5c81\u66d2\u7ac4\u1e31\u1858\u6d6c\u7726\u7bab\u3990\u5194\u0b46\u30b2\u194a\u2144\u0206\u737a\u4dd1\u64de\u6b65\u1414\u429f\u2141\u2e90\u04cb\u0985\u66d2\u6344\u37ba\u0a1e\u07ad\u56f7\u2b9b\u1560\u5840\u79c6\u052c\u7940\u15cc\u6696\u6361\u20c8\u6a6a\u293b\u0510\u0819\u2d8d\u4697\u039b\u14a1\u7058\u2079\u1610\u0c4c\u1880\u4ce4\u7b9b\u4195\u4ac8\u436f\u3637\u5cb1\u2a84\u03d2\u06aa\u59a5\u4c50\u21c5\u15e2\u4388\u18c6\u7203\u6903\u4985\u5cc8\u6f6d\u1418\u0b08\u05c6\u031e\u2005\u59f4\u1440\u20e6\x9a\u1cd9\u2e9c\u500f\u1b7b\u4185\u46d2\u7479\u1030\u5b99\u040c\u3c46\u4f20\u030d\u4ac8\u206f\u3762\u47f1\u4958\u40a6\u237b\u51cc\u40c2\u7265\u1036\u5bdd\u4d2d\u6670\u5101\u01d9\u42e5\u493f\u1e90\u1b58\u2f05\u0313\u0181\u331c\u6654\u3130\u1810\u0a88\u1c80\u0ebc\u395e\u1579\u1ecc\u6620\u1ee5\u48fa"\u3313\u2981\xb7\u1246\u2a34\u7280\u430c\u0579\u2123\u4181\u3311\u1a59\u4872\u7780\u505e\u2586\u52c2\u0730\u055b\u5a02\u4167\u32ba\u141b\u6e6d\u1c40\u6143\u05b9\u4ed8\u65e5\x91\u3900\u24ad\u166c\u3089\xf4\u7a7a\u2030\u628b\u4808\u0d8c\u1737\u2720\u0789\u64b0\u203d\u1033\u3142\u38a3\u0c60\u5e48\u50a8\u5c72\u3720\u1590\u0b8c\u0665\u2e70\u0c89\xbc\u40ee\u6964\u3a34\u3900\u103d\u2018\u030b\u09cc\u518e\u3b2d\u65ae\u3900\u2244\u0e70\u0cea\u4d95\u4ac8\u2861\u31ba\u14b2\u21c5\u13be\u2805\u0390\u0357\u6501\u1c63\u0a31\u0fb8\u60a2\u4181\u3315\u57ca\xed\u6611\u5673\u046d\u0656\u4b3b\u21d3\u1648\u6369\u3931\u5b19\u3888\u7c53\u7101\u3c80\u6441\u6401\u3039\u79c0\u2304\u02ae\u200b\u4b40\u6188\u54c6\u25e3\u4c5c\u6d3d\x14\u4e81\u4790\u053c\u6c65\u3938\u0a39\u6016\u12cc\u3b91\u3398\u0205\u6b00\u45f2\x8b\u7965\u259c\u3952\u6738\u54d2\u6628\u7280\u5712\u2e6a\u0726\u2b9b\u4fa4\u05ba\u20fb\u01cd\u3980\u6859\u068e\u380f\x81\u5ac2\u70c6\u25ac\u0b08\u0605\u4e60\u0806\u1028\u6f94\u2bff\x8f\u3fc0\u23df\u7011\u7748\u1057\u0ecc\u2cc8\u1f94\u7940\u3d5d9\u3638\u15c9\u4ae8\u7572\u3710\u1ede\u075c\u4041\u41d3\u6710\u3dde\u02d6\u3239\u185d\u7c80\u0ef6\u2283\u05c9\u68d2\u636c\u32b9\u7981\u219f\u3011\u4191\u4398\u063a\u2020\u3337\u5c88\u051c\u400c\u2349\xf4\u4060\u3b20\u3490\u0f08\u0c6d\u7756\u73a1\u6c81\u5256\u2b29\u1062\u127b\u4028\u0692\u5199\u58c0\u5f8a\u24eaS\u4bcb\u640d\u5697\u4728\u10e1\u5ac2\u7463\u3472\u0108\u241d\n\u139f\u1416C\u4529\u3837\u5cc8\u07be\u3038\u4f70\u046d\u60de\u732e\u3c16\u310b\u25cf\u1c41\u5bef\u4814\u11fa\u0503\u7f82\u41bf\u60a0\u6e80\u263f\u7c13\u79fe\u04fc\u7b02\u3f3a\x9c\u0e50\u2697\u1813\u0bf0\u04c4\u7383\xf9\u6035\u1ee0\u0813\u25e9\u4bfa\u0101\u1797\u4819\u6cad\u6657\u130b\u5194\u40c3\u6700\u7a74\u01b2\u5d60\u6ade\u3005\u6f10\u31da\u011a\u7301\u4df1\u48ee\u5736\u2903\u25d3\u480e\u49e4\u0134\u3a00\u203d\f\u51c1\u58b0\u6270\u362c\u7282\u6331\u08e5\u22e3\u0901\u2bc8\u0da4\u792c\u620e\u7188\u6527\u3f10\u15f7\u3c0a\u73dc\u02bc\u1a7f\u40ab\u1fe0\u2ace\u6815\u33f4\u04fd\u7f02\u64f7\u40b2\u3d00\u183f\x15\u2f9c\u04d5\u6907\u53e8\u0839\u2059\u30ae\u2843\u5194\u40e1\u6700\u7c90\u1c18\u2e8e\u4657\u1370\u2b18\u36c8\u6966\u3332\u5c99\u2dce\u4207\u23cb\u4195\u6640\u6f66\u7281\u1d4b\u1cc0\u1ec2\u037b\u5b9c\u1144\u63e5\u0465\u195c\u7d01\u0e77\u2343\u15b7\u0e86\u6120\u3432\u5b1c\u0cae\u2e90\u05e6\u1091\u4fce\u02e1\u683b\u75d6\u240e\u7686\u4e21\u1790\u0ae3\u6409\u293c\u5bdd\u2e58\u72a6\u237b\u5f15\u24ec\u6973\u3ab0\u5b39H\u0776\u430b\u5390\u0452\u646f\u32b9\u79c0\u108c\u76c6\u7b13\u05b1\u6614\u0ae5\xc9\u7b01\u5adc\u501c\u0628\u5f94\u0338\u203d\u1019\u7901\u23f8\u411e\u483a\u74c3\u0a1f\u6e04\u5d10\u0f48\u0698\u618e\u503a\u0314\u1fca\u0174\u6334\u3900\u3a2a\u56e6\u4e22\u54a0\u666c\u3020\u17e3\u190a\u277c\u7009\u3728\u28b8\u40e6\u7475\u3333\u0282\u4000\u8000'}}]},2:function(e,t,i){"use strict";i.d(t,"a",(function(){return re})),i.d(t,"b",(function(){return le}));var n=i(422),a=i.n(n),s=i(423),o=i.n(s),r=i(424),l=i.n(r),d=i(156),c=i.n(d),h=i(157),p=i.n(h),u=i(425),m=i.n(u),g=i(158),f=i.n(g),v=i(159),b=i.n(v),y=i(160),x=i.n(y),w=i(88),k=i.n(w),S=i(426),M=i.n(S),O=i(427),I=i.n(O),E=i(428),C=i.n(E),D=i(429),z=i.n(D),j=i(430),L=i.n(j),T=i(437),W=i.n(T),F=i(431),H=i.n(F),R=i(161),_=i.n(R),P=i(162),A=i.n(P),B=i(163),N=i.n(B),X=i(164),Y=i.n(X),q=i(165),K=i.n(q),U=i(166),G=i.n(U),Z=i(167),V=i.n(Z),J=i(432),Q=i.n(J),$=i(433),ee=i.n($),te=i(434),ie=i.n(te),ne=i(435),ae=i.n(ne),se=i(436),oe=i.n(se),re={SettingOnIcon:Q.a,SettingOffIcon:ee.a,ExpandLessIcon:H.a,EmptyIcon:oe.a,GridIcon:a.a,LinesIcon:o.a,ConsoleStampIcon:l.a,FunctionStampIcon:c.a,FileStampIcon:p.a,HtmlStampIcon:m.a,BuiltInStampIcon:f.a,ListenerStampIcon:b.a,ImageStampIcon:x.a,BlobStampIcon:k.a,MediaAssetIcon:M.a,DeleteStampIcon:I.a,CopyIcon:C.a,ClearConsoleIcon:z.a,ExpandMoreIcon:_.a,DownloadIcon:A.a,UploadIcon:N.a,WorldsIcon:Y.a,GlobalVarIcon:k.a,CommentIcon:K.a,InfoIcon:G.a,PermanentWorldIcon:V.a,CodeSizeIcon:L.a,MinimzeIcon:W.a,VisibilityIcon:ie.a,VisibilityOffIcon:ae.a,defaultEditorWidth:225,defaultVarEditorHeight:200,defaultEditorHeight:200,defaultIframeWidth:200,iframeMargin:0,headerHeight:30,brHeight:25,codeSize:14,buttonTextSize:12,bigCodeSize:28,fnTitleHeight:100,copyOffset:35,iconOpacity:.5,iconSize:15,iconTransition:"all .3s ease",borderTransition:"border .3s ease-out",autoLayoutMargin:20,listeners:{windowResized:!1,deviceMoved:!1,deviceTurned:!1,deviceShaken:!1,keyPressed:!1,keyReleased:!1,keyTyped:!1,mouseMoved:!1,mouseDragged:!1,mousePressed:!1,mouseReleased:!1,mouseClicked:!1,doubleClicked:!1,mouseWheel:!1},builtIns:{draw:!0,preload:!0,setup:!0},specialFns:{draw:!0,preload:!0,setup:!0,windowResized:!1,deviceMoved:!1,deviceTurned:!1,deviceShaken:!1,keyPressed:!1,keyReleased:!1,keyTyped:!1,mouseMoved:!1,mouseDragged:!1,mousePressed:!1,mouseReleased:!1,mouseClicked:!1,doubleClicked:!1,mouseWheel:!1},fnStampWidth:557,fnStampHeight:318},le=["abs()","acos()","alpha(color)","ambient(color)","ambientLight(r,g,b)","append(array,value)","applyMatrix(n00,n01,n02,n03,n10,n11,n12,n13,n20,n21,n22,n23,n30,n31,n32,n33)","arc(x,y,width,start,stop)","arrayCopy(src,dst,(length))","asin()","atan()","atan2()","background(color)","beginCamera()","beginContour()","beginRaw(renderer,filename)","beginRecord(renderer,filename)","beginShape()","bezier(x1,y1,x2,y2,x3,y3,x4,y4)","bezierDetail(detail)","bezierPoint(a,b,c,d,t)","bezierTangent(a,b,c,d,t)","bezierVertex(x2,y2,x3,y3,x4,y4)","binary(value,(digits))","blend(sx,sy,sw,sh,dx,dy,dw,dh,mode)","blendMode(mode)","blue(color)","boolean(value)","box(size)","brightness(color)","byte(value)","camera(eyeX,eyeY,eyeZ,centerX,centerY,centerZ,upX,upY,upZ)","ceil()","char(value)","clear()","color(color)","colorMode(mode)","concat(a,b)","constrain()","copy(sx,sy,sw,sh,dx,dy,dw,dh)","cos()","createFont(name,size)","createGraphics(w,h)","createImage(w,h,format)","createInput(filename)","createOutput(filename)","createReader(filename)","createShape(kind,parameters)","createWriter(filename)","cursor(img)","curve(x1,y1,x2,y2,x3,y3,x4,y4)","curveDetail(detail)","curvePoint(a,b,c,d,t)","curveTangent(a,b,c,d,t)","curveTightness(tightness)","curveVertex(x,y)","day()","degrees()","directionalLight(r,g,b,nx,ny,nz)","displayDensity()","dist()","ellipse(x,y,width,height)","ellipseMode(mode)","emissive(color)","endCamera()","endContour()","endRaw()","endRecord()","endShape()","exp()","expand(list,(newSize))","fill(color)","filter(shader)","float(value)","floor()","frameRate(fps)","frustum(left,right,bottom,top,near,far)","fullScreen(renderer)","get(x,y)","green(color)","hex(value,(digits))","hour()","hue(color)","image(image,x,y)","imageMode(mode)","int(value)","join(list,seperator)","launch(args)","lerp()","lerpColor(color1,color2,amount)","lightFalloff(constant,linear,quadratic)","lights()","lightSpecular(r,g,b)","line(x1,y1,x2,y2)","loadBytes(filename)","loadFont(filename)","loadImage(filename)","loadPixels()","loadShader(fragFilename,(vertFilename))","loadShape(filename)","loadStrings(filename)","loadTable(filename,(options))","loadXML(filename)","log()","mag()","map()","match(string,regexp)","matchAll(string,regexp)","max()","millis()","min()","minute()","modelX(x,y,z)","modelY(x,y,z)","modelZ(x,y,z)","month()","nf(num,digits)","nfc(num,(right))","nfp(num,(digits))","nfs(num,digits)","noCursor()","noCursor()","noFill()","noise()","noiseDetail()","noiseSeed()","noLights()","norm()","normal(nx,ny,nz)","noSmooth()","noStroke()","noTint()","ortho(left,right,bottom,top)","parseXML(string,(options))","perspective(fovy,aspect,zNear,zFar)","pixelDensity(density)","point(x,y)","pointLight(r,g,b,x,y,z)","popMatrix()","pow()","print(variables)","printArray(array)","printCamera()","println(variables)","printMatrix()","printProjection()","pushMatrix()","quad(x,y,x2,y2,x3,y3,x4,y4)","quadraticVertex(x,y,x2,y2)","radians()","random()","randomGaussian()","randomSeed()","rect(x,y,width,height)","rectMode(mode)","red(color)","requestImage(filename)","resetMatrix()","resetShader()","reverse(list)","rotate(angle)","rotateX(angle)","rotateY(angle)","rotateZ(angle)","round()","saturation(color)","save(filename)","saveBytes(filename,data)","saveFrame(filename####)","saveStream(target,source)","saveStrings(filename,data)","saveTable(table,filename,(options))","saveXML(xml,filename,(options))","scale(s)","screenX(x,y)","screenY(x,y)","screenZ(x,y)","second()","selectFolder(prompt,callback)","selectInput(prompt,callback)","selectOutput(prompt,callback)","set(x,y,color)","shader(shader)","shape(shape,x,y)","shapeMode(mode)","shearX(angle)","shearY(angle)","shininess(shine)","shorten(list)","sin()","size(width,height,renderer)","smooth()","sort(list,(count))","specular(color)","sphere(radius)","sphereDetail(res)","splice(list,value,index)","split(value,digits)","splitTokes(value,(delim))","spotLight(r,g,b,x,y,z,nx,ny,nz,angle,concentration)","sq()","sqrt()","string(value)","stroke(color)","strokeCap(cap)","strokeJoin(join)","strokeWeight(weight)","subset(list,start,(count))","tan()","text(string,x,y)","textAlign(alignX,(alignY))","textAscent()","textDescent()","textFont(font,(size))","textLeading(leading)","textMode(mode)","textSize(size)","texture(image)","textureMode(mode)","textureWrap(wrap)","textWidth(string)","tint(color)","translate(x,y)","triangle(x1,y1,x2,y2,x3,y3)","trim(string)","unbinary(value)","unhex(value)","updatePixels()","vertex(x,y)","year()","HALF_PI","PI","QUARTER_PI","TAU","TWO_PI","frameCount","deltaTime","focused","displayWidth","displayHeight","windowWidth","windowHeight","width","height","disableFriendlyErrors","p5.Element","VIDEO","AUDIO","p5.MediaElement","p5.File","p5.Graphics","p5.TypedDict","p5.NumberDict","deviceOrientation","accelerationX","accelerationY","accelerationZ","pAccelerationX","pAccelerationY","pAccelerationZ","rotationX","rotationY","rotationZ","pRotationX","pRotationY","pRotationZ","turnAxis","keyIsPressed","key","keyCode","movedX","movedY","mouseX","mouseY","pmouseX","pmouseY","winMouseX","winMouseY","pwinMouseX","pwinMouseY","mouseButton","mouseIsPressed","DEGREES","RADIANS","CORNER","CORNERS","CENTER","RADIUS","exitPointerLock()","angleMode(mode)","touches","touchStarted(fxn)","touchMoved(fxn)","touchEnded(fxn)","saveCanvas(selectedCanvas, [filename], [extension])","saveCanvas([filename], [extension])","saveFrames(filename, extension, duration, framerate, [callback])","pixels","loadJSON(path, [jsonpOptions], [datatype], [callback], [errorCallback])","loadJSON(path, datatype, [callback], [errorCallback])","loadJSON(path, callback, [errorCallback])","httpGet(path, [datatype], [data], [callback], [errorCallback])","httpGet(path, data, [callback], [errorCallback])","httpGet(path, callback, [errorCallback])","httpPost(path, [datatype], [data], [callback], [errorCallback])","httpPost(path, data, [callback], [errorCallback])","httpPost(path, callback, [errorCallback])","httpDo(path, [method], [datatype], [data], [callback], [errorCallback])","httpDo(path, options, [callback], [errorCallback])","saveJSON(json, filename, [optimize])","createVector([x], [y], [z])","textStyle(theStyle)","orbitControl([sensitivityX], [sensitivityY], [sensitivityZ])","debugMode()","debugMode(mode)","debugMode(mode, [gridSize], [gridDivisions], [xOff], [yOff], [zOff])","debugMode(mode, [axesSize], [xOff], [yOff], [zOff])","debugMode([gridSize], [gridDivisions], [gridXOff], [gridYOff], [gridZOff], [axesSize], [axesXOff], [axesYOff], [axesZOff])","noDebugMode()","specularColor(v1, v2, v3)","specularColor(value)","specularColor(gray)","specularColor(values)","specularColor(color)","createShader(vertSrc, fragSrc)","normalMaterial()","ambientMaterial(v1, [v2], [v3], [a])","ambientMaterial(color)","emissiveMaterial(v1, [v2], [v3], [a])","emissiveMaterial(color)","specularMaterial(v1, [v2], [v3], [a])","specularMaterial(color)","createCamera()","setCamera(cam)"]},297:function(e,t,i){e.exports=i.p+"static/media/code.d7ef8adb.svg"},422:function(e,t,i){e.exports=i.p+"static/media/grid.0ed55763.svg"},423:function(e,t,i){e.exports=i.p+"static/media/git-commit.00746f95.svg"},424:function(e,t,i){e.exports=i.p+"static/media/message-circle.ebbe6d9a.svg"},425:function(e,t,i){e.exports=i.p+"static/media/layout.8a437d55.svg"},426:function(e,t,i){e.exports=i.p+"static/media/layers-light.76db5efc.svg"},427:function(e,t,i){e.exports=i.p+"static/media/trash.e6887622.svg"},428:function(e,t,i){e.exports=i.p+"static/media/copy.745449c2.svg"},429:function(e,t,i){e.exports=i.p+"static/media/rotate-ccw.7260812b.svg"},430:function(e,t,i){e.exports=i.p+"static/media/type.3950b751.svg"},431:function(e,t,i){e.exports=i.p+"static/media/chevron-up.90f47098.svg"},432:function(e,t,i){e.exports=i.p+"static/media/check-square.75b12164.svg"},433:function(e,t,i){e.exports=i.p+"static/media/square.e3aa28b6.svg"},434:function(e,t,i){e.exports=i.p+"static/media/eye.62517b9b.svg"},435:function(e,t,i){e.exports=i.p+"static/media/eye-off.c68b9e9b.svg"},436:function(e,t,i){e.exports=i.p+"static/media/empty.43d9eb10.svg"},442:function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return E}));var n=i(14),a=i(15),s=i(17),o=i(16),r=i(12),l=i(18),d=(i(117),i(7),i(0)),c=i.n(d),h=i(168),p=i(69),u=i.n(p),m=i(111),g=i.n(m),f=i(247),v=i.n(f),b=i(20),y=i(93),x=i(443),w=(i(156),i(158),i(159),i(297),i(161),i(162),i(163),i(164),i(88),i(165),i(157),i(160),i(166),i(167),i(19)),k=i(298),S=i(308).detect,M=(i(309),S()),O=i(180);if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)var I=window.require("electron").ipcRenderer;else I=!1;var E=function(t){function i(e){var t;return Object(n.a)(this,i),(t=Object(s.a)(this,Object(o.a)(i).call(this,e))).state={modalButtons:[],modalVisible:!I&&M&&"chrome"!=M.name,modalHeader:"Use Chrome please!",modalContent:"Right now, the web version of Stamper is only supported in Google Chrome.",saveInterval:null,cdnLibs:!1,askedAboutCdn:!1,inputElem:null,miniInputElem:null,publishInfoVisible:!1,onlineWorldDict:null,lastWorldCheck:-1,publishModal:null},t.protectAgainstClosed=t.protectAgainstClosed.bind(Object(r.a)(t)),t.receiveMessage=t.receiveMessage.bind(Object(r.a)(t)),t.domain="https://p5stamper.com",t.oauthToken="65c5d1e11f91a9e1e565f0c2ca8248e9fc1d587c",t.githubUsername="p5stamper",t.receiveFiles=t.receiveFiles.bind(Object(r.a)(t)),t.hideModal=t.hideModal.bind(Object(r.a)(t)),t.hidePublishInfoModal=t.hidePublishInfoModal.bind(Object(r.a)(t)),t.sendSaveData=t.sendSaveData.bind(Object(r.a)(t)),t.libs={"p5.js":"https://cdn.jsdelivr.net/npm/p5","p5.min.js":"https://cdn.jsdelivr.net/npm/p5","p5.dom.js":"https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.dom.js","p5.dom.min.js":"https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.dom.min.js","p5.sound.js":"p5.sound.jshttps://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.sound.js","p5.sound.min.js":"https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/addons/p5.sound.min.js","p5.accessibility.js":"https://cdn.jsdelivr.net/gh/processing/p5.accessibility@0.2.0/dist/p5.accessibility.js","p5.accessibility.min.js":"https://cdn.jsdelivr.net/gh/processing/p5.accessibility@0.2.0/dist/p5.accessibility.js"},t}return Object(l.a)(i,t),Object(a.a)(i,[{key:"getUrlWorldKey",value:function(){var e=window.location.search;return new URLSearchParams(e).get("e")}},{key:"loadInitialStamperObject",value:function(){var e=this;if(I)this.props.loadStamperObject(w.f);else{var t=this.getUrlWorldKey();if(t)try{return void this.getWorldObject(t,!0,(function(t){t?e.props.loadStamperObject(t):e.loadStoredStamperObject()}))}catch(i){return void this.loadStoredStamperObject()}this.loadStoredStamperObject()}}},{key:"loadStoredStamperObject",value:function(){var e=localStorage.getItem("storedStamper");if(null!==e)try{var t=JSON.parse(g.a.decompress(e,{inputEncoding:"StorageBinaryString"}));return void this.props.loadStamperObject(t)}catch(i){return void this.props.loadStamperObject(w.f)}else this.props.loadStamperObject(w.f)}},{key:"receiveMessage",value:function(e){"edited"==e.data.type&&(this.props.setWorldData({worldEdited:!0}),I&&I.send("edited"))}},{key:"requestOnlineWorldCheck",value:function(){var e=this,t=new k({token:this.oauthToken}).getRepo("p5stamper","worlds"),i=new Date;t.listCommits({},(function(t,n,a){if(t)return window.postMessage({type:"worlds"},"*"),void e.setState({lastWorldCheck:i.getTime()});e.getWorldPublishTime("",(function(t){t>=e.state.lastWorldCheck&&(console.log("UPDATING WORLDS"),window.postMessage({type:"worlds"},"*")),e.setState({lastWorldCheck:i.getTime()})}))}))}},{key:"componentDidMount",value:function(){var e=this;this.requestOnlineWorldCheck(),window.addEventListener("message",this.receiveMessage),this.loadInitialStamperObject();var t=setInterval(this.sendSaveData.bind(this),18e4);this.setState({saveInterval:t}),I&&I.on("openDirectory",(function(t,i){var n=[];i.rawFileList.map((function(e){var t=O.lookup(e.name),i=new File([e.buffer],e.name,{type:t});n.push(i)})),console.log(n),e.checkAndOpenFiles(n)})),I&&I.on("exteriorChanges",(function(t){var i=[];i.push({text:"re-open sketch",color:"outline-primary",callback:function(){e.requestUpload()}}),e.setState({modalVisible:!0,modalHeader:"The directory that your sketch was saved in has changed.",modalContent:"Please re-specify where you want your sketch to be saved.",modalButtons:i})})),I&&I.on("requestSave",(function(t,i){e.sendSaveData()})),I&&I.on("resetView",(function(t,i){i.worldKey?e.getWorldObject(i.worldKey,!0,(function(t){return t&&e.props.loadStamperObject(t)})):e.props.loadStamperObject(w.f)})),I&&I.on("getWorlds",(function(t,i){e.getWorldNamesAndKeys((function(e){return I&&I.send("sendWorlds",e)}))})),this.createInputElement(),window.addEventListener("beforeunload",this.sendSaveData)}},{key:"protectAgainstClosed",value:function(e){console.log("PROTECTING");return e.returnValue="You have not filled out the form yet","You have not filled out the form yet"}},{key:"getWorldNamesAndKeys",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null},t=[];w.h.map((function(e){return t.push({key:e.name,name:e.name})})),this.getOnlineWorlds((function(i){i.length>0&&t.push({}),t=t.concat(i),e(t)}))}},{key:"deleteInputElement",value:function(){this.state.inputElem.removeEventListener("change",this.receiveFiles),document.getElementById("root").removeChild(this.state.inputElem)}},{key:"createInputElement",value:function(){var e=document.createElement("input",{id:"sketchInput",type:"file",webkitdirectory:"true",multiple:"true"}),t=document.createAttribute("id");t.value="sketchInput",e.setAttributeNode(t);var i=document.createAttribute("type");i.value="file",e.setAttributeNode(i);var n=document.createAttribute("multiple");n.value="true",e.setAttributeNode(n);var a=document.createAttribute("webkitdirectory");a.value="true",e.setAttributeNode(a);var s=document.createAttribute("hidden");s.value="true",e.setAttributeNode(s),e.addEventListener("change",this.receiveFiles),document.getElementById("root").appendChild(e),this.setState({inputElem:e})}},{key:"createMiniImputElem",value:function(e,t){var i=this;if("text"===e)var n="text/*";else n="";var a=c.a.createElement("input",{type:"file",hidden:!0,id:"miniInput",accept:n,multiple:!0,onChange:function(t){return i.uploadMini(t,e)}});this.setState({miniInputElem:null},(function(){return i.setState({miniInputElem:a},(function(){return t()}))}))}},{key:"componentWillUnmout",value:function(){window.removeEventListener("message",this.receiveMessage),window.removeEventListener("beforeunload",this.sendSaveData),this.state.inputElem.removeEventListener("change",this.receiveFiles),clearInterval(this.state.saveInterval),this.setState({saveInterval:null})}},{key:"requestFileUpload",value:function(e){this.createMiniImputElem(e,(function(){return document.getElementById("miniInput").click()}))}},{key:"requestUpload",value:function(){var e=this;document.getElementById("sketchInput").dispatchEvent(new MouseEvent("click")),document.body.onfocus=function(){document.body.onfocus=null,e.hideModal()}}},{key:"readFile",value:function(e,t,i){var n=new FileReader;if(""!=e.webkitRelativePath){var a=e.webkitRelativePath.split("/"),s="";a.length>0&&(s=a.slice(1,a.length).join("/"))}else s=e.name;if(this.state.cdnLibs&&e.name in this.libs)t[s]={};else{if(e.type.startsWith("text")||e.type.startsWith("application"))var o="text";else o="media";n.onload=function(n){console.log(n.target.result),t[s]={content:n.target.result,type:o,path:e.path},i()};try{"text"===o?n.readAsText(e):n.readAsDataURL(e)}catch(r){t[s]={},this.setState({modalVisible:!0,modalHeader:"Oh no! It looks like we had trouble reading one of your files.",modalContent:"Check that your index.html, sketch.js, and style.css are properly configured.",modalButtons:[{text:"ok",color:"outline-secondary",callback:this.hideModal}]})}}}},{key:"uploadMini",value:function(e,t){var i=this;Object.assign([],e.target.files).map((function(e){var n=new FileReader;n.onload=function(n){var a,s={code:n.target.result,name:e.name,isMediaFile:"text"!=t,isTxtFile:"text"===t};a=s,i.props.addStamp(a,(function(e){i.props.requestCompile(e),window.postMessage({type:"edited"},"*")}))},n.onload.bind(i),e.type.startsWith("text")?t?n.readAsText(e):i.setState({modalVisible:!0,modalHeader:"".concat(e.name," failed to upload."),modalContent:"You can't upload text files as a media asset",modalButtons:[{text:"ok",color:"outline-secondary",callback:i.hideModal}]}):n.readAsDataURL(e)}))}},{key:"readFiles",value:function(e){for(var t=this,i={},n=function(){Object.keys(i).length===e.length&&t.stampifyFiles(i)},a=0;a<e.length;a++)this.readFile(e[a],i,(function(){return n()}));0===e.length&&n()}},{key:"receiveFiles",value:function(e){this.checkAndOpenFiles(e.target.files)}},{key:"checkAndOpenFiles",value:function(e){var t=this;this.setState({askedAboutCdn:!1});for(var i=[],n=!1,a=0;a<e.length;a++){var s=e[a].name.split("/").pop();s in this.libs&&(n=!0),!1===s.startsWith(".")&&i.push(e[a])}if(console.log(i),this.deleteInputElement(),this.createInputElement(),n){var o=[];o.push({text:"no",color:"outline-secondary",callback:function(){t.setState({cdnLibs:!1},(function(){return t.readFiles(i)})),t.hideModal()}}),o.push({text:"yes",color:"outline-primary",callback:function(){t.setState({cdnLibs:!0},(function(){return t.readFiles(i)})),t.hideModal()}}),this.setState({modalVisible:!0,modalHeader:"Would you like to import p5's core libraries via CDN?",modalContent:"The libraries are currently stored in large files in your sketch. This may cause Stamper to run slowly. Importing them via CDN won't cause them to behave differently but will speed up Stamper.",modalButtons:o})}else this.readFiles(i)}},{key:"loadWithOverwriteProtection",value:function(e){var t=this,i=[];i.push({text:"cancel",color:"outline-secondary",callback:this.hideModal}),i.push({text:"yes",color:"outline-primary",callback:function(){t.props.loadStamperObject(e),t.hideModal(),t.props.setWorldData({worldEdited:!1})}}),I||i.push({text:"yes, but download my current sketch first",color:"outline-primary",callback:function(){t.requestDownload(),t.props.loadStamperObject(e),t.hideModal(),t.props.setWorldData({worldEdited:!1})}}),this.props.getWorldData().worldEdited?this.setState({modalVisible:!0,modalHeader:"This will overwrite your current work",modalContent:"Would you like to load the example anyways?",modalButtons:i}):(this.props.loadStamperObject(e),this.props.setWorldData({worldEdited:!1}))}},{key:"sendSaveData",value:function(){console.log("SAVING"),this.requestOnlineWorldCheck();var e=this.props.getStamperObject(),t=g.a.compress(JSON.stringify(e),{outputEncoding:"StorageBinaryString"});!I&&localStorage.setItem("storedStamper",t),I&&I.send("save",this.props.getFileDict())}},{key:"requestDownload",value:function(){var e=this.props.getFileDict(),t=new v.a;Object.keys(e).map((function(i){if("media"===e[i].type){var n=e[i].content,a=n.indexOf("base64,")+"base64,".length,s=n.substring(a);t.file(i,s,{base64:!0})}else t.file(i,e[i].content)})),t.generateAsync({type:"blob"}).then((function(e){Object(h.saveAs)(e,"stamper_sketch.zip")}))}},{key:"updateStamperObject",value:function(e,t){if(void 0===t)var i=void 0;else i=t.js;if(i===e)return t;try{var n=u.a.jsToStamps(e);n.js=e}catch(a){throw"Syntax error in Javascript"}return n.console={hidden:!0},n.scale=.7,n.originX=0,n.originY=0,n.imgs=[],n}},{key:"replaceFilesWithCDN",value:function(e){var t=this;return Object.keys(this.libs).map((function(i){e=e.replace('"'.concat(i,'"'),'"'.concat(t.libs[i],'"')).replace("'".concat(i,"'"),"'".concat(t.libs[i],"'")).replace("`"+i+"`","`"+t.libs[i]+"`")})),e}},{key:"stampifyFiles",value:function(e,t){var i=this;if("index.html"in e!==!1&&"sketch.js"in e!==!1){this.state.cdnLibs&&(e["index.html"].content=this.replaceFilesWithCDN(e["index.html"].content));var n=void 0;if("stamper.js"in e){var a=e["stamper.js"].content;n=JSON.parse(a.substring(a.indexOf("{"),a.length))}try{n=this.updateStamperObject(e["sketch.js"].content,n)}catch(o){return void this.setState({modalVisible:!0,modalHeader:"Oh no! It looks like your sketch file has a few syntax errors.",modalContent:"We can't parse javascript with syntax errors into Stamper land :(",modalButtons:[{text:"ok",color:"outline-secondary",callback:this.hideModal}]})}var s=[];n.stamps.map((function(t){i.state.cdnLibs&&t.name in i.libs||(t.isTxtFile||t.isMediaFile||t.isIndex?t.name in e&&(t.code=e[t.name].content,e[t.name].transferred=!0,s.push(t)):s.push(t))})),Object.keys(e).map((function(t){i.state.cdnLibs&&t in i.libs||"sketch.js"===t||"stamper.js"===t||e[t].transferred||0===Object.keys(e[t])||("index.html"===t?s.push({name:t,args:" ",code:e[t].content,isIndex:!0,hidden:!0}):"media"===e[t].type?s.push({name:t,args:" ",code:e[t].content,isMediaFile:!0,hidden:!0}):s.push({name:t,args:" ",code:e[t].content,isTxtFile:!0,hidden:!0}))})),n.stamps=s,this.props.loadStamperObject(n),I&&I.send("updatePath",{fileDict:e})}else this.setState({modalVisible:!0,modalHeader:"Oh no! It looks like you're missing some files.",modalContent:"Stamper sketchs must have an 'index.html' file and a 'sketch.js' file.",modalButtons:[{text:"ok",color:"outline-secondary",callback:this.hideModal}]})}},{key:"worldKeyToUrl",value:function(e){return this.domain+"/?e="+e}},{key:"worldKeyToFileName",value:function(e){return e+".json"}},{key:"worldFileNameToKey",value:function(e){if(!e)return"";if(e.endsWith(".json"))return e.substring(0,e.length-".json".length);throw"improperly configured filename"}},{key:"worldKeyToNameAuthor",value:function(e){if(!e)return{name:"",author:""};var t=e.split("_").join(" ").split("~");if(2===t.length)return{name:t[0],author:t[1]};if(1===t.length)return{name:t[0]};throw"improperly configured key"}},{key:"worldNameAuthorToKey",value:function(e,t){return(e+"~"+t).split(" ").join("_")}},{key:"hideModal",value:function(){this.setState({modalVisible:!1})}},{key:"requestPublish",value:function(){var e=this.props.getWorldData(),t=localStorage.getItem("localWorldAuthor"),i="";e.worldKey&&(i=this.worldKeyToNameAuthor(e.worldKey).name);var n="";t&&(n=t);var a=c.a.createElement(x.a,{publishModalName:i,publishModalAuthor:n,checkPublishWorldName:this.checkPublishWorldName.bind(this),renderLinkForm:this.renderLinkForm.bind(this),publishWorld:this.publishWorld.bind(this),hidePublishModal:this.hidePublishModal.bind(this)});this.setState({publishModal:a})}},{key:"requestPublishInfo",value:function(){this.setState({publishInfoVisible:!0})}},{key:"checkPublishWorldName",value:function(e,t){return this.worldNameAuthorToKey(e,t)in this.state.onlineWorldDict}},{key:"publishWorld",value:function(e,t,i){var n=this,a=new k({token:this.oauthToken}).getRepo("p5stamper","worlds"),s=new Date,o=this.worldNameAuthorToKey(e,t),r=this.worldKeyToFileName(o);this.props.setWorldData({worldKey:o,worldPublishTime:s.toString()},(function(){a.writeFile("master",r,JSON.stringify(n.props.getStamperObject()),"commited new world",{},(function(e,a,s){if(e)return console.log(e),void i(e);localStorage.setItem("localWorldAuthor",t),window.history.pushState({},null,n.worldKeyToUrl(o)),i()}))}))}},{key:"getOnlineWorlds",value:function(e){var t=this;new k({token:this.oauthToken}).getRepo("p5stamper","worlds").getContents("master","",!1,(function(i,n,a){var s=[],o={};0===n.length&&t.setState({onlineWorldDict:{}},(function(){return e([])})),n.map((function(i){t.getWorldPublishTime(i.name,(function(a){return function(i,a){var r=t.worldFileNameToKey(a);if(s.push(i),o[i]=r,s.length===n.length){s.sort().reverse();var l=[],d={};s.map((function(e){if(e>=0&&e in o){var i=o[e],n=t.worldKeyToNameAuthor(i).name+" by "+t.worldKeyToNameAuthor(i).author;l.push({name:n,key:i}),d[i]=""}})),t.setState({onlineWorldDict:d},(function(){return e(l)}))}}(a,i.name)}))}))}))}},{key:"getWorldObject",value:function(e,t,i){console.log("GETTING WORLD OBJECT"),e||i(void 0);for(var n=0;n<w.h.length;n++)if(e===w.h[n].name)return void i(w.h[n].data);this.getOnlineWorldObject(e,t,i)}},{key:"getWorldPublishTime",value:function(e,t){new k({token:this.oauthToken}).getRepo("p5stamper","worlds").listCommits({path:e},(function(i,n,a){if(i)t(-1,e);else if(0===n.length)t(-1,e);else{var s=n[0].commit.committer.date,o=new Date(s).getTime();t(o)}}))}},{key:"getOnlineWorldObject",value:function(t,i,n){var a=this;new k({token:this.oauthToken}).getRepo("p5stamper","worlds").getContents("master",this.worldKeyToFileName(t),!1,(function(s,o,r){if(s)return i&&a.setState({modalVisible:!0,modalHeader:"Oh no! It looks like '".concat(a.worldKeyToNameAuthor(t).name," by ").concat(a.worldKeyToNameAuthor(t).author,"' doesn't exist in our example list yet."),modalContent:"Our server may not be fully updated, try again in a few minutes.",modalButtons:[{text:"ok",color:"outline-secondary",callback:a.hideModal}]}),void n(void 0);var l=new e(o.content,"base64"),d=new TextDecoder("utf-8").decode(l);try{n(JSON.parse(d))}catch(s){console.log(s),i&&a.setState({modalVisible:!0,modalHeader:"Oh no! It looks like there were issues loading '".concat(a.worldKeyToNameAuthor(t).name,"'."),modalContent:"The example may be corrupted.",modalButtons:[{text:"ok",color:"outline-secondary",callback:a.hideModal}]})}}))}},{key:"hidePublishModal",value:function(){this.setState({publishModal:null})}},{key:"hidePublishInfoModal",value:function(){this.setState({publishInfoVisible:!1})}},{key:"renderLinkForm",value:function(){return c.a.createElement("input",{class:"picker picker form-control form-control-sm mt-1 mb-1",value:this.worldKeyToUrl(this.props.getWorldData().worldKey)})}},{key:"renderPublishInfoModal",value:function(){var e=this.props.getWorldData(),t="You aren't working in a published sketch.";if(e.worldKey){var i=this.worldKeyToNameAuthor(e.worldKey);t=i.author?"".concat(i.name," by ").concat(i.author):"".concat(i.name)}return c.a.createElement(b.a,{show:this.state.publishInfoVisible,style:{zIndex:2e18},centered:!0,onHide:this.hidePublishInfoModal},c.a.createElement(b.a.Header,{closeButton:!0},c.a.createElement(b.a.Title,{className:"name"},t)),c.a.createElement(b.a.Body,null,c.a.createElement("div",null,c.a.createElement("div",{hidden:!e.worldKey},this.renderLinkForm(),c.a.createElement("div",{class:"ml-1 picker text-greyText",hidden:!e.worldPublishTime},"published "+e.worldPublishTime),c.a.createElement("div",{class:"ml-1 picker text-primary",hidden:!this.props.getWorldData().worldEdited},"the sketch you have now is an edited version of what's published")),c.a.createElement("div",{hidden:e.worldKey,class:"picker"},"Publish this sketch to see it's published info"))),c.a.createElement(b.a.Footer,null,c.a.createElement(y.a,{variant:"outline-secondary",size:"sm",onClick:this.hidePublishInfoModal},"ok")))}},{key:"render",value:function(){var e=this.state.modalButtons.map((function(e){return c.a.createElement(y.a,{variant:e.color,size:"sm",onClick:e.callback},e.text)}));return c.a.createElement("div",null,this.state.miniInputElem,c.a.createElement(b.a,{show:this.state.modalVisible,style:{zIndex:2e18},centered:!0,onHide:this.hideModal},c.a.createElement(b.a.Header,{closeButton:!0},c.a.createElement(b.a.Title,{className:"name"},this.state.modalHeader)),c.a.createElement(b.a.Body,{className:"picker"},this.state.modalContent," "),c.a.createElement(b.a.Footer,{hidden:0===e.length},e)),this.state.publishModal,this.renderPublishInfoModal())}}]),i}(d.Component)}).call(this,i(24).Buffer)},443:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i(14),a=i(15),s=i(17),o=i(16),r=i(18),l=(i(117),i(7),i(0)),d=i.n(l),c=(i(168),i(69),i(111),i(247),i(20)),h=i(93),p=(i(156),i(158),i(159),i(297),i(161),i(162),i(163),i(164),i(88),i(165),i(157),i(160),i(166),i(167),i(19),i(298),i(308).detect);i(309),p();if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)window.require("electron").ipcRenderer;else;var u=function(e){function t(e){var i;return Object(n.a)(this,t),(i=Object(s.a)(this,Object(o.a)(t).call(this,e))).state={publishVisible:!0,publishModalName:i.props.publishModalName,publishModalAuthor:i.props.publishModalAuthor,publishNameAuthorExists:!1,publishModalMode:"unsubmitted"},i}return Object(r.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){this.setState({publishNameAuthorExists:this.props.checkPublishWorldName(this.state.publishModalName,this.state.publishModalAuthor)})}},{key:"componentWillUnmout",value:function(){}},{key:"render",value:function(){var e=this;return d.a.createElement(c.a,{show:this.state.publishVisible,style:{zIndex:2e18},centered:!0,onHide:this.props.hidePublishModal},d.a.createElement(c.a.Header,{closeButton:!0},d.a.createElement(c.a.Title,{className:"name"},"Publish current sketch")),d.a.createElement(c.a.Body,null,d.a.createElement("div",{class:"picker "},"This will add your sketch to the examples list and give you a link to share it with.",d.a.createElement("div",{class:"row picker p-2"},d.a.createElement("input",{placeholder:"name",class:" m-1 form-control form-control-sm",style:{width:150},value:this.state.publishModalName,onChange:function(t){e.setState({publishModalName:t.target.value.split("_").join(" ").split("~").join(" "),publishModalMode:"unsubmitted"},(function(){return e.setState({publishNameAuthorExists:e.props.checkPublishWorldName(e.state.publishModalName,e.state.publishModalAuthor)})}))}}),d.a.createElement("div",{class:" picker m-2"},"by"),d.a.createElement("input",{placeholder:"author (you)",class:" m-1 form-control form-control-sm",style:{width:150},value:this.state.publishModalAuthor,onChange:function(t){e.setState({publishModalAuthor:t.target.value.split("_").join(" ").split("~").join(" "),publishModalMode:"unsubmitted"},(function(){return e.setState({publishNameAuthorExists:e.props.checkPublishWorldName(e.state.publishModalName,e.state.publishModalAuthor)})}))}})),d.a.createElement("div",{class:"mt-2"},d.a.createElement("div",{hidden:"loading"!=this.state.publishModalMode,class:"picker text-greyText",style:{fontStyle:"italic"}},"loading..."),d.a.createElement("div",{hidden:"failure"!=this.state.publishModalMode,class:"picker text-warningOrangeDark"},"Oh no! There was an error publishing your sketch. If you recently published a sketch with the same name and author, we may still be processing it. Please try again in another minute or so."),d.a.createElement("div",{hidden:!this.state.publishNameAuthorExists||"unsubmitted"!==this.state.publishModalMode,class:"picker text-warningOrangeDark"},"An example with this name and author already exists. If you publish, you'll overwrite that example (please don't do this if this isn't your example to overwrite)."),d.a.createElement("div",{hidden:"success"!=this.state.publishModalMode},d.a.createElement("div",{class:"picker text-primary"},"Congrats! Your sketch was successfully published (it will take several minutes for it to show up in the examples list). Access it at:"),this.props.renderLinkForm())))),d.a.createElement(c.a.Footer,null,d.a.createElement(h.a,{variant:"outline-secondary",size:"sm",onClick:this.props.hidePublishModal},"unsubmitted"===this.state.publishModalMode?"cancel":"done"),d.a.createElement(h.a,{disabled:!this.state.publishModalName||!this.state.publishModalAuthor||this.state.publishModalLoading,variant:"outline-primary",size:"sm",onClick:function(){e.setState({publishModalMode:"loading"}),e.props.publishWorld(e.state.publishModalName,e.state.publishModalAuthor,(function(t){t?e.setState({publishModalMode:"failure"}):e.setState({publishModalMode:"success"})}))}},"publish")))}}]),t}(l.Component)},455:function(e,t,i){e.exports=i(1348)},69:function(e,t,i){var n=i(181),a=i(118);i(883);function s(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.range[0]<t.range[0]&&t.range[1]<n.range[1])return-1;if(t.range[1]<n.range[0])return i}return e.length}function o(e,t,i,n,a){if(a)if("Block"===t.type)var s="/*"+t.value+"*/";else s="// "+t.value;else s=i.substr(t.range[0],t.range[1]-t.range[0]);var o=t.loc.start.line-n;if(0===e.length)e.push({code:s,isBlob:!0});else if(e[e.length-1].isBlob){if(o>1)e.push({code:s,isBlob:!0});else if(0===o){e[e.length-1].code+=s}else if(1===o){e[e.length-1].code+="\n"+s}}else e.push({code:s,isBlob:!0});return t.loc.end.line}function r(e,t,i){t.range;var n=t.id.name,a="";if(t.params.length>=1){var s=t.params[0].range[0],o=t.params[t.params.length-1].range[1];a=i.substr(s,o-s)}var r=t.body.range[0]+1,l=t.body.range[1]-1,d=i.substr(r,l-r);e.push({code:d,name:n,args:a})}t.jsToStamps=function(e){try{var t=n.parseScript(e,{range:!0,comment:!0,tolerant:!0,loc:!0})}catch(d){return console.log(d),null}var i=a.cloneDeep(t.body);!function(e,t){for(var i=0;i<t.length;i++){var n=t[i],a=s(e,n);a>=0&&e.splice(a,0,n)}}(i,t.comments);var l={stamps:[]};return function(e,t,i){for(var n=0,a=0;a<e.length;a++){var s=e[a];"FunctionDeclaration"===s.type?r(t,s,i):n="Block"===s.type||"Line"===s.type?o(t,s,i,n,!0):o(t,s,i,n,!1)}}(i,l.stamps,e),l},t.getVariables=function(e){try{var t=n.parseScript(e)}catch(u){}for(var i,a={},s={},o=[[null,t,0,null]];o.length>0;){var r=o.shift(),l=r[0],d=r[1],c=r[3],h=r[2];null!==d&&(l&&d&&c&&"id"===l&&"Identifier"===d.type&&((i=c.type).includes("Declaration")||i.includes("Declarator"))&&d.name in a===!1&&(a[d.name]=[c.type,h]),l&&"name"===l&&d in a===!1&&(s[d]=h),d instanceof Array?d.map((function(e){return o.push([null,e,h+1,d])})):d instanceof Object&&Object.keys(d).map((function(e){o.push([e,d[e],h+1,d])})))}var p={declared:[],undeclared:[]};return Object.keys(a).map((function(e){3===a[e][1]&&a[e][0].includes("Declaration")?p.declared.push(e):5===a[e][1]&&a[e][0].includes("Declarator")&&p.declared.push(e)})),Object.keys(s).map((function(e){p.undeclared.push(e)})),p}},873:function(e,t,i){"use strict";(function(e){var t=i(89),n=i.n(t);n.a.define("ace/theme/p5",["require","exports","module","ace/lib/dom"],(function(e,t,i){t.isDark=!1,t.cssClass="ace-p5",t.cssText=".ace-p5 .ace_gutter {\tbackground: #F5F8FC;\tcolor: #333 !important;}.ace-p5 .ace_identifier {\tcolor: #000000;}.ace-p5 .ace_print-margin {\twidth: 1px;\tbackground: #F5F8FC;}.ace-p5 {\tbackground-color: #F5F8FC;\tcolor: #586E75}.ace-p5 .ace_cursor {\tcolor: #000000}.ace-p5 .ace_marker-layer .ace_selection {\tbackground: rgb(181, 213, 255)}.ace-p5.ace_multiselect .ace_selection.ace_start {\tbox-shadow: 0 0 3px 0px #FDF6E3;}.ace-p5 .ace_marker-layer .ace_step {\tbackground: rgb(255, 255, 0)}.ace-p5 .ace_marker-layer .ace_bracket {\tmargin: -1px 0 0 -1px;\tborder: 1px solid rgba(147, 161, 161, 0.50)}.ace-p5 .ace_marker-layer .ace_active-line {\tbackground: #EEE8D5}.ace-p5 .ace_gutter-active-line {\tbackground-color : #EDE5C1}.ace-p5 .ace_marker-layer .ace_selected-word {\tborder: 1px solid #7f9390}.ace-p5 .ace_invisible {\tcolor: rgba(147, 161, 161, 0.50)}.ace-p5 .ace_keyword  {\tcolor: #00A1D3}.ace-p5 .ace_keyword.ace_operator {\tcolor: #A67F59}.ace-p5 .ace_meta,.ace-p5 .ace_support.ace_class,.ace-p5 .ace_support.ace_type {\tcolor: #859900}.ace-p5 .ace_paren{\tcolor: #666}.ace-p5 .ace_constant.ace_character,.ace-p5 .ace_constant.ace_other {\tcolor: #CB4B16}.ace-p5 .ace_constant.ace_language {\tcolor: #B58900}.ace-p5 .ace_constant.ace_numeric {\tcolor: #dc3787}.ace-p5 .ace_fold {\tbackground-color: #268BD2;\tborder-color: #586E75}.ace-p5 .ace_function, {\tcolor: #00a1d3 !important}.ace-p5 .ace_entity.ace_name.ace_function,.ace-p5 .ace_entity.ace_name.ace_tag,.ace-p5 .ace_support.ace_function,.ace-p5 .ace_variable,.ace-p5 .ace_variable.ace_language {\tcolor: #00a1d3 !important}.ace-p5 .ace_storage {\tcolor: #704f21 !important}.ace-p5 .ace_string {color: #00a1d3 !important;}.ace-p5 .ace_string.ace_regexp {color: #D30102}.ace-p5 .ace_comment,.ace-p5 .ace_entity.ace_other.ace_attribute-name {color: #a0a0a0}.ace-p5 .ace_indent-guide {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWNgYGBgYHjy8NJ/AAjgA5fzQUmBAAAAAElFTkSuQmCC) right repeat-y}",e("../lib/dom").importCssString(t.cssText,t.cssClass)})),n.a.require(["ace/theme/p5"],(function(t){"object"==typeof exports&&e&&(e.exports=t)}))}).call(this,i(262)(e))},88:function(e,t,i){e.exports=i.p+"static/media/globe.50d70b6d.svg"},896:function(e,t){},898:function(e,t){},914:function(e,t){},916:function(e,t){}},[[455,1,2]]]);
//# sourceMappingURL=main.ea694e50.chunk.js.map